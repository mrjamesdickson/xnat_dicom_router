function ah(e,n){for(var r=0;r<n.length;r++){const l=n[r];if(typeof l!="string"&&!Array.isArray(l)){for(const s in l)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(l,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>l[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function oh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Cc={exports:{}},Zl={},Ec={exports:{}},te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hr=Symbol.for("react.element"),ch=Symbol.for("react.portal"),dh=Symbol.for("react.fragment"),uh=Symbol.for("react.strict_mode"),hh=Symbol.for("react.profiler"),fh=Symbol.for("react.provider"),ph=Symbol.for("react.context"),mh=Symbol.for("react.forward_ref"),xh=Symbol.for("react.suspense"),gh=Symbol.for("react.memo"),yh=Symbol.for("react.lazy"),Ya=Symbol.iterator;function vh(e){return e===null||typeof e!="object"?null:(e=Ya&&e[Ya]||e["@@iterator"],typeof e=="function"?e:null)}var Tc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Rc=Object.assign,Pc={};function Jn(e,n,r){this.props=e,this.context=n,this.refs=Pc,this.updater=r||Tc}Jn.prototype.isReactComponent={};Jn.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Jn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Dc(){}Dc.prototype=Jn.prototype;function Ji(e,n,r){this.props=e,this.context=n,this.refs=Pc,this.updater=r||Tc}var Zi=Ji.prototype=new Dc;Zi.constructor=Ji;Rc(Zi,Jn.prototype);Zi.isPureReactComponent=!0;var qa=Array.isArray,Ic=Object.prototype.hasOwnProperty,ea={current:null},Fc={key:!0,ref:!0,__self:!0,__source:!0};function _c(e,n,r){var l,s={},i=null,a=null;if(n!=null)for(l in n.ref!==void 0&&(a=n.ref),n.key!==void 0&&(i=""+n.key),n)Ic.call(n,l)&&!Fc.hasOwnProperty(l)&&(s[l]=n[l]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(l in o=e.defaultProps,o)s[l]===void 0&&(s[l]=o[l]);return{$$typeof:Hr,type:e,key:i,ref:a,props:s,_owner:ea.current}}function jh(e,n){return{$$typeof:Hr,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function ta(e){return typeof e=="object"&&e!==null&&e.$$typeof===Hr}function Sh(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return n[r]})}var Ga=/\/+/g;function bs(e,n){return typeof e=="object"&&e!==null&&e.key!=null?Sh(""+e.key):n.toString(36)}function ml(e,n,r,l,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Hr:case ch:a=!0}}if(a)return a=e,s=s(a),e=l===""?"."+bs(a,0):l,qa(s)?(r="",e!=null&&(r=e.replace(Ga,"$&/")+"/"),ml(s,n,r,"",function(d){return d})):s!=null&&(ta(s)&&(s=jh(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Ga,"$&/")+"/")+e)),n.push(s)),1;if(a=0,l=l===""?".":l+":",qa(e))for(var o=0;o<e.length;o++){i=e[o];var c=l+bs(i,o);a+=ml(i,n,r,c,s)}else if(c=vh(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=l+bs(i,o++),a+=ml(i,n,r,c,s);else if(i==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return a}function Jr(e,n,r){if(e==null)return e;var l=[],s=0;return ml(e,l,"","",function(i){return n.call(r,i,s++)}),l}function bh(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var $e={current:null},xl={transition:null},wh={ReactCurrentDispatcher:$e,ReactCurrentBatchConfig:xl,ReactCurrentOwner:ea};function zc(){throw Error("act(...) is not supported in production builds of React.")}te.Children={map:Jr,forEach:function(e,n,r){Jr(e,function(){n.apply(this,arguments)},r)},count:function(e){var n=0;return Jr(e,function(){n++}),n},toArray:function(e){return Jr(e,function(n){return n})||[]},only:function(e){if(!ta(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};te.Component=Jn;te.Fragment=dh;te.Profiler=hh;te.PureComponent=Ji;te.StrictMode=uh;te.Suspense=xh;te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wh;te.act=zc;te.cloneElement=function(e,n,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=Rc({},e.props),s=e.key,i=e.ref,a=e._owner;if(n!=null){if(n.ref!==void 0&&(i=n.ref,a=ea.current),n.key!==void 0&&(s=""+n.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in n)Ic.call(n,c)&&!Fc.hasOwnProperty(c)&&(l[c]=n[c]===void 0&&o!==void 0?o[c]:n[c])}var c=arguments.length-2;if(c===1)l.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];l.children=o}return{$$typeof:Hr,type:e.type,key:s,ref:i,props:l,_owner:a}};te.createContext=function(e){return e={$$typeof:ph,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fh,_context:e},e.Consumer=e};te.createElement=_c;te.createFactory=function(e){var n=_c.bind(null,e);return n.type=e,n};te.createRef=function(){return{current:null}};te.forwardRef=function(e){return{$$typeof:mh,render:e}};te.isValidElement=ta;te.lazy=function(e){return{$$typeof:yh,_payload:{_status:-1,_result:e},_init:bh}};te.memo=function(e,n){return{$$typeof:gh,type:e,compare:n===void 0?null:n}};te.startTransition=function(e){var n=xl.transition;xl.transition={};try{e()}finally{xl.transition=n}};te.unstable_act=zc;te.useCallback=function(e,n){return $e.current.useCallback(e,n)};te.useContext=function(e){return $e.current.useContext(e)};te.useDebugValue=function(){};te.useDeferredValue=function(e){return $e.current.useDeferredValue(e)};te.useEffect=function(e,n){return $e.current.useEffect(e,n)};te.useId=function(){return $e.current.useId()};te.useImperativeHandle=function(e,n,r){return $e.current.useImperativeHandle(e,n,r)};te.useInsertionEffect=function(e,n){return $e.current.useInsertionEffect(e,n)};te.useLayoutEffect=function(e,n){return $e.current.useLayoutEffect(e,n)};te.useMemo=function(e,n){return $e.current.useMemo(e,n)};te.useReducer=function(e,n,r){return $e.current.useReducer(e,n,r)};te.useRef=function(e){return $e.current.useRef(e)};te.useState=function(e){return $e.current.useState(e)};te.useSyncExternalStore=function(e,n,r){return $e.current.useSyncExternalStore(e,n,r)};te.useTransition=function(){return $e.current.useTransition()};te.version="18.3.1";Ec.exports=te;var x=Ec.exports;const Lc=oh(x),kh=ah({__proto__:null,default:Lc},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nh=x,Ch=Symbol.for("react.element"),Eh=Symbol.for("react.fragment"),Th=Object.prototype.hasOwnProperty,Rh=Nh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ph={key:!0,ref:!0,__self:!0,__source:!0};function Ac(e,n,r){var l,s={},i=null,a=null;r!==void 0&&(i=""+r),n.key!==void 0&&(i=""+n.key),n.ref!==void 0&&(a=n.ref);for(l in n)Th.call(n,l)&&!Ph.hasOwnProperty(l)&&(s[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps,n)s[l]===void 0&&(s[l]=n[l]);return{$$typeof:Ch,type:e,key:i,ref:a,props:s,_owner:Rh.current}}Zl.Fragment=Eh;Zl.jsx=Ac;Zl.jsxs=Ac;Cc.exports=Zl;var t=Cc.exports,Zs={},Bc={exports:{}},Ge={},Oc={exports:{}},$c={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(k,O){var $=k.length;k.push(O);e:for(;0<$;){var H=$-1>>>1,V=k[H];if(0<s(V,O))k[H]=O,k[$]=V,$=H;else break e}}function r(k){return k.length===0?null:k[0]}function l(k){if(k.length===0)return null;var O=k[0],$=k.pop();if($!==O){k[0]=$;e:for(var H=0,V=k.length,b=V>>>1;H<b;){var T=2*(H+1)-1,G=k[T],ce=T+1,N=k[ce];if(0>s(G,$))ce<V&&0>s(N,G)?(k[H]=N,k[ce]=$,H=ce):(k[H]=G,k[T]=$,H=T);else if(ce<V&&0>s(N,$))k[H]=N,k[ce]=$,H=ce;else break e}}return O}function s(k,O){var $=k.sortIndex-O.sortIndex;return $!==0?$:k.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var c=[],d=[],j=1,h=null,f=3,m=!1,v=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function u(k){for(var O=r(d);O!==null;){if(O.callback===null)l(d);else if(O.startTime<=k)l(d),O.sortIndex=O.expirationTime,n(c,O);else break;O=r(d)}}function y(k){if(S=!1,u(k),!v)if(r(c)!==null)v=!0,ae(E);else{var O=r(d);O!==null&&Se(y,O.startTime-k)}}function E(k,O){v=!1,S&&(S=!1,g(z),z=-1),m=!0;var $=f;try{for(u(O),h=r(c);h!==null&&(!(h.expirationTime>O)||k&&!R());){var H=h.callback;if(typeof H=="function"){h.callback=null,f=h.priorityLevel;var V=H(h.expirationTime<=O);O=e.unstable_now(),typeof V=="function"?h.callback=V:h===r(c)&&l(c),u(O)}else l(c);h=r(c)}if(h!==null)var b=!0;else{var T=r(d);T!==null&&Se(y,T.startTime-O),b=!1}return b}finally{h=null,f=$,m=!1}}var I=!1,_=null,z=-1,D=5,C=-1;function R(){return!(e.unstable_now()-C<D)}function ne(){if(_!==null){var k=e.unstable_now();C=k;var O=!0;try{O=_(!0,k)}finally{O?K():(I=!1,_=null)}}else I=!1}var K;if(typeof p=="function")K=function(){p(ne)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,A=Z.port2;Z.port1.onmessage=ne,K=function(){A.postMessage(null)}}else K=function(){w(ne,0)};function ae(k){_=k,I||(I=!0,K())}function Se(k,O){z=w(function(){k(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(k){k.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,ae(E))},e.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<k?Math.floor(1e3/k):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(k){switch(f){case 1:case 2:case 3:var O=3;break;default:O=f}var $=f;f=O;try{return k()}finally{f=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(k,O){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var $=f;f=k;try{return O()}finally{f=$}},e.unstable_scheduleCallback=function(k,O,$){var H=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?H+$:H):$=H,k){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=$+V,k={id:j++,callback:O,priorityLevel:k,startTime:$,expirationTime:V,sortIndex:-1},$>H?(k.sortIndex=$,n(d,k),r(c)===null&&k===r(d)&&(S?(g(z),z=-1):S=!0,Se(y,$-H))):(k.sortIndex=V,n(c,k),v||m||(v=!0,ae(E))),k},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(k){var O=f;return function(){var $=f;f=O;try{return k.apply(this,arguments)}finally{f=$}}}})($c);Oc.exports=$c;var Dh=Oc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ih=x,qe=Dh;function L(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mc=new Set,Nr={};function gn(e,n){Wn(e,n),Wn(e+"Capture",n)}function Wn(e,n){for(Nr[e]=n,e=0;e<n.length;e++)Mc.add(n[e])}var Ct=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ei=Object.prototype.hasOwnProperty,Fh=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ja={},Za={};function _h(e){return ei.call(Za,e)?!0:ei.call(Ja,e)?!1:Fh.test(e)?Za[e]=!0:(Ja[e]=!0,!1)}function zh(e,n,r,l){if(r!==null&&r.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Lh(e,n,r,l){if(n===null||typeof n>"u"||zh(e,n,r,l))return!0;if(l)return!1;if(r!==null)switch(r.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Me(e,n,r,l,s,i,a){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=n,this.sanitizeURL=i,this.removeEmptyString=a}var Fe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Fe[e]=new Me(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Fe[n]=new Me(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Fe[e]=new Me(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Fe[e]=new Me(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Fe[e]=new Me(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Fe[e]=new Me(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Fe[e]=new Me(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Fe[e]=new Me(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Fe[e]=new Me(e,5,!1,e.toLowerCase(),null,!1,!1)});var na=/[\-:]([a-z])/g;function ra(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(na,ra);Fe[n]=new Me(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(na,ra);Fe[n]=new Me(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(na,ra);Fe[n]=new Me(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Fe[e]=new Me(e,1,!1,e.toLowerCase(),null,!1,!1)});Fe.xlinkHref=new Me("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Fe[e]=new Me(e,1,!1,e.toLowerCase(),null,!0,!0)});function la(e,n,r,l){var s=Fe.hasOwnProperty(n)?Fe[n]:null;(s!==null?s.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Lh(n,r,s,l)&&(r=null),l||s===null?_h(n)&&(r===null?e.removeAttribute(n):e.setAttribute(n,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(n=s.attributeName,l=s.attributeNamespace,r===null?e.removeAttribute(n):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,l?e.setAttributeNS(l,n,r):e.setAttribute(n,r))))}var Pt=Ih.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zr=Symbol.for("react.element"),Nn=Symbol.for("react.portal"),Cn=Symbol.for("react.fragment"),sa=Symbol.for("react.strict_mode"),ti=Symbol.for("react.profiler"),Uc=Symbol.for("react.provider"),Wc=Symbol.for("react.context"),ia=Symbol.for("react.forward_ref"),ni=Symbol.for("react.suspense"),ri=Symbol.for("react.suspense_list"),aa=Symbol.for("react.memo"),Ft=Symbol.for("react.lazy"),Hc=Symbol.for("react.offscreen"),eo=Symbol.iterator;function lr(e){return e===null||typeof e!="object"?null:(e=eo&&e[eo]||e["@@iterator"],typeof e=="function"?e:null)}var ge=Object.assign,ws;function hr(e){if(ws===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);ws=n&&n[1]||""}return`
`+ws+e}var ks=!1;function Ns(e,n){if(!e||ks)return"";ks=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(d){var l=d}Reflect.construct(e,[],n)}else{try{n.call()}catch(d){l=d}e.call(n.prototype)}else{try{throw Error()}catch(d){l=d}e()}}catch(d){if(d&&l&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=l.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=o);break}}}finally{ks=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?hr(e):""}function Ah(e){switch(e.tag){case 5:return hr(e.type);case 16:return hr("Lazy");case 13:return hr("Suspense");case 19:return hr("SuspenseList");case 0:case 2:case 15:return e=Ns(e.type,!1),e;case 11:return e=Ns(e.type.render,!1),e;case 1:return e=Ns(e.type,!0),e;default:return""}}function li(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cn:return"Fragment";case Nn:return"Portal";case ti:return"Profiler";case sa:return"StrictMode";case ni:return"Suspense";case ri:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Wc:return(e.displayName||"Context")+".Consumer";case Uc:return(e._context.displayName||"Context")+".Provider";case ia:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case aa:return n=e.displayName||null,n!==null?n:li(e.type)||"Memo";case Ft:n=e._payload,e=e._init;try{return li(e(n))}catch{}}return null}function Bh(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return li(n);case 8:return n===sa?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Yt(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Vc(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Oh(e){var n=Vc(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return s.call(this)},set:function(a){l=""+a,i.call(this,a)}}),Object.defineProperty(e,n,{enumerable:r.enumerable}),{getValue:function(){return l},setValue:function(a){l=""+a},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function el(e){e._valueTracker||(e._valueTracker=Oh(e))}function Qc(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var r=n.getValue(),l="";return e&&(l=Vc(e)?e.checked?"true":"false":e.value),e=l,e!==r?(n.setValue(e),!0):!1}function El(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function si(e,n){var r=n.checked;return ge({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function to(e,n){var r=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;r=Yt(n.value!=null?n.value:r),e._wrapperState={initialChecked:l,initialValue:r,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Xc(e,n){n=n.checked,n!=null&&la(e,"checked",n,!1)}function ii(e,n){Xc(e,n);var r=Yt(n.value),l=n.type;if(r!=null)l==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?ai(e,n.type,r):n.hasOwnProperty("defaultValue")&&ai(e,n.type,Yt(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function no(e,n,r){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,r||n===e.value||(e.value=n),e.defaultValue=n}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ai(e,n,r){(n!=="number"||El(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fr=Array.isArray;function An(e,n,r,l){if(e=e.options,n){n={};for(var s=0;s<r.length;s++)n["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=n.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&l&&(e[r].defaultSelected=!0)}else{for(r=""+Yt(r),n=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,l&&(e[s].defaultSelected=!0);return}n!==null||e[s].disabled||(n=e[s])}n!==null&&(n.selected=!0)}}function oi(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(L(91));return ge({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ro(e,n){var r=n.value;if(r==null){if(r=n.children,n=n.defaultValue,r!=null){if(n!=null)throw Error(L(92));if(fr(r)){if(1<r.length)throw Error(L(93));r=r[0]}n=r}n==null&&(n=""),r=n}e._wrapperState={initialValue:Yt(r)}}function Kc(e,n){var r=Yt(n.value),l=Yt(n.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),n.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),l!=null&&(e.defaultValue=""+l)}function lo(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Yc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ci(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Yc(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var tl,qc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,r,l,s){MSApp.execUnsafeLocalFunction(function(){return e(n,r,l,s)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(tl=tl||document.createElement("div"),tl.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=tl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Cr(e,n){if(n){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=n;return}}e.textContent=n}var xr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$h=["Webkit","ms","Moz","O"];Object.keys(xr).forEach(function(e){$h.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),xr[n]=xr[e]})});function Gc(e,n,r){return n==null||typeof n=="boolean"||n===""?"":r||typeof n!="number"||n===0||xr.hasOwnProperty(e)&&xr[e]?(""+n).trim():n+"px"}function Jc(e,n){e=e.style;for(var r in n)if(n.hasOwnProperty(r)){var l=r.indexOf("--")===0,s=Gc(r,n[r],l);r==="float"&&(r="cssFloat"),l?e.setProperty(r,s):e[r]=s}}var Mh=ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function di(e,n){if(n){if(Mh[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(L(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(L(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(L(61))}if(n.style!=null&&typeof n.style!="object")throw Error(L(62))}}function ui(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hi=null;function oa(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fi=null,Bn=null,On=null;function so(e){if(e=Xr(e)){if(typeof fi!="function")throw Error(L(280));var n=e.stateNode;n&&(n=ls(n),fi(e.stateNode,e.type,n))}}function Zc(e){Bn?On?On.push(e):On=[e]:Bn=e}function ed(){if(Bn){var e=Bn,n=On;if(On=Bn=null,so(e),n)for(e=0;e<n.length;e++)so(n[e])}}function td(e,n){return e(n)}function nd(){}var Cs=!1;function rd(e,n,r){if(Cs)return e(n,r);Cs=!0;try{return td(e,n,r)}finally{Cs=!1,(Bn!==null||On!==null)&&(nd(),ed())}}function Er(e,n){var r=e.stateNode;if(r===null)return null;var l=ls(r);if(l===null)return null;r=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(L(231,n,typeof r));return r}var pi=!1;if(Ct)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){pi=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{pi=!1}function Uh(e,n,r,l,s,i,a,o,c){var d=Array.prototype.slice.call(arguments,3);try{n.apply(r,d)}catch(j){this.onError(j)}}var gr=!1,Tl=null,Rl=!1,mi=null,Wh={onError:function(e){gr=!0,Tl=e}};function Hh(e,n,r,l,s,i,a,o,c){gr=!1,Tl=null,Uh.apply(Wh,arguments)}function Vh(e,n,r,l,s,i,a,o,c){if(Hh.apply(this,arguments),gr){if(gr){var d=Tl;gr=!1,Tl=null}else throw Error(L(198));Rl||(Rl=!0,mi=d)}}function yn(e){var n=e,r=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(r=n.return),e=n.return;while(e)}return n.tag===3?r:null}function ld(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function io(e){if(yn(e)!==e)throw Error(L(188))}function Qh(e){var n=e.alternate;if(!n){if(n=yn(e),n===null)throw Error(L(188));return n!==e?null:e}for(var r=e,l=n;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(l=s.return,l!==null){r=l;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return io(s),e;if(i===l)return io(s),n;i=i.sibling}throw Error(L(188))}if(r.return!==l.return)r=s,l=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,l=i;break}if(o===l){a=!0,l=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,l=s;break}if(o===l){a=!0,l=i,r=s;break}o=o.sibling}if(!a)throw Error(L(189))}}if(r.alternate!==l)throw Error(L(190))}if(r.tag!==3)throw Error(L(188));return r.stateNode.current===r?e:n}function sd(e){return e=Qh(e),e!==null?id(e):null}function id(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=id(e);if(n!==null)return n;e=e.sibling}return null}var ad=qe.unstable_scheduleCallback,ao=qe.unstable_cancelCallback,Xh=qe.unstable_shouldYield,Kh=qe.unstable_requestPaint,be=qe.unstable_now,Yh=qe.unstable_getCurrentPriorityLevel,ca=qe.unstable_ImmediatePriority,od=qe.unstable_UserBlockingPriority,Pl=qe.unstable_NormalPriority,qh=qe.unstable_LowPriority,cd=qe.unstable_IdlePriority,es=null,xt=null;function Gh(e){if(xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(es,e,void 0,(e.current.flags&128)===128)}catch{}}var dt=Math.clz32?Math.clz32:ef,Jh=Math.log,Zh=Math.LN2;function ef(e){return e>>>=0,e===0?32:31-(Jh(e)/Zh|0)|0}var nl=64,rl=4194304;function pr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Dl(e,n){var r=e.pendingLanes;if(r===0)return 0;var l=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?l=pr(o):(i&=a,i!==0&&(l=pr(i)))}else a=r&~s,a!==0?l=pr(a):i!==0&&(l=pr(i));if(l===0)return 0;if(n!==0&&n!==l&&!(n&s)&&(s=l&-l,i=n&-n,s>=i||s===16&&(i&4194240)!==0))return n;if(l&4&&(l|=r&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)r=31-dt(n),s=1<<r,l|=e[r],n&=~s;return l}function tf(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nf(e,n){for(var r=e.suspendedLanes,l=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-dt(i),o=1<<a,c=s[a];c===-1?(!(o&r)||o&l)&&(s[a]=tf(o,n)):c<=n&&(e.expiredLanes|=o),i&=~o}}function xi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dd(){var e=nl;return nl<<=1,!(nl&4194240)&&(nl=64),e}function Es(e){for(var n=[],r=0;31>r;r++)n.push(e);return n}function Vr(e,n,r){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-dt(n),e[n]=r}function rf(e,n){var r=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-dt(r),i=1<<s;n[s]=0,l[s]=-1,e[s]=-1,r&=~i}}function da(e,n){var r=e.entangledLanes|=n;for(e=e.entanglements;r;){var l=31-dt(r),s=1<<l;s&n|e[l]&n&&(e[l]|=n),r&=~s}}var se=0;function ud(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hd,ua,fd,pd,md,gi=!1,ll=[],$t=null,Mt=null,Ut=null,Tr=new Map,Rr=new Map,zt=[],lf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oo(e,n){switch(e){case"focusin":case"focusout":$t=null;break;case"dragenter":case"dragleave":Mt=null;break;case"mouseover":case"mouseout":Ut=null;break;case"pointerover":case"pointerout":Tr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rr.delete(n.pointerId)}}function ir(e,n,r,l,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:n,domEventName:r,eventSystemFlags:l,nativeEvent:i,targetContainers:[s]},n!==null&&(n=Xr(n),n!==null&&ua(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,s!==null&&n.indexOf(s)===-1&&n.push(s),e)}function sf(e,n,r,l,s){switch(n){case"focusin":return $t=ir($t,e,n,r,l,s),!0;case"dragenter":return Mt=ir(Mt,e,n,r,l,s),!0;case"mouseover":return Ut=ir(Ut,e,n,r,l,s),!0;case"pointerover":var i=s.pointerId;return Tr.set(i,ir(Tr.get(i)||null,e,n,r,l,s)),!0;case"gotpointercapture":return i=s.pointerId,Rr.set(i,ir(Rr.get(i)||null,e,n,r,l,s)),!0}return!1}function xd(e){var n=sn(e.target);if(n!==null){var r=yn(n);if(r!==null){if(n=r.tag,n===13){if(n=ld(r),n!==null){e.blockedOn=n,md(e.priority,function(){fd(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var r=yi(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var l=new r.constructor(r.type,r);hi=l,r.target.dispatchEvent(l),hi=null}else return n=Xr(r),n!==null&&ua(n),e.blockedOn=r,!1;n.shift()}return!0}function co(e,n,r){gl(e)&&r.delete(n)}function af(){gi=!1,$t!==null&&gl($t)&&($t=null),Mt!==null&&gl(Mt)&&(Mt=null),Ut!==null&&gl(Ut)&&(Ut=null),Tr.forEach(co),Rr.forEach(co)}function ar(e,n){e.blockedOn===n&&(e.blockedOn=null,gi||(gi=!0,qe.unstable_scheduleCallback(qe.unstable_NormalPriority,af)))}function Pr(e){function n(s){return ar(s,e)}if(0<ll.length){ar(ll[0],e);for(var r=1;r<ll.length;r++){var l=ll[r];l.blockedOn===e&&(l.blockedOn=null)}}for($t!==null&&ar($t,e),Mt!==null&&ar(Mt,e),Ut!==null&&ar(Ut,e),Tr.forEach(n),Rr.forEach(n),r=0;r<zt.length;r++)l=zt[r],l.blockedOn===e&&(l.blockedOn=null);for(;0<zt.length&&(r=zt[0],r.blockedOn===null);)xd(r),r.blockedOn===null&&zt.shift()}var $n=Pt.ReactCurrentBatchConfig,Il=!0;function of(e,n,r,l){var s=se,i=$n.transition;$n.transition=null;try{se=1,ha(e,n,r,l)}finally{se=s,$n.transition=i}}function cf(e,n,r,l){var s=se,i=$n.transition;$n.transition=null;try{se=4,ha(e,n,r,l)}finally{se=s,$n.transition=i}}function ha(e,n,r,l){if(Il){var s=yi(e,n,r,l);if(s===null)As(e,n,l,Fl,r),oo(e,l);else if(sf(s,e,n,r,l))l.stopPropagation();else if(oo(e,l),n&4&&-1<lf.indexOf(e)){for(;s!==null;){var i=Xr(s);if(i!==null&&hd(i),i=yi(e,n,r,l),i===null&&As(e,n,l,Fl,r),i===s)break;s=i}s!==null&&l.stopPropagation()}else As(e,n,l,null,r)}}var Fl=null;function yi(e,n,r,l){if(Fl=null,e=oa(l),e=sn(e),e!==null)if(n=yn(e),n===null)e=null;else if(r=n.tag,r===13){if(e=ld(n),e!==null)return e;e=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Fl=e,null}function gd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yh()){case ca:return 1;case od:return 4;case Pl:case qh:return 16;case cd:return 536870912;default:return 16}default:return 16}}var At=null,fa=null,yl=null;function yd(){if(yl)return yl;var e,n=fa,r=n.length,l,s="value"in At?At.value:At.textContent,i=s.length;for(e=0;e<r&&n[e]===s[e];e++);var a=r-e;for(l=1;l<=a&&n[r-l]===s[i-l];l++);return yl=s.slice(e,1<l?1-l:void 0)}function vl(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function sl(){return!0}function uo(){return!1}function Je(e){function n(r,l,s,i,a){this._reactName=r,this._targetInst=s,this.type=l,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?sl:uo,this.isPropagationStopped=uo,this}return ge(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=sl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=sl)},persist:function(){},isPersistent:sl}),n}var Zn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pa=Je(Zn),Qr=ge({},Zn,{view:0,detail:0}),df=Je(Qr),Ts,Rs,or,ts=ge({},Qr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ma,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&e.type==="mousemove"?(Ts=e.screenX-or.screenX,Rs=e.screenY-or.screenY):Rs=Ts=0,or=e),Ts)},movementY:function(e){return"movementY"in e?e.movementY:Rs}}),ho=Je(ts),uf=ge({},ts,{dataTransfer:0}),hf=Je(uf),ff=ge({},Qr,{relatedTarget:0}),Ps=Je(ff),pf=ge({},Zn,{animationName:0,elapsedTime:0,pseudoElement:0}),mf=Je(pf),xf=ge({},Zn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gf=Je(xf),yf=ge({},Zn,{data:0}),fo=Je(yf),vf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bf(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Sf[e])?!!n[e]:!1}function ma(){return bf}var wf=ge({},Qr,{key:function(e){if(e.key){var n=vf[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=vl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jf[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ma,charCode:function(e){return e.type==="keypress"?vl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),kf=Je(wf),Nf=ge({},ts,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),po=Je(Nf),Cf=ge({},Qr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ma}),Ef=Je(Cf),Tf=ge({},Zn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rf=Je(Tf),Pf=ge({},ts,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Df=Je(Pf),If=[9,13,27,32],xa=Ct&&"CompositionEvent"in window,yr=null;Ct&&"documentMode"in document&&(yr=document.documentMode);var Ff=Ct&&"TextEvent"in window&&!yr,vd=Ct&&(!xa||yr&&8<yr&&11>=yr),mo=" ",xo=!1;function jd(e,n){switch(e){case"keyup":return If.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var En=!1;function _f(e,n){switch(e){case"compositionend":return Sd(n);case"keypress":return n.which!==32?null:(xo=!0,mo);case"textInput":return e=n.data,e===mo&&xo?null:e;default:return null}}function zf(e,n){if(En)return e==="compositionend"||!xa&&jd(e,n)?(e=yd(),yl=fa=At=null,En=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return vd&&n.locale!=="ko"?null:n.data;default:return null}}var Lf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function go(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Lf[e.type]:n==="textarea"}function bd(e,n,r,l){Zc(l),n=_l(n,"onChange"),0<n.length&&(r=new pa("onChange","change",null,r,l),e.push({event:r,listeners:n}))}var vr=null,Dr=null;function Af(e){Fd(e,0)}function ns(e){var n=Pn(e);if(Qc(n))return e}function Bf(e,n){if(e==="change")return n}var wd=!1;if(Ct){var Ds;if(Ct){var Is="oninput"in document;if(!Is){var yo=document.createElement("div");yo.setAttribute("oninput","return;"),Is=typeof yo.oninput=="function"}Ds=Is}else Ds=!1;wd=Ds&&(!document.documentMode||9<document.documentMode)}function vo(){vr&&(vr.detachEvent("onpropertychange",kd),Dr=vr=null)}function kd(e){if(e.propertyName==="value"&&ns(Dr)){var n=[];bd(n,Dr,e,oa(e)),rd(Af,n)}}function Of(e,n,r){e==="focusin"?(vo(),vr=n,Dr=r,vr.attachEvent("onpropertychange",kd)):e==="focusout"&&vo()}function $f(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ns(Dr)}function Mf(e,n){if(e==="click")return ns(n)}function Uf(e,n){if(e==="input"||e==="change")return ns(n)}function Wf(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var ht=typeof Object.is=="function"?Object.is:Wf;function Ir(e,n){if(ht(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var r=Object.keys(e),l=Object.keys(n);if(r.length!==l.length)return!1;for(l=0;l<r.length;l++){var s=r[l];if(!ei.call(n,s)||!ht(e[s],n[s]))return!1}return!0}function jo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function So(e,n){var r=jo(e);e=0;for(var l;r;){if(r.nodeType===3){if(l=e+r.textContent.length,e<=n&&l>=n)return{node:r,offset:n-e};e=l}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=jo(r)}}function Nd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Nd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Cd(){for(var e=window,n=El();n instanceof e.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)e=n.contentWindow;else break;n=El(e.document)}return n}function ga(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Hf(e){var n=Cd(),r=e.focusedElem,l=e.selectionRange;if(n!==r&&r&&r.ownerDocument&&Nd(r.ownerDocument.documentElement,r)){if(l!==null&&ga(r)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in r)r.selectionStart=n,r.selectionEnd=Math.min(e,r.value.length);else if(e=(n=r.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(l.start,s);l=l.end===void 0?i:Math.min(l.end,s),!e.extend&&i>l&&(s=l,l=i,i=s),s=So(r,i);var a=So(r,l);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(n=n.createRange(),n.setStart(s.node,s.offset),e.removeAllRanges(),i>l?(e.addRange(n),e.extend(a.node,a.offset)):(n.setEnd(a.node,a.offset),e.addRange(n)))}}for(n=[],e=r;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<n.length;r++)e=n[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Vf=Ct&&"documentMode"in document&&11>=document.documentMode,Tn=null,vi=null,jr=null,ji=!1;function bo(e,n,r){var l=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ji||Tn==null||Tn!==El(l)||(l=Tn,"selectionStart"in l&&ga(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),jr&&Ir(jr,l)||(jr=l,l=_l(vi,"onSelect"),0<l.length&&(n=new pa("onSelect","select",null,n,r),e.push({event:n,listeners:l}),n.target=Tn)))}function il(e,n){var r={};return r[e.toLowerCase()]=n.toLowerCase(),r["Webkit"+e]="webkit"+n,r["Moz"+e]="moz"+n,r}var Rn={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionend:il("Transition","TransitionEnd")},Fs={},Ed={};Ct&&(Ed=document.createElement("div").style,"AnimationEvent"in window||(delete Rn.animationend.animation,delete Rn.animationiteration.animation,delete Rn.animationstart.animation),"TransitionEvent"in window||delete Rn.transitionend.transition);function rs(e){if(Fs[e])return Fs[e];if(!Rn[e])return e;var n=Rn[e],r;for(r in n)if(n.hasOwnProperty(r)&&r in Ed)return Fs[e]=n[r];return e}var Td=rs("animationend"),Rd=rs("animationiteration"),Pd=rs("animationstart"),Dd=rs("transitionend"),Id=new Map,wo="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gt(e,n){Id.set(e,n),gn(n,[e])}for(var _s=0;_s<wo.length;_s++){var zs=wo[_s],Qf=zs.toLowerCase(),Xf=zs[0].toUpperCase()+zs.slice(1);Gt(Qf,"on"+Xf)}Gt(Td,"onAnimationEnd");Gt(Rd,"onAnimationIteration");Gt(Pd,"onAnimationStart");Gt("dblclick","onDoubleClick");Gt("focusin","onFocus");Gt("focusout","onBlur");Gt(Dd,"onTransitionEnd");Wn("onMouseEnter",["mouseout","mouseover"]);Wn("onMouseLeave",["mouseout","mouseover"]);Wn("onPointerEnter",["pointerout","pointerover"]);Wn("onPointerLeave",["pointerout","pointerover"]);gn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gn("onBeforeInput",["compositionend","keypress","textInput","paste"]);gn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kf=new Set("cancel close invalid load scroll toggle".split(" ").concat(mr));function ko(e,n,r){var l=e.type||"unknown-event";e.currentTarget=r,Vh(l,n,void 0,e),e.currentTarget=null}function Fd(e,n){n=(n&4)!==0;for(var r=0;r<e.length;r++){var l=e[r],s=l.event;l=l.listeners;e:{var i=void 0;if(n)for(var a=l.length-1;0<=a;a--){var o=l[a],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&s.isPropagationStopped())break e;ko(s,o,d),i=c}else for(a=0;a<l.length;a++){if(o=l[a],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&s.isPropagationStopped())break e;ko(s,o,d),i=c}}}if(Rl)throw e=mi,Rl=!1,mi=null,e}function ue(e,n){var r=n[Ni];r===void 0&&(r=n[Ni]=new Set);var l=e+"__bubble";r.has(l)||(_d(n,e,2,!1),r.add(l))}function Ls(e,n,r){var l=0;n&&(l|=4),_d(r,e,l,n)}var al="_reactListening"+Math.random().toString(36).slice(2);function Fr(e){if(!e[al]){e[al]=!0,Mc.forEach(function(r){r!=="selectionchange"&&(Kf.has(r)||Ls(r,!1,e),Ls(r,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[al]||(n[al]=!0,Ls("selectionchange",!1,n))}}function _d(e,n,r,l){switch(gd(n)){case 1:var s=of;break;case 4:s=cf;break;default:s=ha}r=s.bind(null,n,r,e),s=void 0,!pi||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(s=!0),l?s!==void 0?e.addEventListener(n,r,{capture:!0,passive:s}):e.addEventListener(n,r,!0):s!==void 0?e.addEventListener(n,r,{passive:s}):e.addEventListener(n,r,!1)}function As(e,n,r,l,s){var i=l;if(!(n&1)&&!(n&2)&&l!==null)e:for(;;){if(l===null)return;var a=l.tag;if(a===3||a===4){var o=l.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=l.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;o!==null;){if(a=sn(o),a===null)return;if(c=a.tag,c===5||c===6){l=i=a;continue e}o=o.parentNode}}l=l.return}rd(function(){var d=i,j=oa(r),h=[];e:{var f=Id.get(e);if(f!==void 0){var m=pa,v=e;switch(e){case"keypress":if(vl(r)===0)break e;case"keydown":case"keyup":m=kf;break;case"focusin":v="focus",m=Ps;break;case"focusout":v="blur",m=Ps;break;case"beforeblur":case"afterblur":m=Ps;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=ho;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=hf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Ef;break;case Td:case Rd:case Pd:m=mf;break;case Dd:m=Rf;break;case"scroll":m=df;break;case"wheel":m=Df;break;case"copy":case"cut":case"paste":m=gf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=po}var S=(n&4)!==0,w=!S&&e==="scroll",g=S?f!==null?f+"Capture":null:f;S=[];for(var p=d,u;p!==null;){u=p;var y=u.stateNode;if(u.tag===5&&y!==null&&(u=y,g!==null&&(y=Er(p,g),y!=null&&S.push(_r(p,y,u)))),w)break;p=p.return}0<S.length&&(f=new m(f,v,null,r,j),h.push({event:f,listeners:S}))}}if(!(n&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&r!==hi&&(v=r.relatedTarget||r.fromElement)&&(sn(v)||v[Et]))break e;if((m||f)&&(f=j.window===j?j:(f=j.ownerDocument)?f.defaultView||f.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=d,v=v?sn(v):null,v!==null&&(w=yn(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(S=ho,y="onMouseLeave",g="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(S=po,y="onPointerLeave",g="onPointerEnter",p="pointer"),w=m==null?f:Pn(m),u=v==null?f:Pn(v),f=new S(y,p+"leave",m,r,j),f.target=w,f.relatedTarget=u,y=null,sn(j)===d&&(S=new S(g,p+"enter",v,r,j),S.target=u,S.relatedTarget=w,y=S),w=y,m&&v)t:{for(S=m,g=v,p=0,u=S;u;u=bn(u))p++;for(u=0,y=g;y;y=bn(y))u++;for(;0<p-u;)S=bn(S),p--;for(;0<u-p;)g=bn(g),u--;for(;p--;){if(S===g||g!==null&&S===g.alternate)break t;S=bn(S),g=bn(g)}S=null}else S=null;m!==null&&No(h,f,m,S,!1),v!==null&&w!==null&&No(h,w,v,S,!0)}}e:{if(f=d?Pn(d):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var E=Bf;else if(go(f))if(wd)E=Uf;else{E=$f;var I=Of}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=Mf);if(E&&(E=E(e,d))){bd(h,E,r,j);break e}I&&I(e,f,d),e==="focusout"&&(I=f._wrapperState)&&I.controlled&&f.type==="number"&&ai(f,"number",f.value)}switch(I=d?Pn(d):window,e){case"focusin":(go(I)||I.contentEditable==="true")&&(Tn=I,vi=d,jr=null);break;case"focusout":jr=vi=Tn=null;break;case"mousedown":ji=!0;break;case"contextmenu":case"mouseup":case"dragend":ji=!1,bo(h,r,j);break;case"selectionchange":if(Vf)break;case"keydown":case"keyup":bo(h,r,j)}var _;if(xa)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else En?jd(e,r)&&(z="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(z="onCompositionStart");z&&(vd&&r.locale!=="ko"&&(En||z!=="onCompositionStart"?z==="onCompositionEnd"&&En&&(_=yd()):(At=j,fa="value"in At?At.value:At.textContent,En=!0)),I=_l(d,z),0<I.length&&(z=new fo(z,e,null,r,j),h.push({event:z,listeners:I}),_?z.data=_:(_=Sd(r),_!==null&&(z.data=_)))),(_=Ff?_f(e,r):zf(e,r))&&(d=_l(d,"onBeforeInput"),0<d.length&&(j=new fo("onBeforeInput","beforeinput",null,r,j),h.push({event:j,listeners:d}),j.data=_))}Fd(h,n)})}function _r(e,n,r){return{instance:e,listener:n,currentTarget:r}}function _l(e,n){for(var r=n+"Capture",l=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Er(e,r),i!=null&&l.unshift(_r(e,i,s)),i=Er(e,n),i!=null&&l.push(_r(e,i,s))),e=e.return}return l}function bn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function No(e,n,r,l,s){for(var i=n._reactName,a=[];r!==null&&r!==l;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===l)break;o.tag===5&&d!==null&&(o=d,s?(c=Er(r,i),c!=null&&a.unshift(_r(r,c,o))):s||(c=Er(r,i),c!=null&&a.push(_r(r,c,o)))),r=r.return}a.length!==0&&e.push({event:n,listeners:a})}var Yf=/\r\n?/g,qf=/\u0000|\uFFFD/g;function Co(e){return(typeof e=="string"?e:""+e).replace(Yf,`
`).replace(qf,"")}function ol(e,n,r){if(n=Co(n),Co(e)!==n&&r)throw Error(L(425))}function zl(){}var Si=null,bi=null;function wi(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var ki=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Eo=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Eo<"u"?function(e){return Eo.resolve(null).then(e).catch(Zf)}:ki;function Zf(e){setTimeout(function(){throw e})}function Bs(e,n){var r=n,l=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(l===0){e.removeChild(s),Pr(n);return}l--}else r!=="$"&&r!=="$?"&&r!=="$!"||l++;r=s}while(r);Pr(n)}function Wt(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function To(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(n===0)return e;n--}else r==="/$"&&n++}e=e.previousSibling}return null}var er=Math.random().toString(36).slice(2),mt="__reactFiber$"+er,zr="__reactProps$"+er,Et="__reactContainer$"+er,Ni="__reactEvents$"+er,ep="__reactListeners$"+er,tp="__reactHandles$"+er;function sn(e){var n=e[mt];if(n)return n;for(var r=e.parentNode;r;){if(n=r[Et]||r[mt]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(e=To(e);e!==null;){if(r=e[mt])return r;e=To(e)}return n}e=r,r=e.parentNode}return null}function Xr(e){return e=e[mt]||e[Et],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Pn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(L(33))}function ls(e){return e[zr]||null}var Ci=[],Dn=-1;function Jt(e){return{current:e}}function he(e){0>Dn||(e.current=Ci[Dn],Ci[Dn]=null,Dn--)}function oe(e,n){Dn++,Ci[Dn]=e.current,e.current=n}var qt={},Ae=Jt(qt),He=Jt(!1),un=qt;function Hn(e,n){var r=e.type.contextTypes;if(!r)return qt;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=n[i];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ve(e){return e=e.childContextTypes,e!=null}function Ll(){he(He),he(Ae)}function Ro(e,n,r){if(Ae.current!==qt)throw Error(L(168));oe(Ae,n),oe(He,r)}function zd(e,n,r){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return r;l=l.getChildContext();for(var s in l)if(!(s in n))throw Error(L(108,Bh(e)||"Unknown",s));return ge({},r,l)}function Al(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||qt,un=Ae.current,oe(Ae,e),oe(He,He.current),!0}function Po(e,n,r){var l=e.stateNode;if(!l)throw Error(L(169));r?(e=zd(e,n,un),l.__reactInternalMemoizedMergedChildContext=e,he(He),he(Ae),oe(Ae,e)):he(He),oe(He,r)}var St=null,ss=!1,Os=!1;function Ld(e){St===null?St=[e]:St.push(e)}function np(e){ss=!0,Ld(e)}function Zt(){if(!Os&&St!==null){Os=!0;var e=0,n=se;try{var r=St;for(se=1;e<r.length;e++){var l=r[e];do l=l(!0);while(l!==null)}St=null,ss=!1}catch(s){throw St!==null&&(St=St.slice(e+1)),ad(ca,Zt),s}finally{se=n,Os=!1}}return null}var In=[],Fn=0,Bl=null,Ol=0,et=[],tt=0,hn=null,bt=1,wt="";function rn(e,n){In[Fn++]=Ol,In[Fn++]=Bl,Bl=e,Ol=n}function Ad(e,n,r){et[tt++]=bt,et[tt++]=wt,et[tt++]=hn,hn=e;var l=bt;e=wt;var s=32-dt(l)-1;l&=~(1<<s),r+=1;var i=32-dt(n)+s;if(30<i){var a=s-s%5;i=(l&(1<<a)-1).toString(32),l>>=a,s-=a,bt=1<<32-dt(n)+s|r<<s|l,wt=i+e}else bt=1<<i|r<<s|l,wt=e}function ya(e){e.return!==null&&(rn(e,1),Ad(e,1,0))}function va(e){for(;e===Bl;)Bl=In[--Fn],In[Fn]=null,Ol=In[--Fn],In[Fn]=null;for(;e===hn;)hn=et[--tt],et[tt]=null,wt=et[--tt],et[tt]=null,bt=et[--tt],et[tt]=null}var Ye=null,Ke=null,pe=!1,ct=null;function Bd(e,n){var r=nt(5,null,null,0);r.elementType="DELETED",r.stateNode=n,r.return=e,n=e.deletions,n===null?(e.deletions=[r],e.flags|=16):n.push(r)}function Do(e,n){switch(e.tag){case 5:var r=e.type;return n=n.nodeType!==1||r.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Ye=e,Ke=Wt(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Ye=e,Ke=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(r=hn!==null?{id:bt,overflow:wt}:null,e.memoizedState={dehydrated:n,treeContext:r,retryLane:1073741824},r=nt(18,null,null,0),r.stateNode=n,r.return=e,e.child=r,Ye=e,Ke=null,!0):!1;default:return!1}}function Ei(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ti(e){if(pe){var n=Ke;if(n){var r=n;if(!Do(e,n)){if(Ei(e))throw Error(L(418));n=Wt(r.nextSibling);var l=Ye;n&&Do(e,n)?Bd(l,r):(e.flags=e.flags&-4097|2,pe=!1,Ye=e)}}else{if(Ei(e))throw Error(L(418));e.flags=e.flags&-4097|2,pe=!1,Ye=e}}}function Io(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ye=e}function cl(e){if(e!==Ye)return!1;if(!pe)return Io(e),pe=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!wi(e.type,e.memoizedProps)),n&&(n=Ke)){if(Ei(e))throw Od(),Error(L(418));for(;n;)Bd(e,n),n=Wt(n.nextSibling)}if(Io(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(L(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(n===0){Ke=Wt(e.nextSibling);break e}n--}else r!=="$"&&r!=="$!"&&r!=="$?"||n++}e=e.nextSibling}Ke=null}}else Ke=Ye?Wt(e.stateNode.nextSibling):null;return!0}function Od(){for(var e=Ke;e;)e=Wt(e.nextSibling)}function Vn(){Ke=Ye=null,pe=!1}function ja(e){ct===null?ct=[e]:ct.push(e)}var rp=Pt.ReactCurrentBatchConfig;function cr(e,n,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(L(309));var l=r.stateNode}if(!l)throw Error(L(147,e));var s=l,i=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===i?n.ref:(n=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},n._stringRef=i,n)}if(typeof e!="string")throw Error(L(284));if(!r._owner)throw Error(L(290,e))}return e}function dl(e,n){throw e=Object.prototype.toString.call(n),Error(L(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Fo(e){var n=e._init;return n(e._payload)}function $d(e){function n(g,p){if(e){var u=g.deletions;u===null?(g.deletions=[p],g.flags|=16):u.push(p)}}function r(g,p){if(!e)return null;for(;p!==null;)n(g,p),p=p.sibling;return null}function l(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function s(g,p){return g=Xt(g,p),g.index=0,g.sibling=null,g}function i(g,p,u){return g.index=u,e?(u=g.alternate,u!==null?(u=u.index,u<p?(g.flags|=2,p):u):(g.flags|=2,p)):(g.flags|=1048576,p)}function a(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,p,u,y){return p===null||p.tag!==6?(p=Qs(u,g.mode,y),p.return=g,p):(p=s(p,u),p.return=g,p)}function c(g,p,u,y){var E=u.type;return E===Cn?j(g,p,u.props.children,y,u.key):p!==null&&(p.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ft&&Fo(E)===p.type)?(y=s(p,u.props),y.ref=cr(g,p,u),y.return=g,y):(y=Cl(u.type,u.key,u.props,null,g.mode,y),y.ref=cr(g,p,u),y.return=g,y)}function d(g,p,u,y){return p===null||p.tag!==4||p.stateNode.containerInfo!==u.containerInfo||p.stateNode.implementation!==u.implementation?(p=Xs(u,g.mode,y),p.return=g,p):(p=s(p,u.children||[]),p.return=g,p)}function j(g,p,u,y,E){return p===null||p.tag!==7?(p=dn(u,g.mode,y,E),p.return=g,p):(p=s(p,u),p.return=g,p)}function h(g,p,u){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Qs(""+p,g.mode,u),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Zr:return u=Cl(p.type,p.key,p.props,null,g.mode,u),u.ref=cr(g,null,p),u.return=g,u;case Nn:return p=Xs(p,g.mode,u),p.return=g,p;case Ft:var y=p._init;return h(g,y(p._payload),u)}if(fr(p)||lr(p))return p=dn(p,g.mode,u,null),p.return=g,p;dl(g,p)}return null}function f(g,p,u,y){var E=p!==null?p.key:null;if(typeof u=="string"&&u!==""||typeof u=="number")return E!==null?null:o(g,p,""+u,y);if(typeof u=="object"&&u!==null){switch(u.$$typeof){case Zr:return u.key===E?c(g,p,u,y):null;case Nn:return u.key===E?d(g,p,u,y):null;case Ft:return E=u._init,f(g,p,E(u._payload),y)}if(fr(u)||lr(u))return E!==null?null:j(g,p,u,y,null);dl(g,u)}return null}function m(g,p,u,y,E){if(typeof y=="string"&&y!==""||typeof y=="number")return g=g.get(u)||null,o(p,g,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Zr:return g=g.get(y.key===null?u:y.key)||null,c(p,g,y,E);case Nn:return g=g.get(y.key===null?u:y.key)||null,d(p,g,y,E);case Ft:var I=y._init;return m(g,p,u,I(y._payload),E)}if(fr(y)||lr(y))return g=g.get(u)||null,j(p,g,y,E,null);dl(p,y)}return null}function v(g,p,u,y){for(var E=null,I=null,_=p,z=p=0,D=null;_!==null&&z<u.length;z++){_.index>z?(D=_,_=null):D=_.sibling;var C=f(g,_,u[z],y);if(C===null){_===null&&(_=D);break}e&&_&&C.alternate===null&&n(g,_),p=i(C,p,z),I===null?E=C:I.sibling=C,I=C,_=D}if(z===u.length)return r(g,_),pe&&rn(g,z),E;if(_===null){for(;z<u.length;z++)_=h(g,u[z],y),_!==null&&(p=i(_,p,z),I===null?E=_:I.sibling=_,I=_);return pe&&rn(g,z),E}for(_=l(g,_);z<u.length;z++)D=m(_,g,z,u[z],y),D!==null&&(e&&D.alternate!==null&&_.delete(D.key===null?z:D.key),p=i(D,p,z),I===null?E=D:I.sibling=D,I=D);return e&&_.forEach(function(R){return n(g,R)}),pe&&rn(g,z),E}function S(g,p,u,y){var E=lr(u);if(typeof E!="function")throw Error(L(150));if(u=E.call(u),u==null)throw Error(L(151));for(var I=E=null,_=p,z=p=0,D=null,C=u.next();_!==null&&!C.done;z++,C=u.next()){_.index>z?(D=_,_=null):D=_.sibling;var R=f(g,_,C.value,y);if(R===null){_===null&&(_=D);break}e&&_&&R.alternate===null&&n(g,_),p=i(R,p,z),I===null?E=R:I.sibling=R,I=R,_=D}if(C.done)return r(g,_),pe&&rn(g,z),E;if(_===null){for(;!C.done;z++,C=u.next())C=h(g,C.value,y),C!==null&&(p=i(C,p,z),I===null?E=C:I.sibling=C,I=C);return pe&&rn(g,z),E}for(_=l(g,_);!C.done;z++,C=u.next())C=m(_,g,z,C.value,y),C!==null&&(e&&C.alternate!==null&&_.delete(C.key===null?z:C.key),p=i(C,p,z),I===null?E=C:I.sibling=C,I=C);return e&&_.forEach(function(ne){return n(g,ne)}),pe&&rn(g,z),E}function w(g,p,u,y){if(typeof u=="object"&&u!==null&&u.type===Cn&&u.key===null&&(u=u.props.children),typeof u=="object"&&u!==null){switch(u.$$typeof){case Zr:e:{for(var E=u.key,I=p;I!==null;){if(I.key===E){if(E=u.type,E===Cn){if(I.tag===7){r(g,I.sibling),p=s(I,u.props.children),p.return=g,g=p;break e}}else if(I.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ft&&Fo(E)===I.type){r(g,I.sibling),p=s(I,u.props),p.ref=cr(g,I,u),p.return=g,g=p;break e}r(g,I);break}else n(g,I);I=I.sibling}u.type===Cn?(p=dn(u.props.children,g.mode,y,u.key),p.return=g,g=p):(y=Cl(u.type,u.key,u.props,null,g.mode,y),y.ref=cr(g,p,u),y.return=g,g=y)}return a(g);case Nn:e:{for(I=u.key;p!==null;){if(p.key===I)if(p.tag===4&&p.stateNode.containerInfo===u.containerInfo&&p.stateNode.implementation===u.implementation){r(g,p.sibling),p=s(p,u.children||[]),p.return=g,g=p;break e}else{r(g,p);break}else n(g,p);p=p.sibling}p=Xs(u,g.mode,y),p.return=g,g=p}return a(g);case Ft:return I=u._init,w(g,p,I(u._payload),y)}if(fr(u))return v(g,p,u,y);if(lr(u))return S(g,p,u,y);dl(g,u)}return typeof u=="string"&&u!==""||typeof u=="number"?(u=""+u,p!==null&&p.tag===6?(r(g,p.sibling),p=s(p,u),p.return=g,g=p):(r(g,p),p=Qs(u,g.mode,y),p.return=g,g=p),a(g)):r(g,p)}return w}var Qn=$d(!0),Md=$d(!1),$l=Jt(null),Ml=null,_n=null,Sa=null;function ba(){Sa=_n=Ml=null}function wa(e){var n=$l.current;he($l),e._currentValue=n}function Ri(e,n,r){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===r)break;e=e.return}}function Mn(e,n){Ml=e,Sa=_n=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(We=!0),e.firstContext=null)}function lt(e){var n=e._currentValue;if(Sa!==e)if(e={context:e,memoizedValue:n,next:null},_n===null){if(Ml===null)throw Error(L(308));_n=e,Ml.dependencies={lanes:0,firstContext:e}}else _n=_n.next=e;return n}var an=null;function ka(e){an===null?an=[e]:an.push(e)}function Ud(e,n,r,l){var s=n.interleaved;return s===null?(r.next=r,ka(n)):(r.next=s.next,s.next=r),n.interleaved=r,Tt(e,l)}function Tt(e,n){e.lanes|=n;var r=e.alternate;for(r!==null&&(r.lanes|=n),r=e,e=e.return;e!==null;)e.childLanes|=n,r=e.alternate,r!==null&&(r.childLanes|=n),r=e,e=e.return;return r.tag===3?r.stateNode:null}var _t=!1;function Na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wd(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kt(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Ht(e,n,r){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,le&2){var s=l.pending;return s===null?n.next=n:(n.next=s.next,s.next=n),l.pending=n,Tt(e,r)}return s=l.interleaved,s===null?(n.next=n,ka(l)):(n.next=s.next,s.next=n),l.interleaved=n,Tt(e,r)}function jl(e,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,r|=l,n.lanes=r,da(e,r)}}function _o(e,n){var r=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,r===l)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=n:i=i.next=n}else s=i=n;r={baseState:l.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:l.shared,effects:l.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=n:e.next=n,r.lastBaseUpdate=n}function Ul(e,n,r,l){var s=e.updateQueue;_t=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var j=e.alternate;j!==null&&(j=j.updateQueue,o=j.lastBaseUpdate,o!==a&&(o===null?j.firstBaseUpdate=d:o.next=d,j.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,j=d=c=null,o=i;do{var f=o.lane,m=o.eventTime;if((l&f)===f){j!==null&&(j=j.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,S=o;switch(f=n,m=r,S.tag){case 1:if(v=S.payload,typeof v=="function"){h=v.call(m,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=S.payload,f=typeof v=="function"?v.call(m,h,f):v,f==null)break e;h=ge({},h,f);break e;case 2:_t=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else m={eventTime:m,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},j===null?(d=j=m,c=h):j=j.next=m,a|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(j===null&&(c=h),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=j,n=s.shared.interleaved,n!==null){s=n;do a|=s.lane,s=s.next;while(s!==n)}else i===null&&(s.shared.lanes=0);pn|=a,e.lanes=a,e.memoizedState=h}}function zo(e,n,r){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],s=l.callback;if(s!==null){if(l.callback=null,l=r,typeof s!="function")throw Error(L(191,s));s.call(l)}}}var Kr={},gt=Jt(Kr),Lr=Jt(Kr),Ar=Jt(Kr);function on(e){if(e===Kr)throw Error(L(174));return e}function Ca(e,n){switch(oe(Ar,n),oe(Lr,e),oe(gt,Kr),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:ci(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=ci(n,e)}he(gt),oe(gt,n)}function Xn(){he(gt),he(Lr),he(Ar)}function Hd(e){on(Ar.current);var n=on(gt.current),r=ci(n,e.type);n!==r&&(oe(Lr,e),oe(gt,r))}function Ea(e){Lr.current===e&&(he(gt),he(Lr))}var me=Jt(0);function Wl(e){for(var n=e;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var $s=[];function Ta(){for(var e=0;e<$s.length;e++)$s[e]._workInProgressVersionPrimary=null;$s.length=0}var Sl=Pt.ReactCurrentDispatcher,Ms=Pt.ReactCurrentBatchConfig,fn=0,xe=null,ke=null,Ce=null,Hl=!1,Sr=!1,Br=0,lp=0;function _e(){throw Error(L(321))}function Ra(e,n){if(n===null)return!1;for(var r=0;r<n.length&&r<e.length;r++)if(!ht(e[r],n[r]))return!1;return!0}function Pa(e,n,r,l,s,i){if(fn=i,xe=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Sl.current=e===null||e.memoizedState===null?op:cp,e=r(l,s),Sr){i=0;do{if(Sr=!1,Br=0,25<=i)throw Error(L(301));i+=1,Ce=ke=null,n.updateQueue=null,Sl.current=dp,e=r(l,s)}while(Sr)}if(Sl.current=Vl,n=ke!==null&&ke.next!==null,fn=0,Ce=ke=xe=null,Hl=!1,n)throw Error(L(300));return e}function Da(){var e=Br!==0;return Br=0,e}function pt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ce===null?xe.memoizedState=Ce=e:Ce=Ce.next=e,Ce}function st(){if(ke===null){var e=xe.alternate;e=e!==null?e.memoizedState:null}else e=ke.next;var n=Ce===null?xe.memoizedState:Ce.next;if(n!==null)Ce=n,ke=e;else{if(e===null)throw Error(L(310));ke=e,e={memoizedState:ke.memoizedState,baseState:ke.baseState,baseQueue:ke.baseQueue,queue:ke.queue,next:null},Ce===null?xe.memoizedState=Ce=e:Ce=Ce.next=e}return Ce}function Or(e,n){return typeof n=="function"?n(e):n}function Us(e){var n=st(),r=n.queue;if(r===null)throw Error(L(311));r.lastRenderedReducer=e;var l=ke,s=l.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}l.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,l=l.baseState;var o=a=null,c=null,d=i;do{var j=d.lane;if((fn&j)===j)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),l=d.hasEagerState?d.eagerState:e(l,d.action);else{var h={lane:j,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=h,a=l):c=c.next=h,xe.lanes|=j,pn|=j}d=d.next}while(d!==null&&d!==i);c===null?a=l:c.next=o,ht(l,n.memoizedState)||(We=!0),n.memoizedState=l,n.baseState=a,n.baseQueue=c,r.lastRenderedState=l}if(e=r.interleaved,e!==null){s=e;do i=s.lane,xe.lanes|=i,pn|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[n.memoizedState,r.dispatch]}function Ws(e){var n=st(),r=n.queue;if(r===null)throw Error(L(311));r.lastRenderedReducer=e;var l=r.dispatch,s=r.pending,i=n.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);ht(i,n.memoizedState)||(We=!0),n.memoizedState=i,n.baseQueue===null&&(n.baseState=i),r.lastRenderedState=i}return[i,l]}function Vd(){}function Qd(e,n){var r=xe,l=st(),s=n(),i=!ht(l.memoizedState,s);if(i&&(l.memoizedState=s,We=!0),l=l.queue,Ia(Yd.bind(null,r,l,e),[e]),l.getSnapshot!==n||i||Ce!==null&&Ce.memoizedState.tag&1){if(r.flags|=2048,$r(9,Kd.bind(null,r,l,s,n),void 0,null),Ee===null)throw Error(L(349));fn&30||Xd(r,n,s)}return s}function Xd(e,n,r){e.flags|=16384,e={getSnapshot:n,value:r},n=xe.updateQueue,n===null?(n={lastEffect:null,stores:null},xe.updateQueue=n,n.stores=[e]):(r=n.stores,r===null?n.stores=[e]:r.push(e))}function Kd(e,n,r,l){n.value=r,n.getSnapshot=l,qd(n)&&Gd(e)}function Yd(e,n,r){return r(function(){qd(n)&&Gd(e)})}function qd(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!ht(e,r)}catch{return!0}}function Gd(e){var n=Tt(e,1);n!==null&&ut(n,e,1,-1)}function Lo(e){var n=pt();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Or,lastRenderedState:e},n.queue=e,e=e.dispatch=ap.bind(null,xe,e),[n.memoizedState,e]}function $r(e,n,r,l){return e={tag:e,create:n,destroy:r,deps:l,next:null},n=xe.updateQueue,n===null?(n={lastEffect:null,stores:null},xe.updateQueue=n,n.lastEffect=e.next=e):(r=n.lastEffect,r===null?n.lastEffect=e.next=e:(l=r.next,r.next=e,e.next=l,n.lastEffect=e)),e}function Jd(){return st().memoizedState}function bl(e,n,r,l){var s=pt();xe.flags|=e,s.memoizedState=$r(1|n,r,void 0,l===void 0?null:l)}function is(e,n,r,l){var s=st();l=l===void 0?null:l;var i=void 0;if(ke!==null){var a=ke.memoizedState;if(i=a.destroy,l!==null&&Ra(l,a.deps)){s.memoizedState=$r(n,r,i,l);return}}xe.flags|=e,s.memoizedState=$r(1|n,r,i,l)}function Ao(e,n){return bl(8390656,8,e,n)}function Ia(e,n){return is(2048,8,e,n)}function Zd(e,n){return is(4,2,e,n)}function eu(e,n){return is(4,4,e,n)}function tu(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function nu(e,n,r){return r=r!=null?r.concat([e]):null,is(4,4,tu.bind(null,n,e),r)}function Fa(){}function ru(e,n){var r=st();n=n===void 0?null:n;var l=r.memoizedState;return l!==null&&n!==null&&Ra(n,l[1])?l[0]:(r.memoizedState=[e,n],e)}function lu(e,n){var r=st();n=n===void 0?null:n;var l=r.memoizedState;return l!==null&&n!==null&&Ra(n,l[1])?l[0]:(e=e(),r.memoizedState=[e,n],e)}function su(e,n,r){return fn&21?(ht(r,n)||(r=dd(),xe.lanes|=r,pn|=r,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,We=!0),e.memoizedState=r)}function sp(e,n){var r=se;se=r!==0&&4>r?r:4,e(!0);var l=Ms.transition;Ms.transition={};try{e(!1),n()}finally{se=r,Ms.transition=l}}function iu(){return st().memoizedState}function ip(e,n,r){var l=Qt(e);if(r={lane:l,action:r,hasEagerState:!1,eagerState:null,next:null},au(e))ou(n,r);else if(r=Ud(e,n,r,l),r!==null){var s=Oe();ut(r,e,l,s),cu(r,n,l)}}function ap(e,n,r){var l=Qt(e),s={lane:l,action:r,hasEagerState:!1,eagerState:null,next:null};if(au(e))ou(n,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=n.lastRenderedReducer,i!==null))try{var a=n.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,ht(o,a)){var c=n.interleaved;c===null?(s.next=s,ka(n)):(s.next=c.next,c.next=s),n.interleaved=s;return}}catch{}finally{}r=Ud(e,n,s,l),r!==null&&(s=Oe(),ut(r,e,l,s),cu(r,n,l))}}function au(e){var n=e.alternate;return e===xe||n!==null&&n===xe}function ou(e,n){Sr=Hl=!0;var r=e.pending;r===null?n.next=n:(n.next=r.next,r.next=n),e.pending=n}function cu(e,n,r){if(r&4194240){var l=n.lanes;l&=e.pendingLanes,r|=l,n.lanes=r,da(e,r)}}var Vl={readContext:lt,useCallback:_e,useContext:_e,useEffect:_e,useImperativeHandle:_e,useInsertionEffect:_e,useLayoutEffect:_e,useMemo:_e,useReducer:_e,useRef:_e,useState:_e,useDebugValue:_e,useDeferredValue:_e,useTransition:_e,useMutableSource:_e,useSyncExternalStore:_e,useId:_e,unstable_isNewReconciler:!1},op={readContext:lt,useCallback:function(e,n){return pt().memoizedState=[e,n===void 0?null:n],e},useContext:lt,useEffect:Ao,useImperativeHandle:function(e,n,r){return r=r!=null?r.concat([e]):null,bl(4194308,4,tu.bind(null,n,e),r)},useLayoutEffect:function(e,n){return bl(4194308,4,e,n)},useInsertionEffect:function(e,n){return bl(4,2,e,n)},useMemo:function(e,n){var r=pt();return n=n===void 0?null:n,e=e(),r.memoizedState=[e,n],e},useReducer:function(e,n,r){var l=pt();return n=r!==void 0?r(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=ip.bind(null,xe,e),[l.memoizedState,e]},useRef:function(e){var n=pt();return e={current:e},n.memoizedState=e},useState:Lo,useDebugValue:Fa,useDeferredValue:function(e){return pt().memoizedState=e},useTransition:function(){var e=Lo(!1),n=e[0];return e=sp.bind(null,e[1]),pt().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,r){var l=xe,s=pt();if(pe){if(r===void 0)throw Error(L(407));r=r()}else{if(r=n(),Ee===null)throw Error(L(349));fn&30||Xd(l,n,r)}s.memoizedState=r;var i={value:r,getSnapshot:n};return s.queue=i,Ao(Yd.bind(null,l,i,e),[e]),l.flags|=2048,$r(9,Kd.bind(null,l,i,r,n),void 0,null),r},useId:function(){var e=pt(),n=Ee.identifierPrefix;if(pe){var r=wt,l=bt;r=(l&~(1<<32-dt(l)-1)).toString(32)+r,n=":"+n+"R"+r,r=Br++,0<r&&(n+="H"+r.toString(32)),n+=":"}else r=lp++,n=":"+n+"r"+r.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},cp={readContext:lt,useCallback:ru,useContext:lt,useEffect:Ia,useImperativeHandle:nu,useInsertionEffect:Zd,useLayoutEffect:eu,useMemo:lu,useReducer:Us,useRef:Jd,useState:function(){return Us(Or)},useDebugValue:Fa,useDeferredValue:function(e){var n=st();return su(n,ke.memoizedState,e)},useTransition:function(){var e=Us(Or)[0],n=st().memoizedState;return[e,n]},useMutableSource:Vd,useSyncExternalStore:Qd,useId:iu,unstable_isNewReconciler:!1},dp={readContext:lt,useCallback:ru,useContext:lt,useEffect:Ia,useImperativeHandle:nu,useInsertionEffect:Zd,useLayoutEffect:eu,useMemo:lu,useReducer:Ws,useRef:Jd,useState:function(){return Ws(Or)},useDebugValue:Fa,useDeferredValue:function(e){var n=st();return ke===null?n.memoizedState=e:su(n,ke.memoizedState,e)},useTransition:function(){var e=Ws(Or)[0],n=st().memoizedState;return[e,n]},useMutableSource:Vd,useSyncExternalStore:Qd,useId:iu,unstable_isNewReconciler:!1};function at(e,n){if(e&&e.defaultProps){n=ge({},n),e=e.defaultProps;for(var r in e)n[r]===void 0&&(n[r]=e[r]);return n}return n}function Pi(e,n,r,l){n=e.memoizedState,r=r(l,n),r=r==null?n:ge({},n,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var as={isMounted:function(e){return(e=e._reactInternals)?yn(e)===e:!1},enqueueSetState:function(e,n,r){e=e._reactInternals;var l=Oe(),s=Qt(e),i=kt(l,s);i.payload=n,r!=null&&(i.callback=r),n=Ht(e,i,s),n!==null&&(ut(n,e,s,l),jl(n,e,s))},enqueueReplaceState:function(e,n,r){e=e._reactInternals;var l=Oe(),s=Qt(e),i=kt(l,s);i.tag=1,i.payload=n,r!=null&&(i.callback=r),n=Ht(e,i,s),n!==null&&(ut(n,e,s,l),jl(n,e,s))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var r=Oe(),l=Qt(e),s=kt(r,l);s.tag=2,n!=null&&(s.callback=n),n=Ht(e,s,l),n!==null&&(ut(n,e,l,r),jl(n,e,l))}};function Bo(e,n,r,l,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,i,a):n.prototype&&n.prototype.isPureReactComponent?!Ir(r,l)||!Ir(s,i):!0}function du(e,n,r){var l=!1,s=qt,i=n.contextType;return typeof i=="object"&&i!==null?i=lt(i):(s=Ve(n)?un:Ae.current,l=n.contextTypes,i=(l=l!=null)?Hn(e,s):qt),n=new n(r,i),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=as,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),n}function Oo(e,n,r,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,l),n.state!==e&&as.enqueueReplaceState(n,n.state,null)}function Di(e,n,r,l){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Na(e);var i=n.contextType;typeof i=="object"&&i!==null?s.context=lt(i):(i=Ve(n)?un:Ae.current,s.context=Hn(e,i)),s.state=e.memoizedState,i=n.getDerivedStateFromProps,typeof i=="function"&&(Pi(e,n,i,r),s.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(n=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),n!==s.state&&as.enqueueReplaceState(s,s.state,null),Ul(e,r,s,l),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Kn(e,n){try{var r="",l=n;do r+=Ah(l),l=l.return;while(l);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:n,stack:s,digest:null}}function Hs(e,n,r){return{value:e,source:null,stack:r??null,digest:n??null}}function Ii(e,n){try{console.error(n.value)}catch(r){setTimeout(function(){throw r})}}var up=typeof WeakMap=="function"?WeakMap:Map;function uu(e,n,r){r=kt(-1,r),r.tag=3,r.payload={element:null};var l=n.value;return r.callback=function(){Xl||(Xl=!0,Ui=l),Ii(e,n)},r}function hu(e,n,r){r=kt(-1,r),r.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var s=n.value;r.payload=function(){return l(s)},r.callback=function(){Ii(e,n)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Ii(e,n),typeof l!="function"&&(Vt===null?Vt=new Set([this]):Vt.add(this));var a=n.stack;this.componentDidCatch(n.value,{componentStack:a!==null?a:""})}),r}function $o(e,n,r){var l=e.pingCache;if(l===null){l=e.pingCache=new up;var s=new Set;l.set(n,s)}else s=l.get(n),s===void 0&&(s=new Set,l.set(n,s));s.has(r)||(s.add(r),e=Np.bind(null,e,n,r),n.then(e,e))}function Mo(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Uo(e,n,r,l,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===n?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(n=kt(-1,1),n.tag=2,Ht(r,n,1))),r.lanes|=1),e)}var hp=Pt.ReactCurrentOwner,We=!1;function Be(e,n,r,l){n.child=e===null?Md(n,null,r,l):Qn(n,e.child,r,l)}function Wo(e,n,r,l,s){r=r.render;var i=n.ref;return Mn(n,s),l=Pa(e,n,r,l,i,s),r=Da(),e!==null&&!We?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~s,Rt(e,n,s)):(pe&&r&&ya(n),n.flags|=1,Be(e,n,l,s),n.child)}function Ho(e,n,r,l,s){if(e===null){var i=r.type;return typeof i=="function"&&!Ma(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(n.tag=15,n.type=i,fu(e,n,i,l,s)):(e=Cl(r.type,null,l,n,n.mode,s),e.ref=n.ref,e.return=n,n.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ir,r(a,l)&&e.ref===n.ref)return Rt(e,n,s)}return n.flags|=1,e=Xt(i,l),e.ref=n.ref,e.return=n,n.child=e}function fu(e,n,r,l,s){if(e!==null){var i=e.memoizedProps;if(Ir(i,l)&&e.ref===n.ref)if(We=!1,n.pendingProps=l=i,(e.lanes&s)!==0)e.flags&131072&&(We=!0);else return n.lanes=e.lanes,Rt(e,n,s)}return Fi(e,n,r,l,s)}function pu(e,n,r){var l=n.pendingProps,s=l.children,i=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},oe(Ln,Xe),Xe|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,oe(Ln,Xe),Xe|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=i!==null?i.baseLanes:r,oe(Ln,Xe),Xe|=l}else i!==null?(l=i.baseLanes|r,n.memoizedState=null):l=r,oe(Ln,Xe),Xe|=l;return Be(e,n,s,r),n.child}function mu(e,n){var r=n.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(n.flags|=512,n.flags|=2097152)}function Fi(e,n,r,l,s){var i=Ve(r)?un:Ae.current;return i=Hn(n,i),Mn(n,s),r=Pa(e,n,r,l,i,s),l=Da(),e!==null&&!We?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~s,Rt(e,n,s)):(pe&&l&&ya(n),n.flags|=1,Be(e,n,r,s),n.child)}function Vo(e,n,r,l,s){if(Ve(r)){var i=!0;Al(n)}else i=!1;if(Mn(n,s),n.stateNode===null)wl(e,n),du(n,r,l),Di(n,r,l,s),l=!0;else if(e===null){var a=n.stateNode,o=n.memoizedProps;a.props=o;var c=a.context,d=r.contextType;typeof d=="object"&&d!==null?d=lt(d):(d=Ve(r)?un:Ae.current,d=Hn(n,d));var j=r.getDerivedStateFromProps,h=typeof j=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==l||c!==d)&&Oo(n,a,l,d),_t=!1;var f=n.memoizedState;a.state=f,Ul(n,l,a,s),c=n.memoizedState,o!==l||f!==c||He.current||_t?(typeof j=="function"&&(Pi(n,r,j,l),c=n.memoizedState),(o=_t||Bo(n,r,o,l,f,c,d))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(n.flags|=4194308)):(typeof a.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=c),a.props=l,a.state=c,a.context=d,l=o):(typeof a.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{a=n.stateNode,Wd(e,n),o=n.memoizedProps,d=n.type===n.elementType?o:at(n.type,o),a.props=d,h=n.pendingProps,f=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=lt(c):(c=Ve(r)?un:Ae.current,c=Hn(n,c));var m=r.getDerivedStateFromProps;(j=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||f!==c)&&Oo(n,a,l,c),_t=!1,f=n.memoizedState,a.state=f,Ul(n,l,a,s);var v=n.memoizedState;o!==h||f!==v||He.current||_t?(typeof m=="function"&&(Pi(n,r,m,l),v=n.memoizedState),(d=_t||Bo(n,r,d,l,f,v,c)||!1)?(j||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(l,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(l,v,c)),typeof a.componentDidUpdate=="function"&&(n.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(n.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=v),a.props=l,a.state=v,a.context=c,l=d):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(n.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(n.flags|=1024),l=!1)}return _i(e,n,r,l,i,s)}function _i(e,n,r,l,s,i){mu(e,n);var a=(n.flags&128)!==0;if(!l&&!a)return s&&Po(n,r,!1),Rt(e,n,i);l=n.stateNode,hp.current=n;var o=a&&typeof r.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&a?(n.child=Qn(n,e.child,null,i),n.child=Qn(n,null,o,i)):Be(e,n,o,i),n.memoizedState=l.state,s&&Po(n,r,!0),n.child}function xu(e){var n=e.stateNode;n.pendingContext?Ro(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Ro(e,n.context,!1),Ca(e,n.containerInfo)}function Qo(e,n,r,l,s){return Vn(),ja(s),n.flags|=256,Be(e,n,r,l),n.child}var zi={dehydrated:null,treeContext:null,retryLane:0};function Li(e){return{baseLanes:e,cachePool:null,transitions:null}}function gu(e,n,r){var l=n.pendingProps,s=me.current,i=!1,a=(n.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),oe(me,s&1),e===null)return Ti(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(a=l.children,e=l.fallback,i?(l=n.mode,i=n.child,a={mode:"hidden",children:a},!(l&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=ds(a,l,0,null),e=dn(e,l,r,null),i.return=n,e.return=n,i.sibling=e,n.child=i,n.child.memoizedState=Li(r),n.memoizedState=zi,e):_a(n,a));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return fp(e,n,a,l,o,s,r);if(i){i=l.fallback,a=n.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:l.children};return!(a&1)&&n.child!==s?(l=n.child,l.childLanes=0,l.pendingProps=c,n.deletions=null):(l=Xt(s,c),l.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Xt(o,i):(i=dn(i,a,r,null),i.flags|=2),i.return=n,l.return=n,l.sibling=i,n.child=l,l=i,i=n.child,a=e.child.memoizedState,a=a===null?Li(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,n.memoizedState=zi,l}return i=e.child,e=i.sibling,l=Xt(i,{mode:"visible",children:l.children}),!(n.mode&1)&&(l.lanes=r),l.return=n,l.sibling=null,e!==null&&(r=n.deletions,r===null?(n.deletions=[e],n.flags|=16):r.push(e)),n.child=l,n.memoizedState=null,l}function _a(e,n){return n=ds({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function ul(e,n,r,l){return l!==null&&ja(l),Qn(n,e.child,null,r),e=_a(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function fp(e,n,r,l,s,i,a){if(r)return n.flags&256?(n.flags&=-257,l=Hs(Error(L(422))),ul(e,n,a,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(i=l.fallback,s=n.mode,l=ds({mode:"visible",children:l.children},s,0,null),i=dn(i,s,a,null),i.flags|=2,l.return=n,i.return=n,l.sibling=i,n.child=l,n.mode&1&&Qn(n,e.child,null,a),n.child.memoizedState=Li(a),n.memoizedState=zi,i);if(!(n.mode&1))return ul(e,n,a,null);if(s.data==="$!"){if(l=s.nextSibling&&s.nextSibling.dataset,l)var o=l.dgst;return l=o,i=Error(L(419)),l=Hs(i,l,void 0),ul(e,n,a,l)}if(o=(a&e.childLanes)!==0,We||o){if(l=Ee,l!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(l.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Tt(e,s),ut(l,e,s,-1))}return $a(),l=Hs(Error(L(421))),ul(e,n,a,l)}return s.data==="$?"?(n.flags|=128,n.child=e.child,n=Cp.bind(null,e),s._reactRetry=n,null):(e=i.treeContext,Ke=Wt(s.nextSibling),Ye=n,pe=!0,ct=null,e!==null&&(et[tt++]=bt,et[tt++]=wt,et[tt++]=hn,bt=e.id,wt=e.overflow,hn=n),n=_a(n,l.children),n.flags|=4096,n)}function Xo(e,n,r){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),Ri(e.return,n,r)}function Vs(e,n,r,l,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:r,tailMode:s}:(i.isBackwards=n,i.rendering=null,i.renderingStartTime=0,i.last=l,i.tail=r,i.tailMode=s)}function yu(e,n,r){var l=n.pendingProps,s=l.revealOrder,i=l.tail;if(Be(e,n,l.children,r),l=me.current,l&2)l=l&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xo(e,r,n);else if(e.tag===19)Xo(e,r,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(oe(me,l),!(n.mode&1))n.memoizedState=null;else switch(s){case"forwards":for(r=n.child,s=null;r!==null;)e=r.alternate,e!==null&&Wl(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=n.child,n.child=null):(s=r.sibling,r.sibling=null),Vs(n,!1,s,r,i);break;case"backwards":for(r=null,s=n.child,n.child=null;s!==null;){if(e=s.alternate,e!==null&&Wl(e)===null){n.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Vs(n,!0,r,null,i);break;case"together":Vs(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function wl(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Rt(e,n,r){if(e!==null&&(n.dependencies=e.dependencies),pn|=n.lanes,!(r&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(L(153));if(n.child!==null){for(e=n.child,r=Xt(e,e.pendingProps),n.child=r,r.return=n;e.sibling!==null;)e=e.sibling,r=r.sibling=Xt(e,e.pendingProps),r.return=n;r.sibling=null}return n.child}function pp(e,n,r){switch(n.tag){case 3:xu(n),Vn();break;case 5:Hd(n);break;case 1:Ve(n.type)&&Al(n);break;case 4:Ca(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,s=n.memoizedProps.value;oe($l,l._currentValue),l._currentValue=s;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(oe(me,me.current&1),n.flags|=128,null):r&n.child.childLanes?gu(e,n,r):(oe(me,me.current&1),e=Rt(e,n,r),e!==null?e.sibling:null);oe(me,me.current&1);break;case 19:if(l=(r&n.childLanes)!==0,e.flags&128){if(l)return yu(e,n,r);n.flags|=128}if(s=n.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),oe(me,me.current),l)break;return null;case 22:case 23:return n.lanes=0,pu(e,n,r)}return Rt(e,n,r)}var vu,Ai,ju,Su;vu=function(e,n){for(var r=n.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ai=function(){};ju=function(e,n,r,l){var s=e.memoizedProps;if(s!==l){e=n.stateNode,on(gt.current);var i=null;switch(r){case"input":s=si(e,s),l=si(e,l),i=[];break;case"select":s=ge({},s,{value:void 0}),l=ge({},l,{value:void 0}),i=[];break;case"textarea":s=oi(e,s),l=oi(e,l),i=[];break;default:typeof s.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=zl)}di(r,l);var a;r=null;for(d in s)if(!l.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var o=s[d];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Nr.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in l){var c=l[d];if(o=s!=null?s[d]:void 0,l.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Nr.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ue("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(n.updateQueue=d)&&(n.flags|=4)}};Su=function(e,n,r,l){r!==l&&(n.flags|=4)};function dr(e,n){if(!pe)switch(e.tailMode){case"hidden":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ze(e){var n=e.alternate!==null&&e.alternate.child===e.child,r=0,l=0;if(n)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,l|=s.subtreeFlags&14680064,l|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,l|=s.subtreeFlags,l|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=l,e.childLanes=r,n}function mp(e,n,r){var l=n.pendingProps;switch(va(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ze(n),null;case 1:return Ve(n.type)&&Ll(),ze(n),null;case 3:return l=n.stateNode,Xn(),he(He),he(Ae),Ta(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(cl(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,ct!==null&&(Vi(ct),ct=null))),Ai(e,n),ze(n),null;case 5:Ea(n);var s=on(Ar.current);if(r=n.type,e!==null&&n.stateNode!=null)ju(e,n,r,l,s),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(L(166));return ze(n),null}if(e=on(gt.current),cl(n)){l=n.stateNode,r=n.type;var i=n.memoizedProps;switch(l[mt]=n,l[zr]=i,e=(n.mode&1)!==0,r){case"dialog":ue("cancel",l),ue("close",l);break;case"iframe":case"object":case"embed":ue("load",l);break;case"video":case"audio":for(s=0;s<mr.length;s++)ue(mr[s],l);break;case"source":ue("error",l);break;case"img":case"image":case"link":ue("error",l),ue("load",l);break;case"details":ue("toggle",l);break;case"input":to(l,i),ue("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!i.multiple},ue("invalid",l);break;case"textarea":ro(l,i),ue("invalid",l)}di(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?l.textContent!==o&&(i.suppressHydrationWarning!==!0&&ol(l.textContent,o,e),s=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&ol(l.textContent,o,e),s=["children",""+o]):Nr.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ue("scroll",l)}switch(r){case"input":el(l),no(l,i,!0);break;case"textarea":el(l),lo(l);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(l.onclick=zl)}l=s,n.updateQueue=l,l!==null&&(n.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Yc(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=a.createElement(r,{is:l.is}):(e=a.createElement(r),r==="select"&&(a=e,l.multiple?a.multiple=!0:l.size&&(a.size=l.size))):e=a.createElementNS(e,r),e[mt]=n,e[zr]=l,vu(e,n,!1,!1),n.stateNode=e;e:{switch(a=ui(r,l),r){case"dialog":ue("cancel",e),ue("close",e),s=l;break;case"iframe":case"object":case"embed":ue("load",e),s=l;break;case"video":case"audio":for(s=0;s<mr.length;s++)ue(mr[s],e);s=l;break;case"source":ue("error",e),s=l;break;case"img":case"image":case"link":ue("error",e),ue("load",e),s=l;break;case"details":ue("toggle",e),s=l;break;case"input":to(e,l),s=si(e,l),ue("invalid",e);break;case"option":s=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},s=ge({},l,{value:void 0}),ue("invalid",e);break;case"textarea":ro(e,l),s=oi(e,l),ue("invalid",e);break;default:s=l}di(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?Jc(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&qc(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Cr(e,c):typeof c=="number"&&Cr(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Nr.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ue("scroll",e):c!=null&&la(e,i,c,a))}switch(r){case"input":el(e),no(e,l,!1);break;case"textarea":el(e),lo(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Yt(l.value));break;case"select":e.multiple=!!l.multiple,i=l.value,i!=null?An(e,!!l.multiple,i,!1):l.defaultValue!=null&&An(e,!!l.multiple,l.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=zl)}switch(r){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return ze(n),null;case 6:if(e&&n.stateNode!=null)Su(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(L(166));if(r=on(Ar.current),on(gt.current),cl(n)){if(l=n.stateNode,r=n.memoizedProps,l[mt]=n,(i=l.nodeValue!==r)&&(e=Ye,e!==null))switch(e.tag){case 3:ol(l.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ol(l.nodeValue,r,(e.mode&1)!==0)}i&&(n.flags|=4)}else l=(r.nodeType===9?r:r.ownerDocument).createTextNode(l),l[mt]=n,n.stateNode=l}return ze(n),null;case 13:if(he(me),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pe&&Ke!==null&&n.mode&1&&!(n.flags&128))Od(),Vn(),n.flags|=98560,i=!1;else if(i=cl(n),l!==null&&l.dehydrated!==null){if(e===null){if(!i)throw Error(L(318));if(i=n.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(L(317));i[mt]=n}else Vn(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;ze(n),i=!1}else ct!==null&&(Vi(ct),ct=null),i=!0;if(!i)return n.flags&65536?n:null}return n.flags&128?(n.lanes=r,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,n.mode&1&&(e===null||me.current&1?Ne===0&&(Ne=3):$a())),n.updateQueue!==null&&(n.flags|=4),ze(n),null);case 4:return Xn(),Ai(e,n),e===null&&Fr(n.stateNode.containerInfo),ze(n),null;case 10:return wa(n.type._context),ze(n),null;case 17:return Ve(n.type)&&Ll(),ze(n),null;case 19:if(he(me),i=n.memoizedState,i===null)return ze(n),null;if(l=(n.flags&128)!==0,a=i.rendering,a===null)if(l)dr(i,!1);else{if(Ne!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(a=Wl(e),a!==null){for(n.flags|=128,dr(i,!1),l=a.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=r,r=n.child;r!==null;)i=r,e=l,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return oe(me,me.current&1|2),n.child}e=e.sibling}i.tail!==null&&be()>Yn&&(n.flags|=128,l=!0,dr(i,!1),n.lanes=4194304)}else{if(!l)if(e=Wl(a),e!==null){if(n.flags|=128,l=!0,r=e.updateQueue,r!==null&&(n.updateQueue=r,n.flags|=4),dr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!pe)return ze(n),null}else 2*be()-i.renderingStartTime>Yn&&r!==1073741824&&(n.flags|=128,l=!0,dr(i,!1),n.lanes=4194304);i.isBackwards?(a.sibling=n.child,n.child=a):(r=i.last,r!==null?r.sibling=a:n.child=a,i.last=a)}return i.tail!==null?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.renderingStartTime=be(),n.sibling=null,r=me.current,oe(me,l?r&1|2:r&1),n):(ze(n),null);case 22:case 23:return Oa(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&n.mode&1?Xe&1073741824&&(ze(n),n.subtreeFlags&6&&(n.flags|=8192)):ze(n),null;case 24:return null;case 25:return null}throw Error(L(156,n.tag))}function xp(e,n){switch(va(n),n.tag){case 1:return Ve(n.type)&&Ll(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Xn(),he(He),he(Ae),Ta(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return Ea(n),null;case 13:if(he(me),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(L(340));Vn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return he(me),null;case 4:return Xn(),null;case 10:return wa(n.type._context),null;case 22:case 23:return Oa(),null;case 24:return null;default:return null}}var hl=!1,Le=!1,gp=typeof WeakSet=="function"?WeakSet:Set,M=null;function zn(e,n){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(l){ye(e,n,l)}else r.current=null}function Bi(e,n,r){try{r()}catch(l){ye(e,n,l)}}var Ko=!1;function yp(e,n){if(Si=Il,e=Cd(),ga(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var l=r.getSelection&&r.getSelection();if(l&&l.rangeCount!==0){r=l.anchorNode;var s=l.anchorOffset,i=l.focusNode;l=l.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,d=0,j=0,h=e,f=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||l!==0&&h.nodeType!==3||(c=a+l),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++d===s&&(o=a),f===i&&++j===l&&(c=a),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(bi={focusedElem:e,selectionRange:r},Il=!1,M=n;M!==null;)if(n=M,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,M=e;else for(;M!==null;){n=M;try{var v=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var S=v.memoizedProps,w=v.memoizedState,g=n.stateNode,p=g.getSnapshotBeforeUpdate(n.elementType===n.type?S:at(n.type,S),w);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var u=n.stateNode.containerInfo;u.nodeType===1?u.textContent="":u.nodeType===9&&u.documentElement&&u.removeChild(u.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(y){ye(n,n.return,y)}if(e=n.sibling,e!==null){e.return=n.return,M=e;break}M=n.return}return v=Ko,Ko=!1,v}function br(e,n,r){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var s=l=l.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Bi(n,r,i)}s=s.next}while(s!==l)}}function os(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&e)===e){var l=r.create;r.destroy=l()}r=r.next}while(r!==n)}}function Oi(e){var n=e.ref;if(n!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof n=="function"?n(e):n.current=e}}function bu(e){var n=e.alternate;n!==null&&(e.alternate=null,bu(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[mt],delete n[zr],delete n[Ni],delete n[ep],delete n[tp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function wu(e){return e.tag===5||e.tag===3||e.tag===4}function Yo(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||wu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $i(e,n,r){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?r.nodeType===8?r.parentNode.insertBefore(e,n):r.insertBefore(e,n):(r.nodeType===8?(n=r.parentNode,n.insertBefore(e,r)):(n=r,n.appendChild(e)),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=zl));else if(l!==4&&(e=e.child,e!==null))for($i(e,n,r),e=e.sibling;e!==null;)$i(e,n,r),e=e.sibling}function Mi(e,n,r){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?r.insertBefore(e,n):r.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(Mi(e,n,r),e=e.sibling;e!==null;)Mi(e,n,r),e=e.sibling}var De=null,ot=!1;function It(e,n,r){for(r=r.child;r!==null;)ku(e,n,r),r=r.sibling}function ku(e,n,r){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(es,r)}catch{}switch(r.tag){case 5:Le||zn(r,n);case 6:var l=De,s=ot;De=null,It(e,n,r),De=l,ot=s,De!==null&&(ot?(e=De,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):De.removeChild(r.stateNode));break;case 18:De!==null&&(ot?(e=De,r=r.stateNode,e.nodeType===8?Bs(e.parentNode,r):e.nodeType===1&&Bs(e,r),Pr(e)):Bs(De,r.stateNode));break;case 4:l=De,s=ot,De=r.stateNode.containerInfo,ot=!0,It(e,n,r),De=l,ot=s;break;case 0:case 11:case 14:case 15:if(!Le&&(l=r.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){s=l=l.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Bi(r,n,a),s=s.next}while(s!==l)}It(e,n,r);break;case 1:if(!Le&&(zn(r,n),l=r.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=r.memoizedProps,l.state=r.memoizedState,l.componentWillUnmount()}catch(o){ye(r,n,o)}It(e,n,r);break;case 21:It(e,n,r);break;case 22:r.mode&1?(Le=(l=Le)||r.memoizedState!==null,It(e,n,r),Le=l):It(e,n,r);break;default:It(e,n,r)}}function qo(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new gp),n.forEach(function(l){var s=Ep.bind(null,e,l);r.has(l)||(r.add(l),l.then(s,s))})}}function it(e,n){var r=n.deletions;if(r!==null)for(var l=0;l<r.length;l++){var s=r[l];try{var i=e,a=n,o=a;e:for(;o!==null;){switch(o.tag){case 5:De=o.stateNode,ot=!1;break e;case 3:De=o.stateNode.containerInfo,ot=!0;break e;case 4:De=o.stateNode.containerInfo,ot=!0;break e}o=o.return}if(De===null)throw Error(L(160));ku(i,a,s),De=null,ot=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){ye(s,n,d)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Nu(n,e),n=n.sibling}function Nu(e,n){var r=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(it(n,e),ft(e),l&4){try{br(3,e,e.return),os(3,e)}catch(S){ye(e,e.return,S)}try{br(5,e,e.return)}catch(S){ye(e,e.return,S)}}break;case 1:it(n,e),ft(e),l&512&&r!==null&&zn(r,r.return);break;case 5:if(it(n,e),ft(e),l&512&&r!==null&&zn(r,r.return),e.flags&32){var s=e.stateNode;try{Cr(s,"")}catch(S){ye(e,e.return,S)}}if(l&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Xc(s,i),ui(o,a);var d=ui(o,i);for(a=0;a<c.length;a+=2){var j=c[a],h=c[a+1];j==="style"?Jc(s,h):j==="dangerouslySetInnerHTML"?qc(s,h):j==="children"?Cr(s,h):la(s,j,h,d)}switch(o){case"input":ii(s,i);break;case"textarea":Kc(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?An(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?An(s,!!i.multiple,i.defaultValue,!0):An(s,!!i.multiple,i.multiple?[]:"",!1))}s[zr]=i}catch(S){ye(e,e.return,S)}}break;case 6:if(it(n,e),ft(e),l&4){if(e.stateNode===null)throw Error(L(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(S){ye(e,e.return,S)}}break;case 3:if(it(n,e),ft(e),l&4&&r!==null&&r.memoizedState.isDehydrated)try{Pr(n.containerInfo)}catch(S){ye(e,e.return,S)}break;case 4:it(n,e),ft(e);break;case 13:it(n,e),ft(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Aa=be())),l&4&&qo(e);break;case 22:if(j=r!==null&&r.memoizedState!==null,e.mode&1?(Le=(d=Le)||j,it(n,e),Le=d):it(n,e),ft(e),l&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!j&&e.mode&1)for(M=e,j=e.child;j!==null;){for(h=M=j;M!==null;){switch(f=M,m=f.child,f.tag){case 0:case 11:case 14:case 15:br(4,f,f.return);break;case 1:zn(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){l=f,r=f.return;try{n=l,v.props=n.memoizedProps,v.state=n.memoizedState,v.componentWillUnmount()}catch(S){ye(l,r,S)}}break;case 5:zn(f,f.return);break;case 22:if(f.memoizedState!==null){Jo(h);continue}}m!==null?(m.return=f,M=m):Jo(h)}j=j.sibling}e:for(j=null,h=e;;){if(h.tag===5){if(j===null){j=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Gc("display",a))}catch(S){ye(e,e.return,S)}}}else if(h.tag===6){if(j===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(S){ye(e,e.return,S)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;j===h&&(j=null),h=h.return}j===h&&(j=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:it(n,e),ft(e),l&4&&qo(e);break;case 21:break;default:it(n,e),ft(e)}}function ft(e){var n=e.flags;if(n&2){try{e:{for(var r=e.return;r!==null;){if(wu(r)){var l=r;break e}r=r.return}throw Error(L(160))}switch(l.tag){case 5:var s=l.stateNode;l.flags&32&&(Cr(s,""),l.flags&=-33);var i=Yo(e);Mi(e,i,s);break;case 3:case 4:var a=l.stateNode.containerInfo,o=Yo(e);$i(e,o,a);break;default:throw Error(L(161))}}catch(c){ye(e,e.return,c)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function vp(e,n,r){M=e,Cu(e)}function Cu(e,n,r){for(var l=(e.mode&1)!==0;M!==null;){var s=M,i=s.child;if(s.tag===22&&l){var a=s.memoizedState!==null||hl;if(!a){var o=s.alternate,c=o!==null&&o.memoizedState!==null||Le;o=hl;var d=Le;if(hl=a,(Le=c)&&!d)for(M=s;M!==null;)a=M,c=a.child,a.tag===22&&a.memoizedState!==null?Zo(s):c!==null?(c.return=a,M=c):Zo(s);for(;i!==null;)M=i,Cu(i),i=i.sibling;M=s,hl=o,Le=d}Go(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,M=i):Go(e)}}function Go(e){for(;M!==null;){var n=M;if(n.flags&8772){var r=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Le||os(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!Le)if(r===null)l.componentDidMount();else{var s=n.elementType===n.type?r.memoizedProps:at(n.type,r.memoizedProps);l.componentDidUpdate(s,r.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var i=n.updateQueue;i!==null&&zo(n,i,l);break;case 3:var a=n.updateQueue;if(a!==null){if(r=null,n.child!==null)switch(n.child.tag){case 5:r=n.child.stateNode;break;case 1:r=n.child.stateNode}zo(n,a,r)}break;case 5:var o=n.stateNode;if(r===null&&n.flags&4){r=o;var c=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var d=n.alternate;if(d!==null){var j=d.memoizedState;if(j!==null){var h=j.dehydrated;h!==null&&Pr(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}Le||n.flags&512&&Oi(n)}catch(f){ye(n,n.return,f)}}if(n===e){M=null;break}if(r=n.sibling,r!==null){r.return=n.return,M=r;break}M=n.return}}function Jo(e){for(;M!==null;){var n=M;if(n===e){M=null;break}var r=n.sibling;if(r!==null){r.return=n.return,M=r;break}M=n.return}}function Zo(e){for(;M!==null;){var n=M;try{switch(n.tag){case 0:case 11:case 15:var r=n.return;try{os(4,n)}catch(c){ye(n,r,c)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var s=n.return;try{l.componentDidMount()}catch(c){ye(n,s,c)}}var i=n.return;try{Oi(n)}catch(c){ye(n,i,c)}break;case 5:var a=n.return;try{Oi(n)}catch(c){ye(n,a,c)}}}catch(c){ye(n,n.return,c)}if(n===e){M=null;break}var o=n.sibling;if(o!==null){o.return=n.return,M=o;break}M=n.return}}var jp=Math.ceil,Ql=Pt.ReactCurrentDispatcher,za=Pt.ReactCurrentOwner,rt=Pt.ReactCurrentBatchConfig,le=0,Ee=null,we=null,Ie=0,Xe=0,Ln=Jt(0),Ne=0,Mr=null,pn=0,cs=0,La=0,wr=null,Ue=null,Aa=0,Yn=1/0,jt=null,Xl=!1,Ui=null,Vt=null,fl=!1,Bt=null,Kl=0,kr=0,Wi=null,kl=-1,Nl=0;function Oe(){return le&6?be():kl!==-1?kl:kl=be()}function Qt(e){return e.mode&1?le&2&&Ie!==0?Ie&-Ie:rp.transition!==null?(Nl===0&&(Nl=dd()),Nl):(e=se,e!==0||(e=window.event,e=e===void 0?16:gd(e.type)),e):1}function ut(e,n,r,l){if(50<kr)throw kr=0,Wi=null,Error(L(185));Vr(e,r,l),(!(le&2)||e!==Ee)&&(e===Ee&&(!(le&2)&&(cs|=r),Ne===4&&Lt(e,Ie)),Qe(e,l),r===1&&le===0&&!(n.mode&1)&&(Yn=be()+500,ss&&Zt()))}function Qe(e,n){var r=e.callbackNode;nf(e,n);var l=Dl(e,e===Ee?Ie:0);if(l===0)r!==null&&ao(r),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(r!=null&&ao(r),n===1)e.tag===0?np(ec.bind(null,e)):Ld(ec.bind(null,e)),Jf(function(){!(le&6)&&Zt()}),r=null;else{switch(ud(l)){case 1:r=ca;break;case 4:r=od;break;case 16:r=Pl;break;case 536870912:r=cd;break;default:r=Pl}r=_u(r,Eu.bind(null,e))}e.callbackPriority=n,e.callbackNode=r}}function Eu(e,n){if(kl=-1,Nl=0,le&6)throw Error(L(327));var r=e.callbackNode;if(Un()&&e.callbackNode!==r)return null;var l=Dl(e,e===Ee?Ie:0);if(l===0)return null;if(l&30||l&e.expiredLanes||n)n=Yl(e,l);else{n=l;var s=le;le|=2;var i=Ru();(Ee!==e||Ie!==n)&&(jt=null,Yn=be()+500,cn(e,n));do try{wp();break}catch(o){Tu(e,o)}while(!0);ba(),Ql.current=i,le=s,we!==null?n=0:(Ee=null,Ie=0,n=Ne)}if(n!==0){if(n===2&&(s=xi(e),s!==0&&(l=s,n=Hi(e,s))),n===1)throw r=Mr,cn(e,0),Lt(e,l),Qe(e,be()),r;if(n===6)Lt(e,l);else{if(s=e.current.alternate,!(l&30)&&!Sp(s)&&(n=Yl(e,l),n===2&&(i=xi(e),i!==0&&(l=i,n=Hi(e,i))),n===1))throw r=Mr,cn(e,0),Lt(e,l),Qe(e,be()),r;switch(e.finishedWork=s,e.finishedLanes=l,n){case 0:case 1:throw Error(L(345));case 2:ln(e,Ue,jt);break;case 3:if(Lt(e,l),(l&130023424)===l&&(n=Aa+500-be(),10<n)){if(Dl(e,0)!==0)break;if(s=e.suspendedLanes,(s&l)!==l){Oe(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ki(ln.bind(null,e,Ue,jt),n);break}ln(e,Ue,jt);break;case 4:if(Lt(e,l),(l&4194240)===l)break;for(n=e.eventTimes,s=-1;0<l;){var a=31-dt(l);i=1<<a,a=n[a],a>s&&(s=a),l&=~i}if(l=s,l=be()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*jp(l/1960))-l,10<l){e.timeoutHandle=ki(ln.bind(null,e,Ue,jt),l);break}ln(e,Ue,jt);break;case 5:ln(e,Ue,jt);break;default:throw Error(L(329))}}}return Qe(e,be()),e.callbackNode===r?Eu.bind(null,e):null}function Hi(e,n){var r=wr;return e.current.memoizedState.isDehydrated&&(cn(e,n).flags|=256),e=Yl(e,n),e!==2&&(n=Ue,Ue=r,n!==null&&Vi(n)),e}function Vi(e){Ue===null?Ue=e:Ue.push.apply(Ue,e)}function Sp(e){for(var n=e;;){if(n.flags&16384){var r=n.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var l=0;l<r.length;l++){var s=r[l],i=s.getSnapshot;s=s.value;try{if(!ht(i(),s))return!1}catch{return!1}}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Lt(e,n){for(n&=~La,n&=~cs,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var r=31-dt(n),l=1<<r;e[r]=-1,n&=~l}}function ec(e){if(le&6)throw Error(L(327));Un();var n=Dl(e,0);if(!(n&1))return Qe(e,be()),null;var r=Yl(e,n);if(e.tag!==0&&r===2){var l=xi(e);l!==0&&(n=l,r=Hi(e,l))}if(r===1)throw r=Mr,cn(e,0),Lt(e,n),Qe(e,be()),r;if(r===6)throw Error(L(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,ln(e,Ue,jt),Qe(e,be()),null}function Ba(e,n){var r=le;le|=1;try{return e(n)}finally{le=r,le===0&&(Yn=be()+500,ss&&Zt())}}function mn(e){Bt!==null&&Bt.tag===0&&!(le&6)&&Un();var n=le;le|=1;var r=rt.transition,l=se;try{if(rt.transition=null,se=1,e)return e()}finally{se=l,rt.transition=r,le=n,!(le&6)&&Zt()}}function Oa(){Xe=Ln.current,he(Ln)}function cn(e,n){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Gf(r)),we!==null)for(r=we.return;r!==null;){var l=r;switch(va(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&Ll();break;case 3:Xn(),he(He),he(Ae),Ta();break;case 5:Ea(l);break;case 4:Xn();break;case 13:he(me);break;case 19:he(me);break;case 10:wa(l.type._context);break;case 22:case 23:Oa()}r=r.return}if(Ee=e,we=e=Xt(e.current,null),Ie=Xe=n,Ne=0,Mr=null,La=cs=pn=0,Ue=wr=null,an!==null){for(n=0;n<an.length;n++)if(r=an[n],l=r.interleaved,l!==null){r.interleaved=null;var s=l.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,l.next=a}r.pending=l}an=null}return e}function Tu(e,n){do{var r=we;try{if(ba(),Sl.current=Vl,Hl){for(var l=xe.memoizedState;l!==null;){var s=l.queue;s!==null&&(s.pending=null),l=l.next}Hl=!1}if(fn=0,Ce=ke=xe=null,Sr=!1,Br=0,za.current=null,r===null||r.return===null){Ne=1,Mr=n,we=null;break}e:{var i=e,a=r.return,o=r,c=n;if(n=Ie,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,j=o,h=j.tag;if(!(j.mode&1)&&(h===0||h===11||h===15)){var f=j.alternate;f?(j.updateQueue=f.updateQueue,j.memoizedState=f.memoizedState,j.lanes=f.lanes):(j.updateQueue=null,j.memoizedState=null)}var m=Mo(a);if(m!==null){m.flags&=-257,Uo(m,a,o,i,n),m.mode&1&&$o(i,d,n),n=m,c=d;var v=n.updateQueue;if(v===null){var S=new Set;S.add(c),n.updateQueue=S}else v.add(c);break e}else{if(!(n&1)){$o(i,d,n),$a();break e}c=Error(L(426))}}else if(pe&&o.mode&1){var w=Mo(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Uo(w,a,o,i,n),ja(Kn(c,o));break e}}i=c=Kn(c,o),Ne!==4&&(Ne=2),wr===null?wr=[i]:wr.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,n&=-n,i.lanes|=n;var g=uu(i,c,n);_o(i,g);break e;case 1:o=c;var p=i.type,u=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&(Vt===null||!Vt.has(u)))){i.flags|=65536,n&=-n,i.lanes|=n;var y=hu(i,o,n);_o(i,y);break e}}i=i.return}while(i!==null)}Du(r)}catch(E){n=E,we===r&&r!==null&&(we=r=r.return);continue}break}while(!0)}function Ru(){var e=Ql.current;return Ql.current=Vl,e===null?Vl:e}function $a(){(Ne===0||Ne===3||Ne===2)&&(Ne=4),Ee===null||!(pn&268435455)&&!(cs&268435455)||Lt(Ee,Ie)}function Yl(e,n){var r=le;le|=2;var l=Ru();(Ee!==e||Ie!==n)&&(jt=null,cn(e,n));do try{bp();break}catch(s){Tu(e,s)}while(!0);if(ba(),le=r,Ql.current=l,we!==null)throw Error(L(261));return Ee=null,Ie=0,Ne}function bp(){for(;we!==null;)Pu(we)}function wp(){for(;we!==null&&!Xh();)Pu(we)}function Pu(e){var n=Fu(e.alternate,e,Xe);e.memoizedProps=e.pendingProps,n===null?Du(e):we=n,za.current=null}function Du(e){var n=e;do{var r=n.alternate;if(e=n.return,n.flags&32768){if(r=xp(r,n),r!==null){r.flags&=32767,we=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ne=6,we=null;return}}else if(r=mp(r,n,Xe),r!==null){we=r;return}if(n=n.sibling,n!==null){we=n;return}we=n=e}while(n!==null);Ne===0&&(Ne=5)}function ln(e,n,r){var l=se,s=rt.transition;try{rt.transition=null,se=1,kp(e,n,r,l)}finally{rt.transition=s,se=l}return null}function kp(e,n,r,l){do Un();while(Bt!==null);if(le&6)throw Error(L(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(L(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(rf(e,i),e===Ee&&(we=Ee=null,Ie=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||fl||(fl=!0,_u(Pl,function(){return Un(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=rt.transition,rt.transition=null;var a=se;se=1;var o=le;le|=4,za.current=null,yp(e,r),Nu(r,e),Hf(bi),Il=!!Si,bi=Si=null,e.current=r,vp(r),Kh(),le=o,se=a,rt.transition=i}else e.current=r;if(fl&&(fl=!1,Bt=e,Kl=s),i=e.pendingLanes,i===0&&(Vt=null),Gh(r.stateNode),Qe(e,be()),n!==null)for(l=e.onRecoverableError,r=0;r<n.length;r++)s=n[r],l(s.value,{componentStack:s.stack,digest:s.digest});if(Xl)throw Xl=!1,e=Ui,Ui=null,e;return Kl&1&&e.tag!==0&&Un(),i=e.pendingLanes,i&1?e===Wi?kr++:(kr=0,Wi=e):kr=0,Zt(),null}function Un(){if(Bt!==null){var e=ud(Kl),n=rt.transition,r=se;try{if(rt.transition=null,se=16>e?16:e,Bt===null)var l=!1;else{if(e=Bt,Bt=null,Kl=0,le&6)throw Error(L(331));var s=le;for(le|=4,M=e.current;M!==null;){var i=M,a=i.child;if(M.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(M=d;M!==null;){var j=M;switch(j.tag){case 0:case 11:case 15:br(8,j,i)}var h=j.child;if(h!==null)h.return=j,M=h;else for(;M!==null;){j=M;var f=j.sibling,m=j.return;if(bu(j),j===d){M=null;break}if(f!==null){f.return=m,M=f;break}M=m}}}var v=i.alternate;if(v!==null){var S=v.child;if(S!==null){v.child=null;do{var w=S.sibling;S.sibling=null,S=w}while(S!==null)}}M=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,M=a;else e:for(;M!==null;){if(i=M,i.flags&2048)switch(i.tag){case 0:case 11:case 15:br(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,M=g;break e}M=i.return}}var p=e.current;for(M=p;M!==null;){a=M;var u=a.child;if(a.subtreeFlags&2064&&u!==null)u.return=a,M=u;else e:for(a=p;M!==null;){if(o=M,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:os(9,o)}}catch(E){ye(o,o.return,E)}if(o===a){M=null;break e}var y=o.sibling;if(y!==null){y.return=o.return,M=y;break e}M=o.return}}if(le=s,Zt(),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(es,e)}catch{}l=!0}return l}finally{se=r,rt.transition=n}}return!1}function tc(e,n,r){n=Kn(r,n),n=uu(e,n,1),e=Ht(e,n,1),n=Oe(),e!==null&&(Vr(e,1,n),Qe(e,n))}function ye(e,n,r){if(e.tag===3)tc(e,e,r);else for(;n!==null;){if(n.tag===3){tc(n,e,r);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Vt===null||!Vt.has(l))){e=Kn(r,e),e=hu(n,e,1),n=Ht(n,e,1),e=Oe(),n!==null&&(Vr(n,1,e),Qe(n,e));break}}n=n.return}}function Np(e,n,r){var l=e.pingCache;l!==null&&l.delete(n),n=Oe(),e.pingedLanes|=e.suspendedLanes&r,Ee===e&&(Ie&r)===r&&(Ne===4||Ne===3&&(Ie&130023424)===Ie&&500>be()-Aa?cn(e,0):La|=r),Qe(e,n)}function Iu(e,n){n===0&&(e.mode&1?(n=rl,rl<<=1,!(rl&130023424)&&(rl=4194304)):n=1);var r=Oe();e=Tt(e,n),e!==null&&(Vr(e,n,r),Qe(e,r))}function Cp(e){var n=e.memoizedState,r=0;n!==null&&(r=n.retryLane),Iu(e,r)}function Ep(e,n){var r=0;switch(e.tag){case 13:var l=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(L(314))}l!==null&&l.delete(n),Iu(e,r)}var Fu;Fu=function(e,n,r){if(e!==null)if(e.memoizedProps!==n.pendingProps||He.current)We=!0;else{if(!(e.lanes&r)&&!(n.flags&128))return We=!1,pp(e,n,r);We=!!(e.flags&131072)}else We=!1,pe&&n.flags&1048576&&Ad(n,Ol,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;wl(e,n),e=n.pendingProps;var s=Hn(n,Ae.current);Mn(n,r),s=Pa(null,n,l,e,s,r);var i=Da();return n.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Ve(l)?(i=!0,Al(n)):i=!1,n.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Na(n),s.updater=as,n.stateNode=s,s._reactInternals=n,Di(n,l,e,r),n=_i(null,n,l,!0,i,r)):(n.tag=0,pe&&i&&ya(n),Be(null,n,s,r),n=n.child),n;case 16:l=n.elementType;e:{switch(wl(e,n),e=n.pendingProps,s=l._init,l=s(l._payload),n.type=l,s=n.tag=Rp(l),e=at(l,e),s){case 0:n=Fi(null,n,l,e,r);break e;case 1:n=Vo(null,n,l,e,r);break e;case 11:n=Wo(null,n,l,e,r);break e;case 14:n=Ho(null,n,l,at(l.type,e),r);break e}throw Error(L(306,l,""))}return n;case 0:return l=n.type,s=n.pendingProps,s=n.elementType===l?s:at(l,s),Fi(e,n,l,s,r);case 1:return l=n.type,s=n.pendingProps,s=n.elementType===l?s:at(l,s),Vo(e,n,l,s,r);case 3:e:{if(xu(n),e===null)throw Error(L(387));l=n.pendingProps,i=n.memoizedState,s=i.element,Wd(e,n),Ul(n,l,null,r);var a=n.memoizedState;if(l=a.element,i.isDehydrated)if(i={element:l,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},n.updateQueue.baseState=i,n.memoizedState=i,n.flags&256){s=Kn(Error(L(423)),n),n=Qo(e,n,l,r,s);break e}else if(l!==s){s=Kn(Error(L(424)),n),n=Qo(e,n,l,r,s);break e}else for(Ke=Wt(n.stateNode.containerInfo.firstChild),Ye=n,pe=!0,ct=null,r=Md(n,null,l,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Vn(),l===s){n=Rt(e,n,r);break e}Be(e,n,l,r)}n=n.child}return n;case 5:return Hd(n),e===null&&Ti(n),l=n.type,s=n.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,wi(l,s)?a=null:i!==null&&wi(l,i)&&(n.flags|=32),mu(e,n),Be(e,n,a,r),n.child;case 6:return e===null&&Ti(n),null;case 13:return gu(e,n,r);case 4:return Ca(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Qn(n,null,l,r):Be(e,n,l,r),n.child;case 11:return l=n.type,s=n.pendingProps,s=n.elementType===l?s:at(l,s),Wo(e,n,l,s,r);case 7:return Be(e,n,n.pendingProps,r),n.child;case 8:return Be(e,n,n.pendingProps.children,r),n.child;case 12:return Be(e,n,n.pendingProps.children,r),n.child;case 10:e:{if(l=n.type._context,s=n.pendingProps,i=n.memoizedProps,a=s.value,oe($l,l._currentValue),l._currentValue=a,i!==null)if(ht(i.value,a)){if(i.children===s.children&&!He.current){n=Rt(e,n,r);break e}}else for(i=n.child,i!==null&&(i.return=n);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var c=o.firstContext;c!==null;){if(c.context===l){if(i.tag===1){c=kt(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var j=d.pending;j===null?c.next=c:(c.next=j.next,j.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ri(i.return,r,n),o.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===n.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(L(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ri(a,r,n),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===n){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Be(e,n,s.children,r),n=n.child}return n;case 9:return s=n.type,l=n.pendingProps.children,Mn(n,r),s=lt(s),l=l(s),n.flags|=1,Be(e,n,l,r),n.child;case 14:return l=n.type,s=at(l,n.pendingProps),s=at(l.type,s),Ho(e,n,l,s,r);case 15:return fu(e,n,n.type,n.pendingProps,r);case 17:return l=n.type,s=n.pendingProps,s=n.elementType===l?s:at(l,s),wl(e,n),n.tag=1,Ve(l)?(e=!0,Al(n)):e=!1,Mn(n,r),du(n,l,s),Di(n,l,s,r),_i(null,n,l,!0,e,r);case 19:return yu(e,n,r);case 22:return pu(e,n,r)}throw Error(L(156,n.tag))};function _u(e,n){return ad(e,n)}function Tp(e,n,r,l){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nt(e,n,r,l){return new Tp(e,n,r,l)}function Ma(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Rp(e){if(typeof e=="function")return Ma(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ia)return 11;if(e===aa)return 14}return 2}function Xt(e,n){var r=e.alternate;return r===null?(r=nt(e.tag,n,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Cl(e,n,r,l,s,i){var a=2;if(l=e,typeof e=="function")Ma(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Cn:return dn(r.children,s,i,n);case sa:a=8,s|=8;break;case ti:return e=nt(12,r,n,s|2),e.elementType=ti,e.lanes=i,e;case ni:return e=nt(13,r,n,s),e.elementType=ni,e.lanes=i,e;case ri:return e=nt(19,r,n,s),e.elementType=ri,e.lanes=i,e;case Hc:return ds(r,s,i,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Uc:a=10;break e;case Wc:a=9;break e;case ia:a=11;break e;case aa:a=14;break e;case Ft:a=16,l=null;break e}throw Error(L(130,e==null?e:typeof e,""))}return n=nt(a,r,n,s),n.elementType=e,n.type=l,n.lanes=i,n}function dn(e,n,r,l){return e=nt(7,e,l,n),e.lanes=r,e}function ds(e,n,r,l){return e=nt(22,e,l,n),e.elementType=Hc,e.lanes=r,e.stateNode={isHidden:!1},e}function Qs(e,n,r){return e=nt(6,e,null,n),e.lanes=r,e}function Xs(e,n,r){return n=nt(4,e.children!==null?e.children:[],e.key,n),n.lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Pp(e,n,r,l,s){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Es(0),this.expirationTimes=Es(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Es(0),this.identifierPrefix=l,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ua(e,n,r,l,s,i,a,o,c){return e=new Pp(e,n,r,o,c),n===1?(n=1,i===!0&&(n|=8)):n=0,i=nt(3,null,null,n),e.current=i,i.stateNode=e,i.memoizedState={element:l,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Na(i),e}function Dp(e,n,r){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nn,key:l==null?null:""+l,children:e,containerInfo:n,implementation:r}}function zu(e){if(!e)return qt;e=e._reactInternals;e:{if(yn(e)!==e||e.tag!==1)throw Error(L(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Ve(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(L(171))}if(e.tag===1){var r=e.type;if(Ve(r))return zd(e,r,n)}return n}function Lu(e,n,r,l,s,i,a,o,c){return e=Ua(r,l,!0,e,s,i,a,o,c),e.context=zu(null),r=e.current,l=Oe(),s=Qt(r),i=kt(l,s),i.callback=n??null,Ht(r,i,s),e.current.lanes=s,Vr(e,s,l),Qe(e,l),e}function us(e,n,r,l){var s=n.current,i=Oe(),a=Qt(s);return r=zu(r),n.context===null?n.context=r:n.pendingContext=r,n=kt(i,a),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Ht(s,n,a),e!==null&&(ut(e,s,a,i),jl(e,s,a)),a}function ql(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function nc(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<n?r:n}}function Wa(e,n){nc(e,n),(e=e.alternate)&&nc(e,n)}function Ip(){return null}var Au=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ha(e){this._internalRoot=e}hs.prototype.render=Ha.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(L(409));us(e,n,null,null)};hs.prototype.unmount=Ha.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;mn(function(){us(null,e,null,null)}),n[Et]=null}};function hs(e){this._internalRoot=e}hs.prototype.unstable_scheduleHydration=function(e){if(e){var n=pd();e={blockedOn:null,target:e,priority:n};for(var r=0;r<zt.length&&n!==0&&n<zt[r].priority;r++);zt.splice(r,0,e),r===0&&xd(e)}};function Va(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rc(){}function Fp(e,n,r,l,s){if(s){if(typeof l=="function"){var i=l;l=function(){var d=ql(a);i.call(d)}}var a=Lu(n,l,e,0,null,!1,!1,"",rc);return e._reactRootContainer=a,e[Et]=a.current,Fr(e.nodeType===8?e.parentNode:e),mn(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof l=="function"){var o=l;l=function(){var d=ql(c);o.call(d)}}var c=Ua(e,0,!1,null,null,!1,!1,"",rc);return e._reactRootContainer=c,e[Et]=c.current,Fr(e.nodeType===8?e.parentNode:e),mn(function(){us(n,c,r,l)}),c}function ps(e,n,r,l,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var c=ql(a);o.call(c)}}us(n,a,e,s)}else a=Fp(r,n,e,s,l);return ql(a)}hd=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var r=pr(n.pendingLanes);r!==0&&(da(n,r|1),Qe(n,be()),!(le&6)&&(Yn=be()+500,Zt()))}break;case 13:mn(function(){var l=Tt(e,1);if(l!==null){var s=Oe();ut(l,e,1,s)}}),Wa(e,1)}};ua=function(e){if(e.tag===13){var n=Tt(e,134217728);if(n!==null){var r=Oe();ut(n,e,134217728,r)}Wa(e,134217728)}};fd=function(e){if(e.tag===13){var n=Qt(e),r=Tt(e,n);if(r!==null){var l=Oe();ut(r,e,n,l)}Wa(e,n)}};pd=function(){return se};md=function(e,n){var r=se;try{return se=e,n()}finally{se=r}};fi=function(e,n,r){switch(n){case"input":if(ii(e,r),n=r.name,r.type==="radio"&&n!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<r.length;n++){var l=r[n];if(l!==e&&l.form===e.form){var s=ls(l);if(!s)throw Error(L(90));Qc(l),ii(l,s)}}}break;case"textarea":Kc(e,r);break;case"select":n=r.value,n!=null&&An(e,!!r.multiple,n,!1)}};td=Ba;nd=mn;var _p={usingClientEntryPoint:!1,Events:[Xr,Pn,ls,Zc,ed,Ba]},ur={findFiberByHostInstance:sn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zp={bundleType:ur.bundleType,version:ur.version,rendererPackageName:ur.rendererPackageName,rendererConfig:ur.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sd(e),e===null?null:e.stateNode},findFiberByHostInstance:ur.findFiberByHostInstance||Ip,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pl.isDisabled&&pl.supportsFiber)try{es=pl.inject(zp),xt=pl}catch{}}Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_p;Ge.createPortal=function(e,n){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Va(n))throw Error(L(200));return Dp(e,n,null,r)};Ge.createRoot=function(e,n){if(!Va(e))throw Error(L(299));var r=!1,l="",s=Au;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),n=Ua(e,1,!1,null,null,r,!1,l,s),e[Et]=n.current,Fr(e.nodeType===8?e.parentNode:e),new Ha(n)};Ge.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(L(188)):(e=Object.keys(e).join(","),Error(L(268,e)));return e=sd(n),e=e===null?null:e.stateNode,e};Ge.flushSync=function(e){return mn(e)};Ge.hydrate=function(e,n,r){if(!fs(n))throw Error(L(200));return ps(null,e,n,!0,r)};Ge.hydrateRoot=function(e,n,r){if(!Va(e))throw Error(L(405));var l=r!=null&&r.hydratedSources||null,s=!1,i="",a=Au;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),n=Lu(n,null,e,1,r??null,s,!1,i,a),e[Et]=n.current,Fr(e),l)for(e=0;e<l.length;e++)r=l[e],s=r._getVersion,s=s(r._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[r,s]:n.mutableSourceEagerHydrationData.push(r,s);return new hs(n)};Ge.render=function(e,n,r){if(!fs(n))throw Error(L(200));return ps(null,e,n,!1,r)};Ge.unmountComponentAtNode=function(e){if(!fs(e))throw Error(L(40));return e._reactRootContainer?(mn(function(){ps(null,null,e,!1,function(){e._reactRootContainer=null,e[Et]=null})}),!0):!1};Ge.unstable_batchedUpdates=Ba;Ge.unstable_renderSubtreeIntoContainer=function(e,n,r,l){if(!fs(r))throw Error(L(200));if(e==null||e._reactInternals===void 0)throw Error(L(38));return ps(e,n,r,!1,l)};Ge.version="18.3.1-next-f1338f8080-20240426";function Bu(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bu)}catch(e){console.error(e)}}Bu(),Bc.exports=Ge;var Lp=Bc.exports,lc=Lp;Zs.createRoot=lc.createRoot,Zs.hydrateRoot=lc.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ur(){return Ur=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Ur.apply(this,arguments)}var Ot;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ot||(Ot={}));const sc="popstate";function Ap(e){e===void 0&&(e={});function n(l,s){let{pathname:i,search:a,hash:o}=l.location;return Qi("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(l,s){return typeof s=="string"?s:Gl(s)}return Op(n,r,null,e)}function je(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function Qa(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function Bp(){return Math.random().toString(36).substr(2,8)}function ic(e,n){return{usr:e.state,key:e.key,idx:n}}function Qi(e,n,r,l){return r===void 0&&(r=null),Ur({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?tr(n):n,{state:r,key:n&&n.key||l||Bp()})}function Gl(e){let{pathname:n="/",search:r="",hash:l=""}=e;return r&&r!=="?"&&(n+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(n+=l.charAt(0)==="#"?l:"#"+l),n}function tr(e){let n={};if(e){let r=e.indexOf("#");r>=0&&(n.hash=e.substr(r),e=e.substr(0,r));let l=e.indexOf("?");l>=0&&(n.search=e.substr(l),e=e.substr(0,l)),e&&(n.pathname=e)}return n}function Op(e,n,r,l){l===void 0&&(l={});let{window:s=document.defaultView,v5Compat:i=!1}=l,a=s.history,o=Ot.Pop,c=null,d=j();d==null&&(d=0,a.replaceState(Ur({},a.state,{idx:d}),""));function j(){return(a.state||{idx:null}).idx}function h(){o=Ot.Pop;let w=j(),g=w==null?null:w-d;d=w,c&&c({action:o,location:S.location,delta:g})}function f(w,g){o=Ot.Push;let p=Qi(S.location,w,g);d=j()+1;let u=ic(p,d),y=S.createHref(p);try{a.pushState(u,"",y)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(y)}i&&c&&c({action:o,location:S.location,delta:1})}function m(w,g){o=Ot.Replace;let p=Qi(S.location,w,g);d=j();let u=ic(p,d),y=S.createHref(p);a.replaceState(u,"",y),i&&c&&c({action:o,location:S.location,delta:0})}function v(w){let g=s.location.origin!=="null"?s.location.origin:s.location.href,p=typeof w=="string"?w:Gl(w);return p=p.replace(/ $/,"%20"),je(g,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,g)}let S={get action(){return o},get location(){return e(s,a)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(sc,h),c=w,()=>{s.removeEventListener(sc,h),c=null}},createHref(w){return n(s,w)},createURL:v,encodeLocation(w){let g=v(w);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:m,go(w){return a.go(w)}};return S}var ac;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ac||(ac={}));function $p(e,n,r){return r===void 0&&(r="/"),Mp(e,n,r)}function Mp(e,n,r,l){let s=typeof n=="string"?tr(n):n,i=qn(s.pathname||"/",r);if(i==null)return null;let a=Ou(e);Up(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let d=Zp(i);o=Gp(a[c],d)}return o}function Ou(e,n,r,l){n===void 0&&(n=[]),r===void 0&&(r=[]),l===void 0&&(l="");let s=(i,a,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(je(c.relativePath.startsWith(l),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(l.length));let d=Kt([l,c.relativePath]),j=r.concat(c);i.children&&i.children.length>0&&(je(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Ou(i.children,n,j,d)),!(i.path==null&&!i.index)&&n.push({path:d,score:Yp(d,i.index),routesMeta:j})};return e.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,a);else for(let c of $u(i.path))s(i,a,c)}),n}function $u(e){let n=e.split("/");if(n.length===0)return[];let[r,...l]=n,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(l.length===0)return s?[i,""]:[i];let a=$u(l.join("/")),o=[];return o.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&o.push(...a),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function Up(e){e.sort((n,r)=>n.score!==r.score?r.score-n.score:qp(n.routesMeta.map(l=>l.childrenIndex),r.routesMeta.map(l=>l.childrenIndex)))}const Wp=/^:[\w-]+$/,Hp=3,Vp=2,Qp=1,Xp=10,Kp=-2,oc=e=>e==="*";function Yp(e,n){let r=e.split("/"),l=r.length;return r.some(oc)&&(l+=Kp),n&&(l+=Vp),r.filter(s=>!oc(s)).reduce((s,i)=>s+(Wp.test(i)?Hp:i===""?Qp:Xp),l)}function qp(e,n){return e.length===n.length&&e.slice(0,-1).every((l,s)=>l===n[s])?e[e.length-1]-n[n.length-1]:0}function Gp(e,n,r){let{routesMeta:l}=e,s={},i="/",a=[];for(let o=0;o<l.length;++o){let c=l[o],d=o===l.length-1,j=i==="/"?n:n.slice(i.length)||"/",h=Xi({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},j),f=c.route;if(!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:Kt([i,h.pathname]),pathnameBase:lm(Kt([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Kt([i,h.pathnameBase]))}return a}function Xi(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,l]=Jp(e.path,e.caseSensitive,e.end),s=n.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:l.reduce((d,j,h)=>{let{paramName:f,isOptional:m}=j;if(f==="*"){let S=o[h]||"";a=i.slice(0,i.length-S.length).replace(/(.)\/+$/,"$1")}const v=o[h];return m&&!v?d[f]=void 0:d[f]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:e}}function Jp(e,n,r){n===void 0&&(n=!1),r===void 0&&(r=!0),Qa(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(l.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,n?void 0:"i"),l]}function Zp(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return Qa(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function qn(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let r=n.endsWith("/")?n.length-1:n.length,l=e.charAt(r);return l&&l!=="/"?null:e.slice(r)||"/"}const em=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tm=e=>em.test(e);function nm(e,n){n===void 0&&(n="/");let{pathname:r,search:l="",hash:s=""}=typeof e=="string"?tr(e):e,i;if(r)if(tm(r))i=r;else{if(r.includes("//")){let a=r;r=r.replace(/\/\/+/g,"/"),Qa(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+r))}r.startsWith("/")?i=cc(r.substring(1),"/"):i=cc(r,n)}else i=n;return{pathname:i,search:sm(l),hash:im(s)}}function cc(e,n){let r=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Ks(e,n,r,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function rm(e){return e.filter((n,r)=>r===0||n.route.path&&n.route.path.length>0)}function Mu(e,n){let r=rm(e);return n?r.map((l,s)=>s===r.length-1?l.pathname:l.pathnameBase):r.map(l=>l.pathnameBase)}function Uu(e,n,r,l){l===void 0&&(l=!1);let s;typeof e=="string"?s=tr(e):(s=Ur({},e),je(!s.pathname||!s.pathname.includes("?"),Ks("?","pathname","search",s)),je(!s.pathname||!s.pathname.includes("#"),Ks("#","pathname","hash",s)),je(!s.search||!s.search.includes("#"),Ks("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=r;else{let h=n.length-1;if(!l&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?n[h]:"/"}let c=nm(s,o),d=a&&a!=="/"&&a.endsWith("/"),j=(i||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||j)&&(c.pathname+="/"),c}const Kt=e=>e.join("/").replace(/\/\/+/g,"/"),lm=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sm=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,im=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function am(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Wu=["post","put","patch","delete"];new Set(Wu);const om=["get",...Wu];new Set(om);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wr(){return Wr=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Wr.apply(this,arguments)}const ms=x.createContext(null),Hu=x.createContext(null),en=x.createContext(null),xs=x.createContext(null),vn=x.createContext({outlet:null,matches:[],isDataRoute:!1}),Vu=x.createContext(null);function cm(e,n){let{relative:r}=n===void 0?{}:n;Yr()||je(!1);let{basename:l,navigator:s}=x.useContext(en),{hash:i,pathname:a,search:o}=gs(e,{relative:r}),c=a;return l!=="/"&&(c=a==="/"?l:Kt([l,a])),s.createHref({pathname:c,search:o,hash:i})}function Yr(){return x.useContext(xs)!=null}function jn(){return Yr()||je(!1),x.useContext(xs).location}function Qu(e){x.useContext(en).static||x.useLayoutEffect(e)}function nr(){let{isDataRoute:e}=x.useContext(vn);return e?bm():dm()}function dm(){Yr()||je(!1);let e=x.useContext(ms),{basename:n,future:r,navigator:l}=x.useContext(en),{matches:s}=x.useContext(vn),{pathname:i}=jn(),a=JSON.stringify(Mu(s,r.v7_relativeSplatPath)),o=x.useRef(!1);return Qu(()=>{o.current=!0}),x.useCallback(function(d,j){if(j===void 0&&(j={}),!o.current)return;if(typeof d=="number"){l.go(d);return}let h=Uu(d,JSON.parse(a),i,j.relative==="path");e==null&&n!=="/"&&(h.pathname=h.pathname==="/"?n:Kt([n,h.pathname])),(j.replace?l.replace:l.push)(h,j.state,j)},[n,l,a,i,e])}function gs(e,n){let{relative:r}=n===void 0?{}:n,{future:l}=x.useContext(en),{matches:s}=x.useContext(vn),{pathname:i}=jn(),a=JSON.stringify(Mu(s,l.v7_relativeSplatPath));return x.useMemo(()=>Uu(e,JSON.parse(a),i,r==="path"),[e,a,i,r])}function um(e,n){return hm(e,n)}function hm(e,n,r,l){Yr()||je(!1);let{navigator:s}=x.useContext(en),{matches:i}=x.useContext(vn),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let d=jn(),j;if(n){var h;let w=typeof n=="string"?tr(n):n;c==="/"||(h=w.pathname)!=null&&h.startsWith(c)||je(!1),j=w}else j=d;let f=j.pathname||"/",m=f;if(c!=="/"){let w=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(w.length).join("/")}let v=$p(e,{pathname:m}),S=gm(v&&v.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Kt([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Kt([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,l);return n&&S?x.createElement(xs.Provider,{value:{location:Wr({pathname:"/",search:"",hash:"",state:null,key:"default"},j),navigationType:Ot.Pop}},S):S}function fm(){let e=Sm(),n=am(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},n),r?x.createElement("pre",{style:s},r):null,null)}const pm=x.createElement(fm,null);class mm extends x.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,r){return r.location!==n.location||r.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:r.error,location:r.location,revalidation:n.revalidation||r.revalidation}}componentDidCatch(n,r){console.error("React Router caught the following error during render",n,r)}render(){return this.state.error!==void 0?x.createElement(vn.Provider,{value:this.props.routeContext},x.createElement(Vu.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xm(e){let{routeContext:n,match:r,children:l}=e,s=x.useContext(ms);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(vn.Provider,{value:n},l)}function gm(e,n,r,l){var s;if(n===void 0&&(n=[]),r===void 0&&(r=null),l===void 0&&(l=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=l)!=null&&i.v7_partialHydration&&n.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let j=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);j>=0||je(!1),a=a.slice(0,Math.min(a.length,j+1))}let c=!1,d=-1;if(r&&l&&l.v7_partialHydration)for(let j=0;j<a.length;j++){let h=a[j];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=j),h.route.id){let{loaderData:f,errors:m}=r,v=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||v){c=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((j,h,f)=>{let m,v=!1,S=null,w=null;r&&(m=o&&h.route.id?o[h.route.id]:void 0,S=h.route.errorElement||pm,c&&(d<0&&f===0?(wm("route-fallback"),v=!0,w=null):d===f&&(v=!0,w=h.route.hydrateFallbackElement||null)));let g=n.concat(a.slice(0,f+1)),p=()=>{let u;return m?u=S:v?u=w:h.route.Component?u=x.createElement(h.route.Component,null):h.route.element?u=h.route.element:u=j,x.createElement(xm,{match:h,routeContext:{outlet:j,matches:g,isDataRoute:r!=null},children:u})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?x.createElement(mm,{location:r.location,revalidation:r.revalidation,component:S,error:m,children:p(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):p()},null)}var Xu=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Xu||{}),Ku=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ku||{});function ym(e){let n=x.useContext(ms);return n||je(!1),n}function vm(e){let n=x.useContext(Hu);return n||je(!1),n}function jm(e){let n=x.useContext(vn);return n||je(!1),n}function Yu(e){let n=jm(),r=n.matches[n.matches.length-1];return r.route.id||je(!1),r.route.id}function Sm(){var e;let n=x.useContext(Vu),r=vm(),l=Yu();return n!==void 0?n:(e=r.errors)==null?void 0:e[l]}function bm(){let{router:e}=ym(Xu.UseNavigateStable),n=Yu(Ku.UseNavigateStable),r=x.useRef(!1);return Qu(()=>{r.current=!0}),x.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Wr({fromRouteId:n},i)))},[e,n])}const dc={};function wm(e,n,r){dc[e]||(dc[e]=!0)}function km(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Pe(e){je(!1)}function Nm(e){let{basename:n="/",children:r=null,location:l,navigationType:s=Ot.Pop,navigator:i,static:a=!1,future:o}=e;Yr()&&je(!1);let c=n.replace(/^\/*/,"/"),d=x.useMemo(()=>({basename:c,navigator:i,static:a,future:Wr({v7_relativeSplatPath:!1},o)}),[c,o,i,a]);typeof l=="string"&&(l=tr(l));let{pathname:j="/",search:h="",hash:f="",state:m=null,key:v="default"}=l,S=x.useMemo(()=>{let w=qn(j,c);return w==null?null:{location:{pathname:w,search:h,hash:f,state:m,key:v},navigationType:s}},[c,j,h,f,m,v,s]);return S==null?null:x.createElement(en.Provider,{value:d},x.createElement(xs.Provider,{children:r,value:S}))}function Cm(e){let{children:n,location:r}=e;return um(Ki(n),r)}new Promise(()=>{});function Ki(e,n){n===void 0&&(n=[]);let r=[];return x.Children.forEach(e,(l,s)=>{if(!x.isValidElement(l))return;let i=[...n,s];if(l.type===x.Fragment){r.push.apply(r,Ki(l.props.children,i));return}l.type!==Pe&&je(!1),!l.props.index||!l.props.children||je(!1);let a={id:l.props.id||i.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(a.children=Ki(l.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jl(){return Jl=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Jl.apply(this,arguments)}function qu(e,n){if(e==null)return{};var r={},l=Object.keys(e),s,i;for(i=0;i<l.length;i++)s=l[i],!(n.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Em(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Tm(e,n){return e.button===0&&(!n||n==="_self")&&!Em(e)}function Yi(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,r)=>{let l=e[r];return n.concat(Array.isArray(l)?l.map(s=>[r,s]):[[r,l]])},[]))}function Rm(e,n){let r=Yi(e);return n&&n.forEach((l,s)=>{r.has(s)||n.getAll(s).forEach(i=>{r.append(s,i)})}),r}const Pm=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Dm=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Im="6";try{window.__reactRouterVersion=Im}catch{}const Fm=x.createContext({isTransitioning:!1}),_m="startTransition",uc=kh[_m];function zm(e){let{basename:n,children:r,future:l,window:s}=e,i=x.useRef();i.current==null&&(i.current=Ap({window:s,v5Compat:!0}));let a=i.current,[o,c]=x.useState({action:a.action,location:a.location}),{v7_startTransition:d}=l||{},j=x.useCallback(h=>{d&&uc?uc(()=>c(h)):c(h)},[c,d]);return x.useLayoutEffect(()=>a.listen(j),[a,j]),x.useEffect(()=>km(l),[l]),x.createElement(Nm,{basename:n,children:r,location:o.location,navigationType:o.action,navigator:a,future:l})}const Lm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Am=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bm=x.forwardRef(function(n,r){let{onClick:l,relative:s,reloadDocument:i,replace:a,state:o,target:c,to:d,preventScrollReset:j,viewTransition:h}=n,f=qu(n,Pm),{basename:m}=x.useContext(en),v,S=!1;if(typeof d=="string"&&Am.test(d)&&(v=d,Lm))try{let u=new URL(window.location.href),y=d.startsWith("//")?new URL(u.protocol+d):new URL(d),E=qn(y.pathname,m);y.origin===u.origin&&E!=null?d=E+y.search+y.hash:S=!0}catch{}let w=cm(d,{relative:s}),g=Mm(d,{replace:a,state:o,target:c,preventScrollReset:j,relative:s,viewTransition:h});function p(u){l&&l(u),u.defaultPrevented||g(u)}return x.createElement("a",Jl({},f,{href:v||w,onClick:S||i?l:p,ref:r,target:c}))}),Om=x.forwardRef(function(n,r){let{"aria-current":l="page",caseSensitive:s=!1,className:i="",end:a=!1,style:o,to:c,viewTransition:d,children:j}=n,h=qu(n,Dm),f=gs(c,{relative:h.relative}),m=jn(),v=x.useContext(Hu),{navigator:S,basename:w}=x.useContext(en),g=v!=null&&Um(f)&&d===!0,p=S.encodeLocation?S.encodeLocation(f).pathname:f.pathname,u=m.pathname,y=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(u=u.toLowerCase(),y=y?y.toLowerCase():null,p=p.toLowerCase()),y&&w&&(y=qn(y,w)||y);const E=p!=="/"&&p.endsWith("/")?p.length-1:p.length;let I=u===p||!a&&u.startsWith(p)&&u.charAt(E)==="/",_=y!=null&&(y===p||!a&&y.startsWith(p)&&y.charAt(p.length)==="/"),z={isActive:I,isPending:_,isTransitioning:g},D=I?l:void 0,C;typeof i=="function"?C=i(z):C=[i,I?"active":null,_?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(z):o;return x.createElement(Bm,Jl({},h,{"aria-current":D,className:C,ref:r,style:R,to:c,viewTransition:d}),typeof j=="function"?j(z):j)});var qi;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(qi||(qi={}));var hc;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(hc||(hc={}));function $m(e){let n=x.useContext(ms);return n||je(!1),n}function Mm(e,n){let{target:r,replace:l,state:s,preventScrollReset:i,relative:a,viewTransition:o}=n===void 0?{}:n,c=nr(),d=jn(),j=gs(e,{relative:a});return x.useCallback(h=>{if(Tm(h,r)){h.preventDefault();let f=l!==void 0?l:Gl(d)===Gl(j);c(e,{replace:f,state:s,preventScrollReset:i,relative:a,viewTransition:o})}},[d,c,j,l,s,r,e,i,a,o])}function Xa(e){let n=x.useRef(Yi(e)),r=x.useRef(!1),l=jn(),s=x.useMemo(()=>Rm(l.search,r.current?null:n.current),[l.search]),i=nr(),a=x.useCallback((o,c)=>{const d=Yi(typeof o=="function"?o(s):o);r.current=!0,i("?"+d,c)},[i,s]);return[s,a]}function Um(e,n){n===void 0&&(n={});let r=x.useContext(Fm);r==null&&je(!1);let{basename:l}=$m(qi.useViewTransitionState),s=gs(e,{relative:n.relative});if(!r.isTransitioning)return!1;let i=qn(r.currentLocation.pathname,l)||r.currentLocation.pathname,a=qn(r.nextLocation.pathname,l)||r.nextLocation.pathname;return Xi(s.pathname,a)!=null||Xi(s.pathname,i)!=null}const tn="/api";let Gn=localStorage.getItem("auth_token");function Gu(e){Gn=e,e?localStorage.setItem("auth_token",e):localStorage.removeItem("auth_token")}function Gi(){return Gn}function nn(){Gu(null)}function Sn(){const e={"Content-Type":"application/json"};return Gn&&(e["X-Auth-Token"]=Gn),e}function q(e,n){const[r,l]=x.useState(null),[s,i]=x.useState(!0),[a,o]=x.useState(null),c=x.useCallback(async()=>{if(!e){i(!1);return}try{const d=await fetch(`${tn}${e}`,{headers:Sn()});if(d.status===401){nn(),window.location.reload();return}if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const j=await d.json();l(j),o(null)}catch(d){o(d instanceof Error?d.message:"Unknown error")}finally{i(!1)}},[e]);return x.useEffect(()=>{if(c(),n){const d=setInterval(c,n);return()=>clearInterval(d)}},[c,n]),{data:r,loading:s,error:a,refetch:c}}async function yt(e){const n=await fetch(`${tn}${e}`,{method:"GET",headers:Sn()});if(n.status===401)throw nn(),window.location.reload(),new Error("Authentication required");if(!n.ok){const r=await n.json().catch(()=>({error:n.statusText}));throw new Error(r.error||`HTTP ${n.status}`)}return n.json()}async function ve(e,n){const r=await fetch(`${tn}${e}`,{method:"POST",headers:Sn(),body:JSON.stringify(n)});if(r.status===401)throw nn(),window.location.reload(),new Error("Authentication required");if(!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));throw new Error(l.error||`HTTP ${r.status}`)}return r.json()}async function xn(e,n){const r=await fetch(`${tn}${e}`,{method:"PUT",headers:Sn(),body:JSON.stringify(n)});if(r.status===401)throw nn(),window.location.reload(),new Error("Authentication required");if(!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));throw new Error(l.error||`HTTP ${r.status}`)}return r.json()}async function Nt(e){const n=await fetch(`${tn}${e}`,{method:"DELETE",headers:Sn()});if(n.status===401)throw nn(),window.location.reload(),new Error("Authentication required");if(!n.ok&&n.status!==204){const l=await n.json().catch(()=>({error:n.statusText}));throw new Error(l.error||`HTTP ${n.status}`)}if(n.status===204)return{};const r=n.headers.get("content-type");return r&&r.includes("application/json")?n.json():{}}async function Wm(){const e=await fetch(`${tn}/auth/check`,{headers:Sn()});return e.ok?e.json():{authenticated:!1,authRequired:!0}}async function Ys(e,n){const r=await fetch(`${tn}${e}`,{...n,headers:{...Sn(),...(n==null?void 0:n.headers)||{}}});if(r.status===401)throw nn(),window.location.reload(),new Error("Authentication required");if(!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));throw new Error(l.error||`HTTP ${r.status}`)}return r.status===204?{}:r.json()}async function Ju(e){const n={};Gn&&(n["X-Auth-Token"]=Gn);const r=await fetch(`${tn}${e}`,{headers:n});if(r.status===401)throw nn(),window.location.reload(),new Error("Authentication required");if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const l=await r.blob();return URL.createObjectURL(l)}function fc({data:e,width:n=600,height:r=200,type:l="transfers",title:s}){const i=x.useMemo(()=>{if(!e||e.length===0)return{points:[],maxValue:0,labels:[]};const v=e.map(D=>l==="transfers"?D.transfers:D.bytes),S=l==="transfers"?e.map(D=>D.successful):[],w=l==="transfers"?e.map(D=>D.failed):[],g=Math.max(...v,1),p=40,u=n-p*2,y=r-p*2,E=v.map((D,C)=>({x:p+C/Math.max(e.length-1,1)*u,y:r-p-D/g*y,value:D})),I=S.map((D,C)=>({x:p+C/Math.max(e.length-1,1)*u,y:r-p-D/g*y,value:D})),_=w.map((D,C)=>({x:p+C/Math.max(e.length-1,1)*u,y:r-p-D/g*y,value:D})),z=e.length>0?[qs(e[0].timestampIso),e.length>1?qs(e[Math.floor(e.length/2)].timestampIso):"",e.length>1?qs(e[e.length-1].timestampIso):""]:[];return{points:E,successPoints:I,failedPoints:_,maxValue:g,labels:z,padding:p}},[e,n,r,l]);if(!e||e.length===0)return t.jsx("div",{style:{width:n,height:r,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--bg-color)",borderRadius:"6px",color:"var(--text-light)"},children:"No data available"});const{points:a,successPoints:o,failedPoints:c,maxValue:d,labels:j,padding:h}=i,f=v=>v.length===0?"":v.map((w,g)=>`${g===0?"M":"L"} ${w.x} ${w.y}`).join(" "),m=v=>v.length===0?"":`${v.map((w,g)=>`${g===0?"M":"L"} ${w.x} ${w.y}`).join(" ")} L ${v[v.length-1].x} ${r-h} L ${v[0].x} ${r-h} Z`;return t.jsxs("div",{style:{marginBottom:"1rem"},children:[s&&t.jsx("div",{style:{fontWeight:600,marginBottom:"0.5rem",fontSize:"0.875rem"},children:s}),t.jsxs("svg",{width:n,height:r,style:{display:"block"},children:[t.jsx("rect",{x:0,y:0,width:n,height:r,fill:"var(--bg-color)",rx:6}),[0,.25,.5,.75,1].map((v,S)=>t.jsx("line",{x1:h,y1:h+v*(r-h*2),x2:n-h,y2:h+v*(r-h*2),stroke:"var(--border-color)",strokeDasharray:"4 4",opacity:.5},S)),l==="transfers"&&o.length>0?t.jsxs(t.Fragment,{children:[t.jsx("path",{d:m(o),fill:"var(--success-color)",opacity:.2}),t.jsx("path",{d:f(o),fill:"none",stroke:"var(--success-color)",strokeWidth:2}),t.jsx("path",{d:m(c),fill:"var(--danger-color)",opacity:.2}),t.jsx("path",{d:f(c),fill:"none",stroke:"var(--danger-color)",strokeWidth:2})]}):t.jsxs(t.Fragment,{children:[t.jsx("path",{d:m(a),fill:"var(--secondary-color)",opacity:.2}),t.jsx("path",{d:f(a),fill:"none",stroke:"var(--secondary-color)",strokeWidth:2})]}),t.jsx("text",{x:h-5,y:h,textAnchor:"end",fontSize:10,fill:"var(--text-light)",children:Hm(d,l)}),t.jsx("text",{x:h-5,y:r-h,textAnchor:"end",fontSize:10,fill:"var(--text-light)",children:"0"}),j[0]&&t.jsx("text",{x:h,y:r-5,textAnchor:"start",fontSize:10,fill:"var(--text-light)",children:j[0]}),j[1]&&t.jsx("text",{x:n/2,y:r-5,textAnchor:"middle",fontSize:10,fill:"var(--text-light)",children:j[1]}),j[2]&&t.jsx("text",{x:n-h,y:r-5,textAnchor:"end",fontSize:10,fill:"var(--text-light)",children:j[2]}),l==="transfers"&&t.jsxs(t.Fragment,{children:[t.jsx("circle",{cx:n-100,cy:15,r:4,fill:"var(--success-color)"}),t.jsx("text",{x:n-92,y:18,fontSize:10,fill:"var(--text-light)",children:"Successful"}),t.jsx("circle",{cx:n-100,cy:30,r:4,fill:"var(--danger-color)"}),t.jsx("text",{x:n-92,y:33,fontSize:10,fill:"var(--text-light)",children:"Failed"})]})]})]})}function qs(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return""}}function Hm(e,n){return n==="bytes"?e<1024?e+" B":e<1024*1024?(e/1024).toFixed(0)+" KB":e<1024*1024*1024?(e/(1024*1024)).toFixed(0)+" MB":(e/(1024*1024*1024)).toFixed(1)+" GB":e.toString()}function Vm(){const[e,n]=x.useState("minutes"),{data:r,loading:l,error:s}=q("/status",3e4),{data:i,loading:a,error:o}=q("/status/health",1e4),{data:c}=q("/transfers/active",2e3),{data:d}=q("/metrics",3e4),{data:j}=q("/metrics/timeseries/minutes?count=60",3e4),{data:h}=q("/metrics/timeseries/hours?count=24",6e4),{data:f}=q("/metrics/timeseries/days?count=30",3e5),m=v=>v<1024?v+" B":v<1024*1024?(v/1024).toFixed(1)+" KB":v<1024*1024*1024?(v/(1024*1024)).toFixed(1)+" MB":(v/(1024*1024*1024)).toFixed(2)+" GB";return l||a?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):s||o?t.jsxs("div",{className:"error-message",children:["Failed to load status: ",s||o]}):t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"System Status"}),t.jsx("span",{className:`status-badge status-${(i==null?void 0:i.status.toLowerCase())||"down"}`,children:(i==null?void 0:i.status)||"Unknown"})]}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:r==null?void 0:r.version}),t.jsx("div",{className:"stat-label",children:"Version"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:r==null?void 0:r.uptime}),t.jsx("div",{className:"stat-label",children:"Uptime"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:i==null?void 0:i.destinationsAvailable}),t.jsx("div",{className:"stat-label",children:"Destinations Available"})]})]})]}),t.jsxs("div",{className:"dashboard-grid",children:[t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Transfer Statistics"})}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(r==null?void 0:r.transfers.total)||0}),t.jsx("div",{className:"stat-label",children:"Total"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:"var(--success-color)"},children:(r==null?void 0:r.transfers.successful)||0}),t.jsx("div",{className:"stat-label",children:"Successful"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:"var(--danger-color)"},children:(r==null?void 0:r.transfers.failed)||0}),t.jsx("div",{className:"stat-label",children:"Failed"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:"var(--warning-color)"},children:(r==null?void 0:r.transfers.active)||0}),t.jsx("div",{className:"stat-label",children:"Active"})]})]}),(r==null?void 0:r.transfers.total)&&r.transfers.total>0&&t.jsxs("div",{style:{marginTop:"1rem",textAlign:"center",color:"var(--text-light)"},children:["Success Rate: ",(r.transfers.successRate??0).toFixed(1),"%"]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Active Routes"})}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"AE Title"}),t.jsx("th",{children:"Port"}),t.jsx("th",{children:"Destinations"}),t.jsx("th",{children:"Status"})]})}),t.jsxs("tbody",{children:[r==null?void 0:r.routes.map(v=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:v.aeTitle})}),t.jsx("td",{children:v.port}),t.jsx("td",{children:v.destinations}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${v.enabled?"up":"down"}`,children:v.enabled?"Enabled":"Disabled"})})]},v.aeTitle)),(!(r!=null&&r.routes)||r.routes.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--text-light)"},children:"No routes configured"})})]})]})})]})]}),c&&c.count>0&&t.jsxs("div",{className:"card",style:{borderLeft:"4px solid var(--warning-color)"},children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Active Transfers (",c.count,")"]}),t.jsx("span",{style:{color:"var(--text-light)",fontSize:"0.875rem"},children:"Auto-refreshing every 2s"})]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:c.transfers.map(v=>t.jsxs("div",{style:{background:"var(--bg-color)",borderRadius:"6px",padding:"1rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:v.aeTitle}),t.jsx("span",{style:{marginLeft:"0.5rem",color:"var(--text-light)",fontSize:"0.875rem"},children:v.status})]}),t.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-light)"},children:[v.filesProcessed," / ",v.fileCount," files",t.jsxs("span",{style:{marginLeft:"0.5rem"},children:["(",m(v.bytesProcessed)," / ",m(v.totalSize),")"]})]})]}),t.jsxs("div",{style:{background:"var(--border-color)",borderRadius:"4px",height:"24px",overflow:"hidden",position:"relative"},children:[t.jsx("div",{style:{background:"linear-gradient(90deg, var(--secondary-color), var(--success-color))",height:"100%",width:`${v.progressPercent}%`,transition:"width 0.3s ease-in-out",borderRadius:"4px"}}),t.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.875rem",color:v.progressPercent>50?"white":"var(--text-color)"},children:[(v.progressPercent??0).toFixed(1),"%"]})]}),t.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"var(--text-light)"},children:t.jsxs("code",{style:{fontSize:"0.75rem"},children:[v.studyUid.substring(0,40),"..."]})})]},v.transferId))})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Destinations"})}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Availability"}),t.jsx("th",{children:"Status"})]})}),t.jsxs("tbody",{children:[r==null?void 0:r.destinations.map(v=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:v.name})}),t.jsx("td",{children:v.type}),t.jsxs("td",{children:[(v.availabilityPercent??0).toFixed(1),"%"]}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${v.available?"available":"unavailable"}`,children:v.available?"Available":"Unavailable"})})]},v.name)),(!(r!=null&&r.destinations)||r.destinations.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--text-light)"},children:"No destinations configured"})})]})]})})]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Transfer Metrics"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:`btn btn-sm ${e==="minutes"?"btn-primary":"btn-secondary"}`,onClick:()=>n("minutes"),children:"Last Hour"}),t.jsx("button",{className:`btn btn-sm ${e==="hours"?"btn-primary":"btn-secondary"}`,onClick:()=>n("hours"),children:"Last 24 Hours"}),t.jsx("button",{className:`btn btn-sm ${e==="days"?"btn-primary":"btn-secondary"}`,onClick:()=>n("days"),children:"Last 30 Days"})]})]}),d&&t.jsxs("div",{className:"stat-grid",style:{marginBottom:"1rem"},children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:d.currentThroughput.toFixed(1)}),t.jsx("div",{className:"stat-label",children:"Transfers/min"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:m(d.currentBytesPerMinute)}),t.jsx("div",{className:"stat-label",children:"Throughput/min"})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[t.jsx(fc,{data:e==="minutes"?(j==null?void 0:j.data)||[]:e==="hours"?(h==null?void 0:h.data)||[]:(f==null?void 0:f.data)||[],type:"transfers",title:"Transfer Activity",width:700,height:200}),t.jsx(fc,{data:e==="minutes"?(j==null?void 0:j.data)||[]:e==="hours"?(h==null?void 0:h.data)||[]:(f==null?void 0:f.data)||[],type:"bytes",title:"Data Volume",width:700,height:200})]})]}),d&&Object.keys(d.routes).length>0&&t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Route Performance"})}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"AE Title"}),t.jsx("th",{children:"Total Transfers"}),t.jsx("th",{children:"Success"}),t.jsx("th",{children:"Failed"}),t.jsx("th",{children:"Data Volume"}),t.jsx("th",{children:"Throughput"})]})}),t.jsx("tbody",{children:Object.entries(d.routes).map(([v,S])=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:S.aeTitle})}),t.jsx("td",{children:S.totalTransfers}),t.jsx("td",{style:{color:"var(--success-color)"},children:S.successfulTransfers}),t.jsx("td",{style:{color:S.failedTransfers>0?"var(--danger-color)":void 0},children:S.failedTransfers}),t.jsx("td",{children:m(S.totalBytes)}),t.jsxs("td",{children:[S.recentThroughput.toFixed(1),"/min"]})]},v))})]})})]})]})}const pc={aeTitle:"",port:11112,description:"",enabled:!0,workerThreads:4,maxConcurrentTransfers:2,studyTimeoutSeconds:300,rateLimitPerMinute:0},mc={destination:"",enabled:!0,anonymize:!1,anonScript:"",projectId:"",subjectPrefix:"",sessionPrefix:"",priority:0,retryCount:3,retryDelaySeconds:60,useHonestBroker:!1,honestBroker:"",ocrEnabled:!1,ocrRedact:!1,ocrConfidenceThreshold:60,ocrRedactPadding:2};function Qm(){var $,H,V;const{data:e,loading:n,error:r,refetch:l}=q("/routes"),{data:s}=q("/destinations"),{data:i}=q("/brokers"),{data:a}=q("/scripts"),[o,c]=x.useState(null),{data:d,refetch:j}=q(o?`/routes/${o}`:""),[h,f]=x.useState(!1),[m,v]=x.useState(null),[S,w]=x.useState(pc),[g,p]=x.useState(!1),[u,y]=x.useState(null),[E,I]=x.useState(!1),[_,z]=x.useState(null),[D,C]=x.useState(mc),R=()=>{w(pc),v(null),f(!0),y(null)},ne=b=>{w({aeTitle:b.aeTitle,port:b.port,description:b.description||"",enabled:b.enabled,workerThreads:b.workerThreads,maxConcurrentTransfers:b.maxConcurrentTransfers,studyTimeoutSeconds:b.studyTimeoutSeconds,rateLimitPerMinute:b.rateLimitPerMinute||0}),v(b.aeTitle),f(!0),y(null)},K=async b=>{b.preventDefault(),p(!0),y(null);try{m?await xn(`/routes/${m}`,S):await ve("/routes",S),f(!1),l(),o&&j()}catch(T){y(T instanceof Error?T.message:"Failed to save route")}finally{p(!1)}},Z=async b=>{if(confirm(`Delete route "${b}"? This cannot be undone.`))try{await Nt(`/routes/${b}`),o===b&&c(null),l()}catch(T){alert(T instanceof Error?T.message:"Failed to delete route")}},A=()=>{C(mc),z(null),I(!0),y(null)},ae=b=>{C({destination:b.destination,enabled:b.enabled,anonymize:b.anonymize,anonScript:b.anonScript||"",projectId:b.projectId||"",subjectPrefix:b.subjectPrefix||"",sessionPrefix:b.sessionPrefix||"",priority:b.priority,retryCount:b.retryCount,retryDelaySeconds:b.retryDelaySeconds,useHonestBroker:b.useHonestBroker||!1,honestBroker:b.honestBroker||"",ocrEnabled:b.ocrEnabled||!1,ocrRedact:b.ocrRedact||!1,ocrConfidenceThreshold:b.ocrConfidenceThreshold??60,ocrRedactPadding:b.ocrRedactPadding??2}),z(b.destination),I(!0),y(null)},Se=async b=>{if(b.preventDefault(),!!o){p(!0),y(null);try{_?await xn(`/routes/${o}/destinations/${_}`,D):await ve(`/routes/${o}/destinations`,D),I(!1),j()}catch(T){y(T instanceof Error?T.message:"Failed to save destination")}finally{p(!1)}}},k=async b=>{if(o&&confirm(`Remove destination "${b}" from this route?`))try{await Nt(`/routes/${o}/destinations/${b}`),j()}catch(T){alert(T instanceof Error?T.message:"Failed to remove destination")}},O=(s||[]).reduce((b,T)=>(b[T.name]=T,b),{});return n?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):r?t.jsxs("div",{className:"error-message",children:["Failed to load routes: ",r]}):t.jsxs("div",{children:[h&&t.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:t.jsxs("div",{className:"modal",onClick:b=>b.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:m?"Edit Route":"Create Route"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"Cancel"})]}),t.jsxs("form",{onSubmit:K,children:[u&&t.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:u}),t.jsxs("div",{className:"form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"AE Title *"}),t.jsx("input",{type:"text",value:S.aeTitle,onChange:b=>w({...S,aeTitle:b.target.value.toUpperCase()}),required:!0,maxLength:16,pattern:"[A-Z0-9_]+",disabled:!!m,placeholder:"ROUTER_AE"}),t.jsx("small",{children:"Up to 16 characters, uppercase letters, numbers, and underscores only"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Port *"}),t.jsx("input",{type:"number",value:S.port,onChange:b=>w({...S,port:parseInt(b.target.value)||11112}),required:!0,min:1024,max:65535})]}),t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Description"}),t.jsx("input",{type:"text",value:S.description,onChange:b=>w({...S,description:b.target.value}),placeholder:"Optional description"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Worker Threads"}),t.jsx("input",{type:"number",value:S.workerThreads,onChange:b=>w({...S,workerThreads:parseInt(b.target.value)||4}),min:1,max:32})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Max Concurrent Transfers"}),t.jsx("input",{type:"number",value:S.maxConcurrentTransfers,onChange:b=>w({...S,maxConcurrentTransfers:parseInt(b.target.value)||2}),min:1,max:16})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Study Timeout (seconds)"}),t.jsx("input",{type:"number",value:S.studyTimeoutSeconds,onChange:b=>w({...S,studyTimeoutSeconds:parseInt(b.target.value)||300}),min:60})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Rate Limit (per minute)"}),t.jsx("input",{type:"number",value:S.rateLimitPerMinute,onChange:b=>w({...S,rateLimitPerMinute:parseInt(b.target.value)||0}),min:0}),t.jsx("small",{children:"0 = no limit"})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:S.enabled,onChange:b=>w({...S,enabled:b.target.checked})}),"Enabled"]})})]}),t.jsx("div",{className:"form-actions",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Saving...":"Save Route"})})]})]})}),E&&o&&t.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:t.jsxs("div",{className:"modal",onClick:b=>b.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:_?"Edit Destination":"Add Destination"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>I(!1),children:"Cancel"})]}),t.jsxs("form",{onSubmit:Se,children:[u&&t.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:u}),t.jsxs("div",{className:"form-grid",children:[t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Destination *"}),t.jsxs("select",{value:D.destination,onChange:b=>C({...D,destination:b.target.value}),required:!0,disabled:!!_,children:[t.jsx("option",{value:"",children:"Select a destination..."}),s==null?void 0:s.map(b=>t.jsxs("option",{value:b.name,children:[b.name," (",b.type,")"]},b.name))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Project ID"}),t.jsx("input",{type:"text",value:D.projectId,onChange:b=>C({...D,projectId:b.target.value}),placeholder:"XNAT project ID"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Priority"}),t.jsx("input",{type:"number",value:D.priority,onChange:b=>C({...D,priority:parseInt(b.target.value)||0}),min:0}),t.jsx("small",{children:"Higher = processed first"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Subject Prefix"}),t.jsx("input",{type:"text",value:D.subjectPrefix,onChange:b=>C({...D,subjectPrefix:b.target.value})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Session Prefix"}),t.jsx("input",{type:"text",value:D.sessionPrefix,onChange:b=>C({...D,sessionPrefix:b.target.value})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Retry Count"}),t.jsx("input",{type:"number",value:D.retryCount,onChange:b=>C({...D,retryCount:parseInt(b.target.value)||3}),min:0,max:10})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Retry Delay (seconds)"}),t.jsx("input",{type:"number",value:D.retryDelaySeconds,onChange:b=>C({...D,retryDelaySeconds:parseInt(b.target.value)||60}),min:1})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:D.enabled,onChange:b=>C({...D,enabled:b.target.checked})}),"Enabled"]})}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:D.anonymize,onChange:b=>C({...D,anonymize:b.target.checked})}),"Anonymize"]})}),D.anonymize&&t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Anonymization Script"}),t.jsxs("select",{value:D.anonScript,onChange:b=>C({...D,anonScript:b.target.value}),children:[(($=s==null?void 0:s.find(b=>b.name===D.destination))==null?void 0:$.type)==="xnat"&&t.jsx("option",{value:"",children:"Use XNAT defaults"}),((H=s==null?void 0:s.find(b=>b.name===D.destination))==null?void 0:H.type)!=="xnat"&&t.jsx("option",{value:"",children:"Select a script..."}),a==null?void 0:a.map(b=>t.jsxs("option",{value:b.name,children:[b.name," ",b.builtIn?"(built-in)":"(custom)"]},b.name))]}),((V=s==null?void 0:s.find(b=>b.name===D.destination))==null?void 0:V.type)==="xnat"&&!D.anonScript&&t.jsx("small",{children:"Will use the anonymization script configured in XNAT for this project"})]}),t.jsxs("div",{className:"form-group checkbox-group",style:{gridColumn:"span 2"},children:[t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:D.ocrEnabled,onChange:b=>C({...D,ocrEnabled:b.target.checked,ocrRedact:b.target.checked?D.ocrRedact:!1})}),"OCR PHI Detection"]}),t.jsx("small",{children:"Scan pixel data for burned-in patient information using OCR"})]}),D.ocrEnabled&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group checkbox-group",children:[t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:D.ocrRedact,onChange:b=>C({...D,ocrRedact:b.target.checked})}),"Auto-redact detected PHI"]}),t.jsx("small",{children:"Black out detected text regions"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Confidence Threshold (%)"}),t.jsx("input",{type:"number",value:D.ocrConfidenceThreshold,onChange:b=>C({...D,ocrConfidenceThreshold:parseFloat(b.target.value)||60}),min:0,max:100,step:5}),t.jsx("small",{children:"Minimum OCR confidence (0-100)"})]}),D.ocrRedact&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Redact Padding (pixels)"}),t.jsx("input",{type:"number",value:D.ocrRedactPadding,onChange:b=>C({...D,ocrRedactPadding:parseInt(b.target.value)||2}),min:0,max:20}),t.jsx("small",{children:"Padding around redacted regions"})]})]}),t.jsxs("div",{className:"form-group checkbox-group",style:{gridColumn:"span 2"},children:[t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:D.useHonestBroker,onChange:b=>C({...D,useHonestBroker:b.target.checked})}),"Use Honest Broker"]}),t.jsx("small",{children:"Replace PatientID/Name with de-identified values"})]}),D.useHonestBroker&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Honest Broker"}),t.jsxs("select",{value:D.honestBroker,onChange:b=>C({...D,honestBroker:b.target.value}),required:D.useHonestBroker,children:[t.jsx("option",{value:"",children:"Select a broker..."}),i==null?void 0:i.filter(b=>b.enabled).map(b=>t.jsxs("option",{value:b.name,children:[b.name," (",b.type,")"]},b.name))]})]}),t.jsxs("div",{style:{gridColumn:"span 2",background:"var(--bg-secondary)",padding:"1rem",borderRadius:"8px",fontSize:"0.9em",lineHeight:"1.5"},children:[t.jsx("strong",{style:{display:"block",marginBottom:"0.5rem"},children:"How Honest Broker Works:"}),t.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem"},children:[t.jsx("li",{children:'Original PatientID is mapped to a de-identified ID (e.g., "SUBJ-PEACEFUL-PEACOCK")'}),t.jsx("li",{children:"The same input always produces the same output (deterministic)"}),t.jsx("li",{children:"All mappings are stored in a crosswalk database for audit purposes"}),t.jsx("li",{children:"Reverse lookup is available to recover original IDs if needed"})]}),t.jsxs("div",{style:{marginTop:"0.75rem",color:"var(--text-light)"},children:[t.jsx("strong",{children:"Naming schemes:"})," adjective_animal, color_animal, nato_phonetic, sequential, hash"]})]})]})]}),t.jsx("div",{className:"form-actions",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Saving...":"Save Destination"})})]})]})}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Configured Routes"}),t.jsx("button",{className:"btn btn-primary",onClick:R,children:"+ New Route"})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"AE Title"}),t.jsx("th",{children:"Port"}),t.jsx("th",{children:"Description"}),t.jsx("th",{children:"Worker Threads"}),t.jsx("th",{children:"Destinations"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[e==null?void 0:e.map(b=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:b.aeTitle})}),t.jsx("td",{children:b.port}),t.jsx("td",{children:b.description||"-"}),t.jsx("td",{children:b.workerThreads}),t.jsx("td",{children:b.destinationCount}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${b.enabled?"up":"down"}`,children:b.enabled?"Enabled":"Disabled"})}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>c(b.aeTitle),children:"Details"}),t.jsx("button",{className:"btn btn-danger",onClick:()=>Z(b.aeTitle),children:"Delete"})]})})]},b.aeTitle)),(!e||e.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-light)"},children:"No routes configured"})})]})]})})]}),o&&d&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Route: ",d.aeTitle]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>ne(d),children:"Edit"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>c(null),children:"Close"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Port:"})," ",d.port]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Description:"})," ",d.description||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Worker Threads:"})," ",d.workerThreads]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Max Concurrent Transfers:"})," ",d.maxConcurrentTransfers]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Study Timeout:"})," ",d.studyTimeoutSeconds,"s"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Rate Limit:"})," ",d.rateLimitPerMinute||"Unlimited","/min"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1.5rem",marginBottom:"1rem"},children:[t.jsx("h3",{style:{margin:0},children:"Destinations"}),t.jsx("button",{className:"btn btn-primary",onClick:A,children:"+ Add Destination"})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Destination"}),t.jsx("th",{children:"Project ID"}),t.jsx("th",{children:"Anonymize"}),t.jsx("th",{children:"Script"}),t.jsx("th",{children:"Honest Broker"}),t.jsx("th",{children:"Priority"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[d.destinations.map((b,T)=>{const G=O[b.destination],ce=(G==null?void 0:G.type)==="xnat",N=G==null?void 0:G.url;return t.jsxs("tr",{children:[t.jsxs("td",{children:[t.jsx("strong",{children:b.destination}),ce&&N&&t.jsx("a",{href:N,target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"0.5rem",fontSize:"0.85em"},title:`Open ${N}`,children:"(open XNAT)"})]}),t.jsx("td",{children:b.projectId||"-"}),t.jsx("td",{children:b.anonymize?"Yes":"No"}),t.jsx("td",{children:b.anonScript||"-"}),t.jsx("td",{children:b.useHonestBroker?b.honestBroker:"-"}),t.jsx("td",{children:b.priority}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${b.enabled?"up":"down"}`,children:b.enabled?"Enabled":"Disabled"})}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>ae(b),children:"Edit"}),t.jsx("button",{className:"btn btn-danger",onClick:()=>k(b.destination),children:"Remove"})]})})]},T)}),d.destinations.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:8,style:{textAlign:"center",color:"var(--text-light)"},children:"No destinations configured for this route"})})]})]})}),d.routingRules.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:"Routing Rules"}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Tag"}),t.jsx("th",{children:"Operator"}),t.jsx("th",{children:"Value"}),t.jsx("th",{children:"Destinations"})]})}),t.jsx("tbody",{children:d.routingRules.map((b,T)=>t.jsxs("tr",{children:[t.jsx("td",{children:b.name}),t.jsx("td",{children:t.jsx("code",{children:b.tag})}),t.jsx("td",{children:b.operator}),t.jsx("td",{children:b.value||b.values.join(", ")}),t.jsx("td",{children:b.destinations.join(", ")})]},T))})]})})]}),d.validationRules.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:"Validation Rules"}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Tag"}),t.jsx("th",{children:"On Failure"})]})}),t.jsx("tbody",{children:d.validationRules.map((b,T)=>t.jsxs("tr",{children:[t.jsx("td",{children:b.name}),t.jsx("td",{children:b.type}),t.jsx("td",{children:t.jsx("code",{children:b.tag})}),t.jsx("td",{children:b.onFailure})]},T))})]})})]}),d.filters.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:"Filters"}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Tag"}),t.jsx("th",{children:"Operator"}),t.jsx("th",{children:"Value"}),t.jsx("th",{children:"Action"})]})}),t.jsx("tbody",{children:d.filters.map((b,T)=>t.jsxs("tr",{children:[t.jsx("td",{children:b.name}),t.jsx("td",{children:t.jsx("code",{children:b.tag})}),t.jsx("td",{children:b.operator}),t.jsx("td",{children:b.value}),t.jsx("td",{children:b.action})]},T))})]})})]})]})]})}const xc={name:"",type:"xnat",enabled:!0,url:"",username:"",password:"",aeTitle:"",host:"",port:104,path:""};function Xm(){const{data:e,loading:n,error:r,refetch:l}=q("/destinations",3e4),{data:s}=q("/destinations/types"),[i,a]=x.useState(null),[o,c]=x.useState(null),{data:d,refetch:j}=q(o?`/destinations/${o}`:""),[h,f]=x.useState(!1),[m,v]=x.useState(null),[S,w]=x.useState(xc),[g,p]=x.useState(!1),[u,y]=x.useState(null),E=async C=>{a(C);try{await ve(`/destinations/${C}/check`,{}),l(),o===C&&j()}catch(R){console.error("Health check failed:",R)}finally{a(null)}},I=()=>{w(xc),v(null),f(!0),y(null)},_=C=>{w({name:C.name,type:C.type,enabled:C.enabled,url:C.url||"",username:"",password:"",aeTitle:C.aeTitle||"",host:C.host||"",port:C.port||104,path:C.path||""}),v(C.name),f(!0),y(null)},z=async C=>{C.preventDefault(),p(!0),y(null);try{const R={name:S.name,type:S.type,enabled:S.enabled};S.type==="xnat"?(R.url=S.url,S.username&&(R.username=S.username),S.password&&(R.password=S.password)):S.type==="dicom"?(R.aeTitle=S.aeTitle,R.host=S.host,R.port=S.port):S.type==="file"&&(R.path=S.path),m?await xn(`/destinations/${m}`,R):await ve("/destinations",R),f(!1),l()}catch(R){y(R instanceof Error?R.message:"Failed to save destination")}finally{p(!1)}},D=async C=>{if(confirm(`Delete destination "${C}"? This cannot be undone.`))try{await Nt(`/destinations/${C}`),o===C&&c(null),l()}catch(R){alert(R instanceof Error?R.message:"Failed to delete destination")}};return n?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):r?t.jsxs("div",{className:"error-message",children:["Failed to load destinations: ",r]}):t.jsxs("div",{children:[h&&t.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:t.jsxs("div",{className:"modal",onClick:C=>C.stopPropagation(),children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:m?"Edit Destination":"Create Destination"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"Cancel"})]}),t.jsxs("form",{onSubmit:z,children:[u&&t.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:u}),t.jsxs("div",{className:"form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Name *"}),t.jsx("input",{type:"text",value:S.name,onChange:C=>w({...S,name:C.target.value}),required:!0,disabled:!!m,placeholder:"my-destination"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type *"}),t.jsx("select",{value:S.type,onChange:C=>w({...S,type:C.target.value}),required:!0,disabled:!!m,children:(s==null?void 0:s.map(C=>t.jsxs("option",{value:C.type,children:[C.type.toUpperCase()," - ",C.description]},C.type)))||t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"xnat",children:"XNAT - XNAT instance"}),t.jsx("option",{value:"dicom",children:"DICOM - DICOM AE Title"}),t.jsx("option",{value:"file",children:"FILE - File system directory"})]})})]}),S.type==="xnat"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"URL *"}),t.jsx("input",{type:"url",value:S.url,onChange:C=>w({...S,url:C.target.value}),required:!0,placeholder:"https://xnat.example.com"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Username"}),t.jsx("input",{type:"text",value:S.username,onChange:C=>w({...S,username:C.target.value}),placeholder:"admin"}),m&&t.jsx("small",{children:"Leave blank to keep existing"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Password"}),t.jsx("input",{type:"password",value:S.password,onChange:C=>w({...S,password:C.target.value}),placeholder:"********"}),m&&t.jsx("small",{children:"Leave blank to keep existing"})]})]}),S.type==="dicom"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"AE Title *"}),t.jsx("input",{type:"text",value:S.aeTitle,onChange:C=>w({...S,aeTitle:C.target.value.toUpperCase()}),required:!0,maxLength:16,placeholder:"DESTINATION_AE"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Host *"}),t.jsx("input",{type:"text",value:S.host,onChange:C=>w({...S,host:C.target.value}),required:!0,placeholder:"192.168.1.100"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Port *"}),t.jsx("input",{type:"number",value:S.port,onChange:C=>w({...S,port:parseInt(C.target.value)||104}),required:!0,min:1,max:65535})]})]}),S.type==="file"&&t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Path *"}),t.jsx("input",{type:"text",value:S.path,onChange:C=>w({...S,path:C.target.value}),required:!0,placeholder:"/path/to/output"})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:S.enabled,onChange:C=>w({...S,enabled:C.target.checked})}),"Enabled"]})})]}),t.jsx("div",{className:"form-actions",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g,children:g?"Saving...":"Save Destination"})})]})]})}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Configured Destinations"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:I,children:"+ New Destination"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>l(),children:"Refresh"})]})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Target"}),t.jsx("th",{children:"Availability"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[e==null?void 0:e.map(C=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:C.name})}),t.jsx("td",{children:t.jsx("span",{style:{padding:"0.125rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:C.type==="xnat"?"#e3f2fd":C.type==="dicom"?"#fff3e0":"#e8f5e9",color:C.type==="xnat"?"#1565c0":C.type==="dicom"?"#ef6c00":"#2e7d32"},children:C.type.toUpperCase()})}),t.jsxs("td",{children:[C.type==="xnat"&&C.url,C.type==="dicom"&&`${C.aeTitle}@${C.host}:${C.port}`,C.type==="file"&&C.path]}),t.jsxs("td",{children:[(C.availabilityPercent??0).toFixed(1),"%"]}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${C.available?"available":"unavailable"}`,children:C.available?"Available":"Unavailable"})}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>E(C.name),disabled:i===C.name,children:i===C.name?"Checking...":"Check"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>c(C.name),children:"Details"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>_(C),children:"Edit"}),t.jsx("button",{className:"btn btn-danger",onClick:()=>D(C.name),children:"Delete"})]})})]},C.name)),(!e||e.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:6,style:{textAlign:"center",color:"var(--text-light)"},children:"No destinations configured"})})]})]})})]}),o&&d&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Destination: ",o]}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>c(null),children:"Close"})]}),d.health&&t.jsxs("div",{children:[t.jsx("h3",{style:{marginBottom:"1rem"},children:"Health Statistics"}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsxs("div",{className:"stat-value",children:[(d.health.availabilityPercent??0).toFixed(1),"%"]}),t.jsx("div",{className:"stat-label",children:"Availability"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:d.health.totalChecks}),t.jsx("div",{className:"stat-label",children:"Total Checks"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:d.health.successfulChecks}),t.jsx("div",{className:"stat-label",children:"Successful"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:d.health.consecutiveFailures>0?"var(--danger-color)":"inherit"},children:d.health.consecutiveFailures}),t.jsx("div",{className:"stat-label",children:"Consecutive Failures"})]})]}),t.jsxs("div",{style:{marginTop:"1.5rem"},children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Last Check:"})," ",d.health.lastCheck||"Never"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Last Available:"})," ",d.health.lastAvailable||"Never"]}),d.health.downtimeSeconds>0&&t.jsxs("p",{children:[t.jsx("strong",{children:"Current Downtime:"})," ",Math.round(d.health.downtimeSeconds/60)," minutes"]})]})]}),d.config&&t.jsxs("div",{style:{marginTop:"1.5rem"},children:[t.jsx("h3",{style:{marginBottom:"1rem"},children:"Configuration"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:Object.entries(d.config).map(([C,R])=>t.jsxs("div",{children:[t.jsxs("strong",{children:[C,":"]})," ",C.toLowerCase().includes("password")?"********":String(R)]},C))})]})]})]})}const gc={name:"",description:"",enabled:!0,broker_type:"local",naming_scheme:"adjective_animal",patient_id_prefix:"SUBJ",patient_name_prefix:"",cache_enabled:!0,cache_ttl_seconds:3600,cache_max_size:1e4,replace_patient_id:!0,replace_patient_name:!0,lookup_script:"",sts_host:"",api_host:"",app_name:"",app_key:"",username:"",password:"",timeout:30,date_shift_enabled:!1,date_shift_min_days:-365,date_shift_max_days:365,hash_uids_enabled:!1},Km=[{value:"adjective_animal",label:"Adjective-Animal",example:"SUBJ-PEACEFUL-PEACOCK"},{value:"color_animal",label:"Color-Animal",example:"SUBJ-AZURE-FALCON"},{value:"nato_phonetic",label:"NATO Phonetic",example:"SUBJ-ALPHA-BRAVO-CHARLIE"},{value:"sequential",label:"Sequential",example:"SUBJ-000001"},{value:"hash",label:"Hash-based",example:"SUBJ-A7F3B2C1"},{value:"script",label:"Custom Script",example:"Your custom logic"}],Ym=`// Custom lookup function for de-identification
// Parameters:
//   idIn - Original patient ID
//   idType - "patient_id", "patient_name", or "accession"
//   prefix - Configured prefix (e.g., "SUBJ")
//   context - { brokerName, mappingCount }
//
// Return: The de-identified ID string

function lookup(idIn, idType, prefix, context) {
  // Example: Use first 4 chars with prefix and sequential number
  var shortId = idIn.substring(0, Math.min(4, idIn.length)).toUpperCase();
  var seq = context.mappingCount + 1;
  return prefix + "-" + shortId + "-" + String(seq).padStart(4, "0");
}`;function qm(){var H,V,b;const{data:e,loading:n,error:r,refetch:l}=q("/brokers"),[s,i]=x.useState(null),{data:a,refetch:o}=q(s?`/brokers/${s}`:""),{data:c}=q(s?`/brokers/${s}/crosswalk?limit=${R?1e4:100}`:""),[d,j]=x.useState(!1),[h,f]=x.useState(null),[m,v]=x.useState(gc),[S,w]=x.useState(!1),[g,p]=x.useState(null),[u,y]=x.useState(""),[E,I]=x.useState(null),[_,z]=x.useState(null),[D,C]=x.useState(!1),[R,ne]=x.useState(!1),[K,Z]=x.useState(!1),A=()=>{v(gc),f(null),j(!0),p(null)},ae=T=>{var G,ce,N,Q,fe,ie,de,F,B,U,J,W,X,Y,re,Te,Re;v({name:T.name,description:T.description||"",enabled:T.enabled,broker_type:T.type,naming_scheme:((G=T.behavior)==null?void 0:G.namingScheme)||"adjective_animal",patient_id_prefix:((ce=T.behavior)==null?void 0:ce.patientIdPrefix)||"SUBJ",patient_name_prefix:((N=T.behavior)==null?void 0:N.patientNamePrefix)||"",cache_enabled:((Q=T.behavior)==null?void 0:Q.cacheEnabled)??!0,cache_ttl_seconds:((fe=T.behavior)==null?void 0:fe.cacheTtlSeconds)||3600,cache_max_size:((ie=T.behavior)==null?void 0:ie.cacheMaxSize)||1e4,replace_patient_id:((de=T.behavior)==null?void 0:de.replacePatientId)??!0,replace_patient_name:((F=T.behavior)==null?void 0:F.replacePatientName)??!0,lookup_script:((B=T.behavior)==null?void 0:B.lookupScript)||"",sts_host:((U=T.connection)==null?void 0:U.stsHost)||"",api_host:((J=T.connection)==null?void 0:J.apiHost)||"",app_name:((W=T.auth)==null?void 0:W.appName)||"",app_key:"",username:((X=T.auth)==null?void 0:X.username)||"",password:"",timeout:((Y=T.connection)==null?void 0:Y.timeout)||30,date_shift_enabled:((re=T.dateShift)==null?void 0:re.enabled)??!1,date_shift_min_days:((Te=T.dateShift)==null?void 0:Te.minDays)??-365,date_shift_max_days:((Re=T.dateShift)==null?void 0:Re.maxDays)??365,hash_uids_enabled:T.hashUidsEnabled??!1}),f(T.name),j(!0),p(null)},Se=async T=>{T.preventDefault(),w(!0),p(null);try{h?await xn(`/brokers/${h}`,m):await ve("/brokers",m),j(!1),l(),s&&o()}catch(G){p(G instanceof Error?G.message:"Failed to save broker")}finally{w(!1)}},k=async T=>{if(confirm(`Delete broker "${T}"? This will remove all crosswalk mappings!`))try{await Nt(`/brokers/${T}`),s===T&&i(null),l()}catch(G){alert(G instanceof Error?G.message:"Failed to delete broker")}},O=async()=>{if(!(!s||!u.trim())){C(!0),z(null),I(null);try{const T=await yt(`/brokers/${s}/lookup?idIn=${encodeURIComponent(u.trim())}`);T.success?(I({idIn:T.idIn,idOut:T.idOut}),o()):z(T.error||"Lookup failed")}catch(T){z(T instanceof Error?T.message:"Lookup failed")}finally{C(!1)}}},$=async()=>{Z(!0);try{const T=await fetch("/api/brokers/crosswalk/export",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")||""}`}});if(!T.ok)throw new Error("Failed to export CSV");const G=await T.text(),ce=new Blob([G],{type:"text/csv;charset=utf-8;"}),N=URL.createObjectURL(ce),Q=document.createElement("a");Q.href=N,Q.download=`crosswalk_export_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(N)}catch(T){alert(T instanceof Error?T.message:"Failed to export CSV")}finally{Z(!1)}};return n?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):r?t.jsxs("div",{className:"error-message",children:["Failed to load brokers: ",r]}):t.jsxs("div",{children:[d&&t.jsx("div",{className:"modal-overlay",onClick:()=>j(!1),children:t.jsxs("div",{className:"modal",onClick:T=>T.stopPropagation(),style:{maxWidth:"700px"},children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:h?"Edit Broker":"Create Honest Broker"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>j(!1),children:"Cancel"})]}),t.jsxs("form",{onSubmit:Se,children:[g&&t.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:g}),t.jsxs("div",{className:"form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Name *"}),t.jsx("input",{type:"text",value:m.name,onChange:T=>v({...m,name:T.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-")}),required:!0,disabled:!!h,placeholder:"my-broker"}),t.jsx("small",{children:"Lowercase letters, numbers, and hyphens only"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type"}),t.jsxs("select",{value:m.broker_type,onChange:T=>v({...m,broker_type:T.target.value}),children:[t.jsx("option",{value:"local",children:"Local (generates IDs locally)"}),t.jsx("option",{value:"remote",children:"Remote (external API)"})]})]}),t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Description"}),t.jsx("input",{type:"text",value:m.description,onChange:T=>v({...m,description:T.target.value}),placeholder:"Optional description"})]}),m.broker_type==="remote"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"form-group",style:{gridColumn:"span 2"},children:t.jsx("h4",{style:{margin:"0 0 0.5rem 0",color:"var(--primary)"},children:"Remote API Configuration"})}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"API Host *"}),t.jsx("input",{type:"text",value:m.api_host,onChange:T=>v({...m,api_host:T.target.value}),placeholder:"api.example.com",required:m.broker_type==="remote"}),t.jsx("small",{children:"De-identification lookup API host"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"STS Host"}),t.jsx("input",{type:"text",value:m.sts_host,onChange:T=>v({...m,sts_host:T.target.value}),placeholder:"sts.example.com"}),t.jsx("small",{children:"Security Token Service host (for auth)"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"App Name"}),t.jsx("input",{type:"text",value:m.app_name,onChange:T=>v({...m,app_name:T.target.value}),placeholder:"MyApp"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"App Key"}),t.jsx("input",{type:"password",value:m.app_key,onChange:T=>v({...m,app_key:T.target.value}),placeholder:"Enter app key"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Username"}),t.jsx("input",{type:"text",value:m.username,onChange:T=>v({...m,username:T.target.value}),placeholder:"Username"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Password"}),t.jsx("input",{type:"password",value:m.password,onChange:T=>v({...m,password:T.target.value}),placeholder:"Password"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Timeout (seconds)"}),t.jsx("input",{type:"number",value:m.timeout,onChange:T=>v({...m,timeout:parseInt(T.target.value)||30}),min:1,max:300})]})]}),m.broker_type==="local"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Naming Scheme"}),t.jsx("select",{value:m.naming_scheme,onChange:T=>{const G=T.target.value;v({...m,naming_scheme:G,lookup_script:G==="script"&&!m.lookup_script?Ym:m.lookup_script})},children:Km.map(T=>t.jsxs("option",{value:T.value,children:[T.label," (e.g., ",T.example,")"]},T.value))})]}),m.naming_scheme==="script"&&t.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[t.jsx("label",{children:"Lookup Script (JavaScript)"}),t.jsx("textarea",{value:m.lookup_script,onChange:T=>v({...m,lookup_script:T.target.value}),placeholder:"function lookup(idIn, idType, prefix, context) { ... }",style:{fontFamily:"monospace",fontSize:"13px",lineHeight:"1.4",minHeight:"300px",resize:"vertical",backgroundColor:"#1e1e1e",color:"#d4d4d4",border:"1px solid #3c3c3c",borderRadius:"4px",padding:"12px"}}),t.jsxs("small",{style:{display:"block",marginTop:"0.5rem",color:"var(--text-light)"},children:["Define a ",t.jsx("code",{children:"lookup(idIn, idType, prefix, context)"})," function that returns the de-identified ID. Available context: brokerName, mappingCount."]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient ID Prefix"}),t.jsx("input",{type:"text",value:m.patient_id_prefix,onChange:T=>v({...m,patient_id_prefix:T.target.value}),placeholder:"SUBJ"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient Name Prefix"}),t.jsx("input",{type:"text",value:m.patient_name_prefix,onChange:T=>v({...m,patient_name_prefix:T.target.value}),placeholder:"ANON"})]})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:m.replace_patient_id,onChange:T=>v({...m,replace_patient_id:T.target.checked})}),"Replace Patient ID"]})}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:m.replace_patient_name,onChange:T=>v({...m,replace_patient_name:T.target.checked})}),"Replace Patient Name"]})}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:m.cache_enabled,onChange:T=>v({...m,cache_enabled:T.target.checked})}),"Enable Caching"]})}),m.broker_type==="local"&&t.jsxs(t.Fragment,{children:[t.jsx("h4",{style:{marginTop:"20px",marginBottom:"10px",borderBottom:"1px solid #ddd",paddingBottom:"5px"},children:"Date Shifting"}),t.jsxs("div",{className:"form-group checkbox-group",children:[t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:m.date_shift_enabled,onChange:T=>v({...m,date_shift_enabled:T.target.checked})}),"Enable Date Shifting"]}),t.jsx("small",{className:"form-help",children:"Shift dates by a random offset (consistent per patient, stored in crosswalk)"})]}),m.date_shift_enabled&&t.jsxs("div",{className:"form-row",style:{display:"flex",gap:"20px"},children:[t.jsxs("div",{className:"form-group",style:{flex:1},children:[t.jsx("label",{children:"Min Days"}),t.jsx("input",{type:"number",value:m.date_shift_min_days,onChange:T=>v({...m,date_shift_min_days:parseInt(T.target.value)||-365})}),t.jsx("small",{className:"form-help",children:"e.g. -365 for up to 1 year back"})]}),t.jsxs("div",{className:"form-group",style:{flex:1},children:[t.jsx("label",{children:"Max Days"}),t.jsx("input",{type:"number",value:m.date_shift_max_days,onChange:T=>v({...m,date_shift_max_days:parseInt(T.target.value)||365})}),t.jsx("small",{className:"form-help",children:"e.g. 365 for up to 1 year forward"})]})]}),t.jsx("h4",{style:{marginTop:"20px",marginBottom:"10px",borderBottom:"1px solid #ddd",paddingBottom:"5px"},children:"UID Hashing"}),t.jsxs("div",{className:"form-group checkbox-group",children:[t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:m.hash_uids_enabled,onChange:T=>v({...m,hash_uids_enabled:T.target.checked})}),"Store UID Mappings in Crosswalk"]}),t.jsx("small",{className:"form-help",children:"When UIDs are hashed, store the mapping for audit and traceability"})]})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",checked:m.enabled,onChange:T=>v({...m,enabled:T.target.checked})}),"Enabled"]})})]}),t.jsx("div",{className:"form-actions",children:t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:S,children:S?"Saving...":"Save Broker"})})]})]})}),t.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:[t.jsx("h2",{style:{marginTop:0},children:"Honest Broker De-Identification"}),t.jsx("p",{style:{marginBottom:"1rem",opacity:.95},children:"An Honest Broker maps original patient identifiers (PatientID, PatientName) to de-identified values, enabling data sharing while protecting patient privacy. All mappings are stored in a crosswalk database for audit purposes and consistent re-identification if needed."}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Local Broker:"}),t.jsx("br",{}),t.jsx("span",{style:{opacity:.9},children:"Generates de-identified IDs locally using configurable naming schemes"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Remote Broker:"}),t.jsx("br",{}),t.jsx("span",{style:{opacity:.9},children:"Connects to external API with STS authentication"})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Configured Brokers"}),t.jsx("button",{className:"btn btn-primary",onClick:A,children:"+ New Broker"})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Description"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Naming Scheme"}),t.jsx("th",{children:"Mappings"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[e==null?void 0:e.map(T=>{var G;return t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:T.name})}),t.jsx("td",{children:T.description||"-"}),t.jsx("td",{children:t.jsx("span",{className:`status-badge ${T.type==="local"?"status-up":"status-pending"}`,children:T.type})}),t.jsx("td",{children:T.namingScheme||"-"}),t.jsx("td",{children:((G=T.crosswalk)==null?void 0:G.totalMappings)||0}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${T.enabled?"up":"down"}`,children:T.enabled?"Enabled":"Disabled"})}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>i(T.name),children:"Details"}),t.jsx("button",{className:"btn btn-danger",onClick:()=>k(T.name),children:"Delete"})]})})]},T.name)}),(!e||e.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-light)"},children:'No brokers configured. Click "New Broker" to create one.'})})]})]})})]}),s&&a&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Broker: ",a.name]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>ae(a),children:"Edit"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>i(null),children:"Close"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Type:"})," ",a.type]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Description:"})," ",a.description||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Naming Scheme:"})," ",a.behavior.namingScheme]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Patient ID Prefix:"})," ",a.behavior.patientIdPrefix||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Total Mappings:"})," ",((H=a.crosswalk)==null?void 0:H.totalMappings)||0]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Cache:"})," ",a.behavior.cacheEnabled?"Enabled":"Disabled"]})]}),t.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[t.jsx("h3",{style:{marginTop:0,marginBottom:"1rem"},children:"Test Lookup"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.9em"},children:"Original Patient ID"}),t.jsx("input",{type:"text",value:u,onChange:T=>y(T.target.value),placeholder:"e.g., PATIENT001",style:{width:"100%"}})]}),t.jsx("button",{className:"btn btn-primary",onClick:O,disabled:D||!u.trim(),children:D?"Looking up...":"Lookup"})]}),E&&t.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"var(--success-bg, #e8f5e9)",borderRadius:"4px"},children:[t.jsx("strong",{children:E.idIn}),"  ",t.jsx("strong",{style:{color:"var(--success, #4caf50)"},children:E.idOut})]}),_&&t.jsx("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"var(--error-bg, #ffebee)",borderRadius:"4px",color:"var(--error, #f44336)"},children:_})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[t.jsx("h3",{style:{margin:0},children:"Crosswalk Mappings"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>ne(!R),children:R?"Show Recent":`View All (${(c==null?void 0:c.totalMappings)||0})`}),t.jsx("button",{className:"btn btn-primary",onClick:$,disabled:K,children:K?"Exporting...":"Export CSV"})]})]}),t.jsx("div",{className:"table-container",style:{maxHeight:R?"600px":"auto",overflowY:R?"auto":"visible"},children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Original ID"}),t.jsx("th",{children:"De-identified ID"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Created"})]})}),t.jsxs("tbody",{children:[(b=R?c==null?void 0:c.mappings:(V=c==null?void 0:c.mappings)==null?void 0:V.slice(0,20))==null?void 0:b.map((T,G)=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("code",{children:T.idIn})}),t.jsx("td",{children:t.jsx("code",{style:{color:"var(--primary)"},children:T.idOut})}),t.jsx("td",{children:t.jsx("span",{className:`status-badge ${T.idType==="patient_id"?"status-up":T.idType==="session_id"?"status-pending":"status-down"}`,children:T.idType})}),t.jsx("td",{children:new Date(T.createdAt).toLocaleString()})]},G)),(!(c!=null&&c.mappings)||c.mappings.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--text-light)"},children:'No mappings yet. Use "Test Lookup" above to create one.'})})]})]})}),!R&&c&&c.mappings&&c.mappings.length>20&&t.jsxs("p",{style:{color:"var(--text-light)",fontSize:"0.9em",marginTop:"0.5rem"},children:["Showing first 20 of ",c.totalMappings,' mappings. Click "View All" to see complete list.']})]})]})}function Gm(){const{data:e,loading:n,error:r,refetch:l}=q("/scripts"),[s,i]=x.useState(null),{data:a}=q(s?`/scripts/${s}`:""),[o,c]=x.useState(!1),[d,j]=x.useState(""),[h,f]=x.useState(""),[m,v]=x.useState(!1),[S,w]=x.useState(!1),[g,p]=x.useState(""),[u,y]=x.useState(""),[E,I]=x.useState(""),[_,z]=x.useState(!1),D=A=>{j(A.content),f(A.description||""),c(!0)},C=async()=>{if(s){v(!0);try{await xn(`/scripts/${s}`,{content:d,description:h}),c(!1),l()}catch(A){alert("Failed to save: "+(A instanceof Error?A.message:"Unknown error"))}finally{v(!1)}}},R=async A=>{if(confirm(`Delete script "${A}"?`))try{await Nt(`/scripts/${A}`),i(null),l()}catch(ae){alert("Failed to delete: "+(ae instanceof Error?ae.message:"Unknown error"))}},ne=async()=>{if(!g.trim()||!E.trim()){alert("Name and content are required");return}z(!0);try{await ve("/scripts",{name:g,description:u,content:E}),w(!1),p(""),y(""),I(""),l()}catch(A){alert("Failed to create: "+(A instanceof Error?A.message:"Unknown error"))}finally{z(!1)}};if(n)return t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})});if(r)return t.jsxs("div",{className:"error-message",children:["Failed to load scripts: ",r]});const K=(e==null?void 0:e.filter(A=>A.builtIn))||[],Z=(e==null?void 0:e.filter(A=>!A.builtIn))||[];return t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Anonymization Scripts"}),t.jsx("button",{className:"btn btn-primary",onClick:()=>w(!0),children:"New Script"})]}),t.jsx("h3",{style:{marginBottom:"1rem"},children:"Built-in Scripts"}),t.jsx("div",{className:"table-container",style:{marginBottom:"1.5rem"},children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Description"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:K.map(A=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:A.name})}),t.jsx("td",{children:A.description}),t.jsx("td",{children:t.jsx("button",{className:"btn btn-secondary",onClick:()=>{i(A.name),c(!1)},children:"View"})})]},A.name))})]})}),t.jsx("h3",{style:{marginBottom:"1rem"},children:"Custom Scripts"}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Description"}),t.jsx("th",{children:"Source"}),t.jsx("th",{children:"Modified"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[Z.map(A=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:A.name})}),t.jsx("td",{children:A.description||"-"}),t.jsx("td",{children:A.source}),t.jsx("td",{children:A.modifiedAt?new Date(A.modifiedAt).toLocaleDateString():"-"}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>{i(A.name),c(!1)},children:"View"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>R(A.name),children:"Delete"})]})})]},A.name)),Z.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:5,style:{textAlign:"center",color:"var(--text-light)"},children:"No custom scripts"})})]})]})})]}),S&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Create New Script"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>w(!1),children:"Cancel"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Name"}),t.jsx("input",{type:"text",className:"form-input",value:g,onChange:A=>p(A.target.value),placeholder:"my_custom_script"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("input",{type:"text",className:"form-input",value:u,onChange:A=>y(A.target.value),placeholder:"Description of the script"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Script Content (DicomEdit format)"}),t.jsx("textarea",{className:"form-textarea",value:E,onChange:A=>I(A.target.value),rows:15,style:{fontFamily:"monospace"},placeholder:`version "6.3"

// Example: Remove patient name
(0010,0010) := "ANONYMOUS"`})]}),t.jsx("button",{className:"btn btn-primary",onClick:ne,disabled:_,children:_?"Creating...":"Create Script"})]}),s&&a&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Script: ",a.name]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[!a.builtIn&&!o&&t.jsx("button",{className:"btn btn-primary",onClick:()=>D(a),children:"Edit"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>i(null),children:"Close"})]})]}),t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Description:"})," ",a.description||"-"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Source:"})," ",a.source]}),a.modifiedAt&&t.jsxs("p",{children:[t.jsx("strong",{children:"Modified:"})," ",new Date(a.modifiedAt).toLocaleString()]})]}),o?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("input",{type:"text",className:"form-input",value:h,onChange:A=>f(A.target.value)})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Script Content"}),t.jsx("textarea",{className:"form-textarea",value:d,onChange:A=>j(A.target.value),rows:20,style:{fontFamily:"monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:C,disabled:m,children:m?"Saving...":"Save Changes"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"})]})]}):t.jsx("pre",{style:{background:"var(--bg-color)",padding:"1rem",borderRadius:"6px",overflow:"auto",fontSize:"0.875rem",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:a.content})]})]})}function Jm(){var u;const[e,n]=x.useState(""),[r,l]=x.useState(""),{data:s}=q("/transfers/statistics",3e4),{data:i,refetch:a}=q("/transfers/active",2e3),{data:o,loading:c,error:d,refetch:j}=q(`/transfers?limit=50${e?`&status=${e}`:""}${r?`&aeTitle=${r}`:""}`,3e4),[h,f]=x.useState(null),[m,v]=x.useState(null),S=async y=>{v(y);try{await ve(`/transfers/${y}/retry`,{}),j(),a()}catch(E){alert("Failed to retry: "+(E instanceof Error?E.message:"Unknown error"))}finally{v(null)}},w=y=>y<1024?y+" B":y<1024*1024?(y/1024).toFixed(1)+" KB":y<1024*1024*1024?(y/(1024*1024)).toFixed(1)+" MB":(y/(1024*1024*1024)).toFixed(2)+" GB",g=y=>y<1e3?y+"ms":y<6e4?(y/1e3).toFixed(1)+"s":Math.round(y/6e4)+"m "+Math.round(y%6e4/1e3)+"s",p=y=>{switch(y){case"COMPLETED":return"var(--success-color)";case"FAILED":return"var(--danger-color)";case"PARTIAL":return"var(--warning-color)";case"FORWARDING":case"PROCESSING":return"var(--secondary-color)";default:return"inherit"}};return c?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):d?t.jsxs("div",{className:"error-message",children:["Failed to load transfers: ",d]}):t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Transfer Statistics"})}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(s==null?void 0:s.totalTransfers)||0}),t.jsx("div",{className:"stat-label",children:"Total"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:"var(--success-color)"},children:(s==null?void 0:s.successfulTransfers)||0}),t.jsx("div",{className:"stat-label",children:"Successful"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:"var(--danger-color)"},children:(s==null?void 0:s.failedTransfers)||0}),t.jsx("div",{className:"stat-label",children:"Failed"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",style:{color:"var(--warning-color)"},children:(i==null?void 0:i.count)||0}),t.jsx("div",{className:"stat-label",children:"Active"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsxs("div",{className:"stat-value",children:[((u=s==null?void 0:s.successRate)==null?void 0:u.toFixed(1))||0,"%"]}),t.jsx("div",{className:"stat-label",children:"Success Rate"})]})]})]}),i&&i.count>0&&t.jsxs("div",{className:"card",style:{borderLeft:"4px solid var(--warning-color)"},children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Active Transfers (",i.count,")"]}),t.jsx("span",{style:{color:"var(--text-light)",fontSize:"0.875rem"},children:"Auto-refreshing every 2s"})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"AE Title"}),t.jsx("th",{children:"Study UID"}),t.jsx("th",{children:"Progress"}),t.jsx("th",{children:"Files"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Started"})]})}),t.jsx("tbody",{children:i.transfers.map(y=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:y.aeTitle})}),t.jsx("td",{children:t.jsxs("code",{style:{fontSize:"0.75rem"},children:[y.studyUid.substring(0,30),"..."]})}),t.jsx("td",{style:{minWidth:"150px"},children:t.jsxs("div",{style:{background:"var(--border-color)",borderRadius:"4px",height:"20px",overflow:"hidden",position:"relative"},children:[t.jsx("div",{style:{background:"linear-gradient(90deg, var(--secondary-color), var(--success-color))",height:"100%",width:`${y.progressPercent}%`,transition:"width 0.3s ease-in-out",borderRadius:"4px"}}),t.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.75rem",color:y.progressPercent>50?"white":"var(--text-color)"},children:[(y.progressPercent??0).toFixed(1),"%"]})]})}),t.jsxs("td",{children:[y.filesProcessed," / ",y.fileCount]}),t.jsx("td",{children:t.jsx("span",{style:{color:p(y.status)},children:y.status})}),t.jsx("td",{children:new Date(y.receivedAt).toLocaleTimeString()})]},y.transferId))})]})})]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Transfer History"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>j(),children:"Refresh"})]}),t.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem"},children:[t.jsx("div",{className:"form-group",style:{flex:1,marginBottom:0},children:t.jsxs("select",{className:"form-select",value:e,onChange:y=>n(y.target.value),children:[t.jsx("option",{value:"",children:"All Statuses"}),t.jsx("option",{value:"COMPLETED",children:"Completed"}),t.jsx("option",{value:"FAILED",children:"Failed"}),t.jsx("option",{value:"PARTIAL",children:"Partial"})]})}),t.jsx("div",{className:"form-group",style:{flex:1,marginBottom:0},children:t.jsx("input",{type:"text",className:"form-input",placeholder:"Filter by AE Title",value:r,onChange:y=>l(y.target.value)})})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"AE Title"}),t.jsx("th",{children:"Study UID"}),t.jsx("th",{children:"Files"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Duration"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Received"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[o==null?void 0:o.transfers.map(y=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:y.aeTitle})}),t.jsx("td",{children:t.jsxs("code",{style:{fontSize:"0.75rem"},children:[y.studyUid.substring(0,20),"..."]})}),t.jsx("td",{children:y.fileCount}),t.jsx("td",{children:w(y.totalSize)}),t.jsx("td",{children:g(y.durationMs)}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${y.status==="COMPLETED"?"up":y.status==="FAILED"?"down":"degraded"}`,children:y.status})}),t.jsx("td",{children:new Date(y.receivedAt).toLocaleString()}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>f(y),children:"Details"}),y.status==="FAILED"&&t.jsx("button",{className:"btn btn-primary",onClick:()=>S(y.transferId),disabled:m===y.transferId,children:m===y.transferId?"Retrying...":"Retry"})]})})]},y.transferId)),(!(o!=null&&o.transfers)||o.transfers.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:8,style:{textAlign:"center",color:"var(--text-light)"},children:"No transfers found"})})]})]})}),o&&o.total>o.limit&&t.jsxs("div",{style:{marginTop:"1rem",textAlign:"center",color:"var(--text-light)"},children:["Showing ",o.transfers.length," of ",o.total," transfers"]})]}),h&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Transfer Details"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>f(null),children:"Close"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Transfer ID:"}),t.jsx("br",{}),h.transferId]}),t.jsxs("div",{children:[t.jsx("strong",{children:"AE Title:"}),t.jsx("br",{}),h.aeTitle]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Calling AE:"}),t.jsx("br",{}),h.callingAeTitle]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Status:"}),t.jsx("br",{}),t.jsx("span",{style:{color:p(h.status)},children:h.status})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Files:"}),t.jsx("br",{}),h.fileCount]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Size:"}),t.jsx("br",{}),w(h.totalSize)]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Duration:"}),t.jsx("br",{}),g(h.durationMs)]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Received:"}),t.jsx("br",{}),new Date(h.receivedAt).toLocaleString()]})]}),t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsx("strong",{children:"Study UID:"}),t.jsx("code",{style:{display:"block",marginTop:"0.25rem",fontSize:"0.875rem",wordBreak:"break-all"},children:h.studyUid})]}),h.errorMessage&&t.jsxs("div",{className:"error-message",children:[t.jsx("strong",{children:"Error:"})," ",h.errorMessage]}),t.jsx("h3",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:"Destination Results"}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Destination"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Files"}),t.jsx("th",{children:"Duration"}),t.jsx("th",{children:"Message"})]})}),t.jsx("tbody",{children:h.destinations.map((y,E)=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:y.destination})}),t.jsx("td",{children:t.jsx("span",{className:`status-badge status-${y.status==="SUCCESS"?"up":y.status==="FAILED"?"down":"degraded"}`,children:y.status})}),t.jsx("td",{children:y.filesTransferred}),t.jsx("td",{children:g(y.durationMs)}),t.jsx("td",{children:y.message||"-"})]},E))})]})})]})]})}function Zm(){const[e,n]=x.useState(""),[r,l]=x.useState(""),[s,i]=x.useState(!0),[a,o]=x.useState(!1),[c,d]=x.useState(!1),[j,h]=x.useState(null),[f,m]=x.useState(!1),[v,S]=x.useState(null),{data:w,loading:g}=q("/import/routes",6e4),{data:p,loading:u,refetch:y}=q("/import/jobs",2e3);x.useEffect(()=>{w&&w.length>0&&!r&&l(w[0].aeTitle)},[w,r]);const E=async()=>{if(!e.trim()){S("Please enter a directory path");return}d(!0),S(null),h(null);try{const R=await Ys("/import/scan",{method:"POST",body:JSON.stringify({path:e,recursive:s})});h(R)}catch(R){S(R.message||"Failed to scan directory")}finally{d(!1)}},I=async()=>{if(!e.trim()||!r){S("Please enter a directory path and select a route");return}m(!0),S(null);try{await Ys("/import/start",{method:"POST",body:JSON.stringify({path:e,route:r,recursive:s,moveFiles:a})}),h(null),y()}catch(R){S(R.message||"Failed to start import")}finally{m(!1)}},_=async R=>{try{await Ys(`/import/jobs/${R}`,{method:"DELETE"}),y()}catch(ne){S(ne.message||"Failed to cancel job")}},z=R=>{if(R===0)return"0 B";const ne=1024,K=["B","KB","MB","GB"],Z=Math.floor(Math.log(R)/Math.log(ne));return parseFloat((R/Math.pow(ne,Z)).toFixed(1))+" "+K[Z]},D=R=>R<1e3?`${R}ms`:R<6e4?`${(R/1e3).toFixed(1)}s`:`${Math.floor(R/6e4)}m ${Math.floor(R%6e4/1e3)}s`,C=R=>`status-badge ${{pending:"status-pending",scanning:"status-processing",processing:"status-processing",completed:"status-up",failed:"status-down",cancelled:"status-unavailable"}[R]||"status-pending"}`;return t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Import DICOM Files from Disk"})}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Directory Path"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("input",{type:"text",value:e,onChange:R=>n(R.target.value),placeholder:"/path/to/dicom/files",style:{flex:1,padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",fontSize:"14px"}}),t.jsx("button",{onClick:E,disabled:c||!e.trim(),className:"btn btn-secondary",children:c?"Scanning...":"Scan"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500},children:"Target Route"}),t.jsx("select",{value:r,onChange:R=>l(R.target.value),disabled:g,style:{width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)",borderRadius:"4px",fontSize:"14px"},children:w==null?void 0:w.map(R=>t.jsxs("option",{value:R.aeTitle,children:[R.aeTitle," - Port ",R.port," (",R.destinationCount," destinations)"]},R.aeTitle))})]}),t.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:s,onChange:R=>i(R.target.checked)}),"Scan subdirectories recursively"]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:a,onChange:R=>o(R.target.checked)}),"Move files (instead of copy)"]})]}),v&&t.jsx("div",{className:"error-message",children:v}),j&&t.jsxs("div",{style:{marginTop:"1rem"},children:[t.jsxs("h3",{style:{marginBottom:"1rem"},children:["Found ",j.totalFiles," files in ",j.studies.length," studies"]}),t.jsx("div",{className:"table-container",style:{maxHeight:"300px",overflowY:"auto"},children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Study UID"}),t.jsx("th",{children:"Patient"}),t.jsx("th",{children:"Date"}),t.jsx("th",{children:"Modality"}),t.jsx("th",{children:"Files"}),t.jsx("th",{children:"Size"})]})}),t.jsx("tbody",{children:j.studies.map(R=>t.jsxs("tr",{children:[t.jsx("td",{style:{fontFamily:"monospace",fontSize:"12px"},children:R.studyUid.length>30?"..."+R.studyUid.slice(-27):R.studyUid}),t.jsx("td",{children:R.patientId||"-"}),t.jsx("td",{children:R.studyDate||"-"}),t.jsx("td",{children:R.modality||"-"}),t.jsx("td",{children:R.fileCount}),t.jsx("td",{children:z(R.totalSize)})]},R.studyUid))})]})}),t.jsx("div",{style:{marginTop:"1rem",textAlign:"right"},children:t.jsx("button",{onClick:I,disabled:f,className:"btn btn-primary",children:f?"Starting Import...":`Import ${j.studies.length} Studies`})})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Import Jobs"}),t.jsx("button",{onClick:()=>y(),className:"btn btn-secondary btn-small",children:"Refresh"})]}),u&&t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}),!u&&(!p||p.length===0)&&t.jsx("div",{style:{textAlign:"center",color:"var(--text-light)",padding:"2rem"},children:"No active import jobs"}),p&&p.length>0&&t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Job ID"}),t.jsx("th",{children:"Path"}),t.jsx("th",{children:"Route"}),t.jsx("th",{children:"Progress"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Duration"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:p.map(R=>t.jsxs("tr",{children:[t.jsx("td",{style:{fontFamily:"monospace"},children:R.id}),t.jsx("td",{title:R.path,children:R.path.length>30?"..."+R.path.slice(-27):R.path}),t.jsx("td",{children:R.route}),t.jsx("td",{children:R.totalStudies>0?t.jsxs("div",{children:[t.jsxs("div",{style:{fontSize:"12px",marginBottom:"4px"},children:[R.processedStudies,"/",R.totalStudies," studies"]}),t.jsx("div",{style:{width:"100px",height:"6px",background:"#eee",borderRadius:"3px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${R.processedStudies/R.totalStudies*100}%`,height:"100%",background:"var(--primary-color)",transition:"width 0.3s"}})}),R.currentStudy&&t.jsxs("div",{style:{fontSize:"10px",color:"var(--text-light)",marginTop:"2px"},children:["Processing: ...",R.currentStudy.slice(-20)]})]}):"-"}),t.jsxs("td",{children:[t.jsx("span",{className:C(R.status),children:R.status}),R.status==="completed"&&t.jsxs("div",{style:{fontSize:"11px",marginTop:"4px"},children:[t.jsxs("span",{style:{color:"var(--success-color)"},children:[R.successCount," ok"]}),R.failCount>0&&t.jsxs("span",{style:{color:"var(--danger-color)",marginLeft:"8px"},children:[R.failCount," failed"]})]})]}),t.jsx("td",{children:D(R.elapsedMs)}),t.jsx("td",{children:(R.status==="processing"||R.status==="scanning")&&t.jsx("button",{onClick:()=>_(R.id),className:"btn btn-danger btn-small",children:"Cancel"})})]},R.id))})]})}),p==null?void 0:p.filter(R=>R.errors&&R.errors.length>0).map(R=>t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"#fff5f5",border:"1px solid #fed7d7",borderRadius:"4px"},children:[t.jsxs("strong",{children:["Errors from job ",R.id,":"]}),t.jsxs("ul",{style:{margin:"0.5rem 0 0 1rem",padding:0},children:[R.errors.slice(0,5).map((ne,K)=>t.jsx("li",{style:{fontSize:"13px",color:"var(--danger-color)"},children:ne},K)),R.errors.length>5&&t.jsxs("li",{style:{fontSize:"13px",color:"var(--text-light)"},children:["...and ",R.errors.length-5," more errors"]})]})]},R.id+"-errors"))]})]})}function ex(){const e=nr(),{data:n,loading:r,error:l,refetch:s}=q("/storage",3e4),[i,a]=x.useState(null),[o,c]=x.useState(null),[d,j]=x.useState(null),[h,f]=x.useState(null),[m,v]=x.useState(!1),[S,w]=x.useState(null),[g,p]=x.useState([]),[u,y]=x.useState({uploading:!1,progress:0}),[E,I]=x.useState(!1),_=x.useRef(null),{data:z,refetch:D}=q(i?`/storage/routes/${i}`:null,3e4),{data:C}=q(o?`/storage/routes/${o.route}/studies/${o.folder}?status=${o.status}`:null,3e4),{data:R}=q(d!==null?`/storage/browse?path=${encodeURIComponent(d)}`:null,3e4),ne=async(F,B,U)=>{if(confirm(`Are you sure you want to delete this study folder?

Route: ${F}
Folder: ${B}
Status: ${U}`)){f(`delete-${B}`);try{await Nt(`/storage/routes/${F}/studies/${B}?status=${U}`),D(),c(null),s()}catch(J){alert("Failed to delete: "+(J instanceof Error?J.message:"Unknown error"))}finally{f(null)}}},K=async(F,B)=>{if(confirm(`Move this study back to incoming for retry?

Route: ${F}
Folder: ${B}`)){f(`retry-${B}`);try{await ve(`/storage/routes/${F}/studies/${B}/retry`,{}),D(),c(null),s()}catch(U){alert("Failed to retry: "+(U instanceof Error?U.message:"Unknown error"))}finally{f(null)}}},Z=async(F,B)=>{if(confirm(`Move this completed study back to incoming for reprocessing?

Route: ${F}
Folder: ${B}`)){f(`reprocess-${B}`);try{await ve(`/storage/routes/${F}/studies/${B}/reprocess`,{}),D(),c(null),s()}catch(U){alert("Failed to reprocess: "+(U instanceof Error?U.message:"Unknown error"))}finally{f(null)}}},A=async(F,B,U="incoming")=>{if(confirm(`Move this study to import for processing?

Route: ${F}
Folder: ${B}

This will trigger routing to configured destinations.`)){f(`import-${B}`);try{await ve(`/storage/routes/${F}/studies/${B}/move-to-import?status=${U}`,{}),alert("Study queued for import processing"),D(),s()}catch(J){alert("Failed to move to import: "+(J instanceof Error?J.message:"Unknown error"))}finally{f(null)}}},ae=async F=>{if(confirm(`Move ALL completed studies back to incoming for reprocessing?

Route: ${F}

This will re-upload all studies to the destination.`)){f(`reprocess-all-${F}`);try{const U=await ve(`/storage/routes/${F}/reprocess-all`,{});alert(`Reprocess complete:
- Moved: ${U.moved}
- Skipped: ${U.skipped}
- Errors: ${U.errors}`),D(),s()}catch(B){alert("Failed to reprocess: "+(B instanceof Error?B.message:"Unknown error"))}finally{f(null)}}},Se=async F=>{if(confirm(`Move ALL failed studies back to incoming for retry?

Route: ${F}

This will re-attempt to upload all failed studies.`)){f(`retry-all-${F}`);try{const U=await ve(`/storage/routes/${F}/retry-all`,{});alert(`Retry all complete:
- Moved: ${U.moved}
- Skipped: ${U.skipped}
- Errors: ${U.errors}`),D(),s()}catch(B){alert("Failed to retry: "+(B instanceof Error?B.message:"Unknown error"))}finally{f(null)}}},k=async F=>{if(confirm(`Move ALL storage for route "${F}" to the deleted folder?

This includes:
- All incoming studies
- All processing studies
- All completed studies
- All failed studies

Studies will be moved to the 'deleted' folder and can be purged later.`)){f(`remove-all-${F}`);try{const U=await Nt(`/storage/routes/${F}/all`);alert(`Storage moved to deleted folder for route: ${F}

- Files moved: ${U.totalFilesMoved}
- Size: ${U.totalSizeMoved}
- Directories cleared: ${U.movedDirectories.join(", ")}`),D(),s()}catch(B){alert("Failed to remove storage: "+(B instanceof Error?B.message:"Unknown error"))}finally{f(null)}}},O=async F=>{if(!confirm(`WARNING: This will PERMANENTLY DELETE all items in the deleted folder for route "${F}"!

This action CANNOT be undone.`))return;if(prompt(`Type "PURGE ${F}" to confirm permanent deletion:`)!==`PURGE ${F}`){alert("Purge cancelled - confirmation text did not match.");return}f(`purge-${F}`);try{const J=await Nt(`/storage/routes/${F}/deleted/purge`);alert(`Deleted folder purged for route: ${F}

- Files purged: ${J.filesPurged}
- Space freed: ${J.sizePurged}`),D(),s()}catch(U){alert("Failed to purge deleted folder: "+(U instanceof Error?U.message:"Unknown error"))}finally{f(null)}},$=F=>{switch(F){case"incoming":return"var(--primary-color)";case"processing":return"var(--warning-color)";case"completed":return"var(--success-color)";case"failed":return"var(--danger-color)";case"deleted":return"#999";default:return"inherit"}},H=F=>{w(F),p([]),y({uploading:!1,progress:0}),v(!0)},V=()=>{v(!1),w(null),p([]),y({uploading:!1,progress:0})},b=x.useCallback(F=>{F.preventDefault(),F.stopPropagation(),I(!0)},[]),T=x.useCallback(F=>{F.preventDefault(),F.stopPropagation(),I(!1)},[]),G=x.useCallback(F=>{F.preventDefault(),F.stopPropagation()},[]),ce=x.useCallback(F=>{F.preventDefault(),F.stopPropagation(),I(!1);const B=F.dataTransfer.items,U=async W=>{const X=[];if(W.isFile){const Y=W,re=await new Promise((Te,Re)=>{Y.file(Te,Re)});X.push(re)}else if(W.isDirectory){const re=W.createReader(),Te=await new Promise((Re,vt)=>{re.readEntries(Re,vt)});for(const Re of Te){const vt=await U(Re);X.push(...vt)}}return X},J=[];for(let W=0;W<B.length;W++){const Y=B[W].webkitGetAsEntry();Y&&J.push(U(Y))}Promise.all(J).then(W=>{const X=W.flat();p(Y=>[...Y,...X])})},[]),N=F=>{const B=F.target.files;B&&p(U=>[...U,...Array.from(B)])},Q=F=>{p(B=>B.filter((U,J)=>J!==F))},fe=F=>F<1024?F+" B":F<1024*1024?(F/1024).toFixed(1)+" KB":F<1024*1024*1024?(F/(1024*1024)).toFixed(1)+" MB":(F/(1024*1024*1024)).toFixed(2)+" GB",ie=async()=>{if(!S||g.length===0)return;y({uploading:!0,progress:0});const F=new FormData;g.forEach(B=>{F.append("files",B)});try{const B=await fetch(`/api/storage/routes/${S}/upload`,{method:"POST",headers:{"X-Auth-Token":Gi()||""},body:F});if(!B.ok){const J=await B.json();throw new Error(J.error||`Upload failed: ${B.status}`)}const U=await B.json();y({uploading:!1,progress:100,result:U}),D(),s()}catch(B){y({uploading:!1,progress:0,error:B instanceof Error?B.message:"Upload failed"})}},de=()=>!m||!S?null:t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:V,children:t.jsxs("div",{style:{background:"white",borderRadius:"8px",padding:"1.5rem",width:"600px",maxWidth:"90vw",maxHeight:"80vh",overflow:"auto"},onClick:F=>F.stopPropagation(),children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[t.jsxs("h2",{style:{margin:0},children:["Upload to ",S]}),t.jsx("button",{onClick:V,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",padding:"0.25rem"},children:"x"})]}),u.result?t.jsxs("div",{children:[t.jsxs("div",{style:{background:"var(--success-color)",color:"white",padding:"1rem",borderRadius:"4px",marginBottom:"1rem"},children:[t.jsx("strong",{children:"Upload Complete!"}),t.jsxs("p",{style:{margin:"0.5rem 0 0"},children:[u.result.totalFiles," files uploaded to folder: ",u.result.studyFolder]})]}),t.jsx("button",{className:"btn btn-primary",onClick:V,children:"Close"})]}):u.error?t.jsxs("div",{children:[t.jsxs("div",{style:{background:"var(--danger-color)",color:"white",padding:"1rem",borderRadius:"4px",marginBottom:"1rem"},children:[t.jsx("strong",{children:"Upload Failed"}),t.jsx("p",{style:{margin:"0.5rem 0 0"},children:u.error})]}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>y({uploading:!1,progress:0}),children:"Try Again"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{onDragEnter:b,onDragLeave:T,onDragOver:G,onDrop:ce,style:{border:`2px dashed ${E?"var(--primary-color)":"#ccc"}`,borderRadius:"8px",padding:"2rem",textAlign:"center",marginBottom:"1rem",background:E?"rgba(52, 152, 219, 0.1)":"#f9f9f9",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{var F;return(F=_.current)==null?void 0:F.click()},children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.5rem"},children:E?"+":"o"}),t.jsx("p",{style:{margin:0,fontWeight:500},children:E?"Drop files here":"Drag & drop files or folders here"}),t.jsx("p",{style:{margin:"0.5rem 0 0",fontSize:"0.875rem",color:"#666"},children:"or click to select files"}),t.jsx("p",{style:{margin:"0.5rem 0 0",fontSize:"0.75rem",color:"#999"},children:"Supports: DICOM files, ZIP, TAR, TAR.GZ archives"})]}),t.jsx("input",{ref:_,type:"file",multiple:!0,style:{display:"none"},onChange:N}),g.length>0&&t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[t.jsxs("strong",{children:[g.length," file",g.length!==1?"s":""," selected"]}),t.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},onClick:()=>p([]),children:"Clear All"})]}),t.jsx("div",{style:{maxHeight:"200px",overflow:"auto",border:"1px solid #eee",borderRadius:"4px"},children:g.map((F,B)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem",borderBottom:B<g.length-1?"1px solid #eee":"none"},children:[t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:F.name}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#666"},children:fe(F.size)})]}),t.jsx("button",{onClick:()=>Q(B),style:{background:"none",border:"none",color:"var(--danger-color)",cursor:"pointer",padding:"0.25rem"},children:"x"})]},B))})]}),u.uploading&&t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsx("div",{style:{background:"#eee",borderRadius:"4px",height:"8px",overflow:"hidden"},children:t.jsx("div",{style:{background:"var(--primary-color)",height:"100%",width:"100%",animation:"progress-indeterminate 1.5s infinite ease-in-out"}})}),t.jsx("p",{style:{margin:"0.5rem 0 0",textAlign:"center",fontSize:"0.875rem"},children:"Uploading..."})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:V,disabled:u.uploading,children:"Cancel"}),t.jsx("button",{className:"btn btn-primary",onClick:ie,disabled:g.length===0||u.uploading,children:u.uploading?"Uploading...":`Upload ${g.length} file${g.length!==1?"s":""}`})]})]})]})});if(r)return t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})});if(l)return t.jsxs("div",{className:"error-message",children:["Failed to load storage: ",l]});if(d!==null)return t.jsx("div",{children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Browse Storage"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>j(null),children:"Back to Overview"})]}),R&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{marginBottom:"1rem"},children:t.jsx("nav",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:R.breadcrumbs.map((F,B)=>t.jsxs("span",{children:[B>0&&t.jsx("span",{style:{margin:"0 0.25rem"},children:"/"}),t.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>j(F.path),children:F.name})]},F.path))})}),t.jsx("div",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-light)"},children:R.absolutePath}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Modified"})]})}),t.jsxs("tbody",{children:[R.items.map(F=>t.jsxs("tr",{children:[t.jsx("td",{children:F.isDirectory?t.jsxs("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem"},onClick:()=>j(d?`${d}/${F.name}`:F.name),children:[F.name,"/"]}):t.jsx("span",{children:F.name})}),t.jsx("td",{children:F.isDirectory?"Directory":"File"}),t.jsx("td",{children:F.isDirectory?F.fileCount!==void 0?`${F.fileCount} files`:"-":F.sizeFormatted}),t.jsx("td",{children:F.modified})]},F.name)),R.items.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:4,style:{textAlign:"center",color:"var(--text-light)"},children:"Empty directory"})})]})]})})]})]})});if(o&&C)return t.jsx("div",{children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Study Details"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[o.status==="failed"&&t.jsx("button",{className:"btn btn-primary",onClick:()=>K(o.route,o.folder),disabled:h!==null,children:h===`retry-${o.folder}`?"Retrying...":"Retry"}),o.status==="completed"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>e(`/review?aeTitle=${encodeURIComponent(o.route)}&studyUid=${encodeURIComponent(o.folder)}`),children:"Compare"}),t.jsx("button",{className:"btn btn-primary",onClick:()=>Z(o.route,o.folder),disabled:h!==null,children:h===`reprocess-${o.folder}`?"Reprocessing...":"Reprocess"})]}),(o.status==="failed"||o.status==="completed")&&t.jsx("button",{className:"btn btn-danger",onClick:()=>ne(o.route,o.folder,o.status),disabled:h!==null,children:h===`delete-${o.folder}`?"Deleting...":"Delete"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>c(null),children:"Back"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Route:"}),t.jsx("br",{}),C.route]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Status:"}),t.jsx("br",{}),t.jsx("span",{style:{color:$(C.status)},children:C.status})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Files:"}),t.jsx("br",{}),C.fileCount]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Total Size:"}),t.jsx("br",{}),C.totalSize]})]}),t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsx("strong",{children:"Folder:"}),t.jsx("code",{style:{display:"block",marginTop:"0.25rem",fontSize:"0.75rem",wordBreak:"break-all"},children:C.studyFolder})]}),t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsx("strong",{children:"Path:"}),t.jsx("code",{style:{display:"block",marginTop:"0.25rem",fontSize:"0.75rem",wordBreak:"break-all"},children:C.path})]}),t.jsxs("h3",{children:["Files (",C.fileCount,")"]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Modified"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:C.files.map(F=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("code",{style:{fontSize:"0.75rem"},children:F.name})}),t.jsx("td",{children:F.sizeFormatted}),t.jsx("td",{children:F.modified}),t.jsx("td",{children:t.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},onClick:()=>{const B=`${o.route}/${o.status}/${o.folder}/${F.name}`;e(`/dicom-viewer?path=${encodeURIComponent(B)}`)},children:"Preview"})})]},F.name))})]})})]})});if(i&&z){const F=(J,W,X)=>W.exists?t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[t.jsxs("h3",{style:{color:$(X),margin:0},children:[J.charAt(0).toUpperCase()+J.slice(1)," (",W.itemCount,")"]}),X==="completed"&&W.itemCount>0&&t.jsx("button",{className:"btn btn-primary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>ae(i),disabled:h!==null,children:h===`reprocess-all-${i}`?"Reprocessing...":"Reprocess All"}),X==="failed"&&W.itemCount>0&&t.jsx("button",{className:"btn btn-primary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>Se(i),disabled:h!==null,children:h===`retry-all-${i}`?"Retrying...":"Retry All"})]}),W.items.length>0?t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Folder"}),t.jsx("th",{children:"Files"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Modified"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:W.items.filter(Y=>Y.isDirectory).map(Y=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("code",{style:{fontSize:"0.75rem"},children:Y.name.length>40?Y.name.substring(0,40)+"...":Y.name})}),t.jsx("td",{children:Y.fileCount||0}),t.jsx("td",{children:Y.totalSizeFormatted||Y.sizeFormatted}),t.jsx("td",{children:Y.modified}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>c({route:i,folder:Y.name,status:X}),children:"View"}),X==="incoming"&&t.jsx("button",{className:"btn btn-primary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>A(i,Y.name,X),disabled:h!==null,children:"Import"}),X==="failed"&&t.jsx("button",{className:"btn btn-primary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>K(i,Y.name),disabled:h!==null,children:"Retry"}),X==="completed"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>e(`/review?aeTitle=${encodeURIComponent(i)}&studyUid=${encodeURIComponent(Y.name)}`),children:"Compare"}),t.jsx("button",{className:"btn btn-primary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>Z(i,Y.name),disabled:h!==null,children:"Reprocess"})]}),(X==="failed"||X==="completed")&&t.jsx("button",{className:"btn btn-danger",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>ne(i,Y.name,X),disabled:h!==null,children:"Delete"})]})})]},Y.name))})]})}):t.jsx("div",{style:{color:"var(--text-light)",fontStyle:"italic"},children:"Empty"})]}):null,B=J=>!J||!J.exists?null:t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[t.jsxs("h3",{style:{color:"#999",margin:0},children:["Deleted (",J.itemCount,")"]}),J.itemCount>0&&t.jsx("button",{className:"btn btn-danger",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>O(i),disabled:h!==null,children:h===`purge-${i}`?"Purging...":"Purge All"})]}),J.items.length>0?t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Folder"}),t.jsx("th",{children:"Files"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Modified"})]})}),t.jsx("tbody",{children:J.items.filter(W=>W.isDirectory).map(W=>t.jsxs("tr",{style:{opacity:.7},children:[t.jsx("td",{children:t.jsx("code",{style:{fontSize:"0.75rem"},children:W.name.length>40?W.name.substring(0,40)+"...":W.name})}),t.jsx("td",{children:W.fileCount||0}),t.jsx("td",{children:W.totalSizeFormatted||W.sizeFormatted}),t.jsx("td",{children:W.modified})]},W.name))})]})}):t.jsx("div",{style:{color:"var(--text-light)",fontStyle:"italic"},children:"Empty (no deleted items)"})]}),U=J=>{if(!J.exists)return null;const W=J.items;return t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsxs("h3",{style:{color:"var(--text-light)",margin:"0 0 0.5rem 0"},children:["Logs (",J.itemCount,")"]}),W.length>0?t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Name"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Modified"})]})}),t.jsx("tbody",{children:W.map(X=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("code",{style:{fontSize:"0.75rem"},children:X.name.length>50?X.name.substring(0,50)+"...":X.name})}),t.jsx("td",{children:X.isDirectory?"Directory":"File"}),t.jsx("td",{children:X.isDirectory?`${X.fileCount||0} files`:X.sizeFormatted}),t.jsx("td",{children:X.modified})]},X.name))})]})}):t.jsx("div",{style:{color:"var(--text-light)",fontStyle:"italic"},children:"No logs"})]})};return t.jsxs(t.Fragment,{children:[t.jsx("div",{children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Route: ",i]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:()=>H(i),children:"Upload Data"}),t.jsx("button",{className:"btn btn-danger",onClick:()=>k(i),disabled:h!==null,children:h===`remove-all-${i}`?"Removing...":"Remove All"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>D(),children:"Refresh"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>a(null),children:"Back to Overview"})]})]}),t.jsxs("div",{style:{marginBottom:"1.5rem",fontSize:"0.875rem",color:"var(--text-light)"},children:["Path: ",z.path]}),F("incoming",z.incoming,"incoming"),F("processing",z.processing,"processing"),F("completed",z.completed,"completed"),F("failed",z.failed,"failed"),B(z.deleted),U(z.logs)]})}),de()]})}return t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Storage Overview"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-secondary",onClick:()=>j(""),children:"Browse Files"}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>s(),children:"Refresh"})]})]}),t.jsxs("div",{style:{marginBottom:"1.5rem",fontSize:"0.875rem",color:"var(--text-light)"},children:["Data Directory: ",n==null?void 0:n.dataDirectory]}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(n==null?void 0:n.routes.length)||0}),t.jsx("div",{className:"stat-label",children:"Routes"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(n==null?void 0:n.totalFiles)||0}),t.jsx("div",{className:"stat-label",children:"Total Files"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(n==null?void 0:n.totalSize)||"0 B"}),t.jsx("div",{className:"stat-label",children:"Total Size"})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Route Storage"})}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Route"}),t.jsx("th",{style:{color:"var(--primary-color)"},children:"Incoming"}),t.jsx("th",{style:{color:"var(--warning-color)"},children:"Processing"}),t.jsx("th",{style:{color:"var(--success-color)"},children:"Completed"}),t.jsx("th",{style:{color:"var(--danger-color)"},children:"Failed"}),t.jsx("th",{style:{color:"#999"},children:"Deleted"}),t.jsx("th",{children:"Total Size"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[n==null?void 0:n.routes.map(F=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:F.name})}),t.jsx("td",{style:{color:F.incoming>0?"var(--primary-color)":"inherit"},children:F.incoming}),t.jsx("td",{style:{color:F.processing>0?"var(--warning-color)":"inherit"},children:F.processing}),t.jsx("td",{style:{color:F.completed>0?"var(--success-color)":"inherit"},children:F.completed}),t.jsx("td",{style:{color:F.failed>0?"var(--danger-color)":"inherit"},children:F.failed}),t.jsx("td",{style:{color:F.deleted>0?"#999":"inherit"},children:F.deleted||0}),t.jsx("td",{children:F.totalSize}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>H(F.name),children:"Upload"}),t.jsx("button",{className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.875rem"},onClick:()=>a(F.name),children:"Details"})]})})]},F.name)),(!(n!=null&&n.routes)||n.routes.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:8,style:{textAlign:"center",color:"var(--text-light)"},children:"No route storage found"})})]})]})})]}),de()]})}function tx(){var g;const[e]=Xa(),n=nr(),r=e.get("path")||"",[l,s]=x.useState("image"),[i,a]=x.useState(null),[o,c]=x.useState(null),[d,j]=x.useState(!0),[h,f]=x.useState(null),[m,v]=x.useState("");x.useEffect(()=>{if(!r){f("No file path provided"),j(!1);return}return j(!0),f(null),Promise.all([yt(`/storage/dicom/header?path=${encodeURIComponent(r)}`),Ju(`/storage/dicom/image?path=${encodeURIComponent(r)}`)]).then(([p,u])=>{a(p),c(u),j(!1)}).catch(p=>{f(p instanceof Error?p.message:"Failed to load DICOM"),j(!1)}),()=>{o&&URL.revokeObjectURL(o)}},[r]);const S=()=>{n(-1)};if(d)return t.jsx("div",{children:t.jsx("div",{className:"card",children:t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})})})});if(h)return t.jsx("div",{children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"DICOM Viewer"}),t.jsx("button",{className:"btn btn-secondary",onClick:S,children:" Back"})]}),t.jsx("div",{className:"error-message",children:h})]})});if(!i)return t.jsx("div",{children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"DICOM Viewer"}),t.jsx("button",{className:"btn btn-secondary",onClick:S,children:" Back"})]}),t.jsx("p",{children:"No DICOM data available"})]})});const w=r.split("/").pop()||r;return t.jsx("div",{children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"card-title",children:"DICOM Viewer"}),t.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.875rem",color:"var(--text-light)"},children:w})]}),t.jsx("button",{className:"btn btn-secondary",onClick:S,children:" Back"})]}),t.jsxs("div",{style:{display:"flex",gap:"0",borderBottom:"1px solid var(--border-color)",marginBottom:"1.5rem"},children:[t.jsx("button",{onClick:()=>s("image"),style:{padding:"0.75rem 1.5rem",border:"none",background:l==="image"?"var(--bg-secondary)":"transparent",color:l==="image"?"var(--primary-color)":"var(--text-light)",borderBottom:l==="image"?"2px solid var(--primary-color)":"2px solid transparent",cursor:"pointer",fontWeight:l==="image"?"600":"400",fontSize:"0.9rem"},children:"Image"}),t.jsx("button",{onClick:()=>s("header"),style:{padding:"0.75rem 1.5rem",border:"none",background:l==="header"?"var(--bg-secondary)":"transparent",color:l==="header"?"var(--primary-color)":"var(--text-light)",borderBottom:l==="header"?"2px solid var(--primary-color)":"2px solid transparent",cursor:"pointer",fontWeight:l==="header"?"600":"400",fontSize:"0.9rem"},children:"Header"}),t.jsxs("button",{onClick:()=>s("tags"),style:{padding:"0.75rem 1.5rem",border:"none",background:l==="tags"?"var(--bg-secondary)":"transparent",color:l==="tags"?"var(--primary-color)":"var(--text-light)",borderBottom:l==="tags"?"2px solid var(--primary-color)":"2px solid transparent",cursor:"pointer",fontWeight:l==="tags"?"600":"400",fontSize:"0.9rem"},children:["All Tags (",i.allTags.length,")"]})]}),l==="image"&&t.jsx("div",{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"2rem"},children:[t.jsx("div",{style:{backgroundColor:"#000",borderRadius:"8px",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"500px"},children:o?t.jsx("img",{src:o,alt:"DICOM Preview",style:{maxWidth:"100%",maxHeight:"600px",objectFit:"contain"}}):t.jsx("p",{style:{color:"#666"},children:"Image not available"})}),t.jsxs("div",{children:[t.jsx("h3",{style:{marginBottom:"1rem"},children:"Image Properties"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Dimensions"})}),t.jsxs("td",{children:[i.image.columns,"  ",i.image.rows]})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Bits Allocated"})}),t.jsx("td",{children:i.image.bitsAllocated})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Bits Stored"})}),t.jsx("td",{children:i.image.bitsStored})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Photometric"})}),t.jsx("td",{children:i.image.photometricInterpretation||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Samples/Pixel"})}),t.jsx("td",{children:i.image.samplesPerPixel})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Pixel Spacing"})}),t.jsx("td",{children:((g=i.image.pixelSpacing)==null?void 0:g.join("  "))||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Slice Thickness"})}),t.jsx("td",{children:i.image.sliceThickness||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Transfer Syntax"})}),t.jsx("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:i.transferSyntaxUID||"-"})]})]})})}),t.jsx("h3",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:"Quick Info"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Patient"})}),t.jsx("td",{children:i.patient.name||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Patient ID"})}),t.jsx("td",{children:i.patient.id||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Modality"})}),t.jsx("td",{children:i.series.modality||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Study Date"})}),t.jsx("td",{children:i.study.date||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Series"})}),t.jsx("td",{children:i.series.description||"-"})]})]})})})]})]})}),l==="header"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1.5rem"},children:[t.jsxs("div",{className:"card",style:{margin:0},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--primary-color)"},children:"Patient"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Name"})}),t.jsx("td",{children:i.patient.name||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"ID"})}),t.jsx("td",{children:i.patient.id||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Birth Date"})}),t.jsx("td",{children:i.patient.birthDate||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Sex"})}),t.jsx("td",{children:i.patient.sex||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Age"})}),t.jsx("td",{children:i.patient.age||"-"})]})]})})})]}),t.jsxs("div",{className:"card",style:{margin:0},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--primary-color)"},children:"Study"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Date"})}),t.jsx("td",{children:i.study.date||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Time"})}),t.jsx("td",{children:i.study.time||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Description"})}),t.jsx("td",{children:i.study.description||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Accession #"})}),t.jsx("td",{children:i.study.accessionNumber||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Study ID"})}),t.jsx("td",{children:i.study.id||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Study UID"})}),t.jsx("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:i.study.instanceUID||"-"})]})]})})})]}),t.jsxs("div",{className:"card",style:{margin:0},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--primary-color)"},children:"Series"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Number"})}),t.jsx("td",{children:i.series.number||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Modality"})}),t.jsx("td",{children:i.series.modality||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Description"})}),t.jsx("td",{children:i.series.description||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Body Part"})}),t.jsx("td",{children:i.series.bodyPart||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Series UID"})}),t.jsx("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:i.series.instanceUID||"-"})]})]})})})]}),t.jsxs("div",{className:"card",style:{margin:0},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--primary-color)"},children:"Equipment"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Manufacturer"})}),t.jsx("td",{children:i.equipment.manufacturer||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Model"})}),t.jsx("td",{children:i.equipment.modelName||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Institution"})}),t.jsx("td",{children:i.equipment.institutionName||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Station"})}),t.jsx("td",{children:i.equipment.stationName||"-"})]})]})})})]}),t.jsxs("div",{className:"card",style:{margin:0},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--primary-color)"},children:"Instance"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Instance #"})}),t.jsx("td",{children:i.instance.instanceNumber||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"SOP Instance UID"})}),t.jsx("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:i.instance.sopInstanceUID||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"SOP Class UID"})}),t.jsx("td",{style:{fontSize:"0.75rem",wordBreak:"break-all"},children:i.instance.sopClassUID||"-"})]})]})})})]}),t.jsxs("div",{className:"card",style:{margin:0},children:[t.jsx("h3",{style:{marginBottom:"1rem",color:"var(--primary-color)"},children:"Image"}),t.jsx("div",{className:"table-container",children:t.jsx("table",{children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Dimensions"})}),t.jsxs("td",{children:[i.image.columns,"  ",i.image.rows]})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Bits Stored"})}),t.jsx("td",{children:i.image.bitsStored})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Photometric"})}),t.jsx("td",{children:i.image.photometricInterpretation||"-"})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Samples/Pixel"})}),t.jsx("td",{children:i.image.samplesPerPixel})]}),t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("strong",{children:"Slice Thickness"})}),t.jsx("td",{children:i.image.sliceThickness||"-"})]})]})})})]})]}),l==="tags"&&t.jsxs("div",{children:[t.jsx("div",{style:{marginBottom:"1rem"},children:t.jsx("input",{type:"text",placeholder:"Filter tags by tag, keyword, or value...",value:m,onChange:p=>v(p.target.value),style:{padding:"0.5rem 1rem",width:"400px",maxWidth:"100%"}})}),t.jsx("div",{className:"table-container",style:{maxHeight:"600px",overflow:"auto"},children:t.jsxs("table",{children:[t.jsx("thead",{style:{position:"sticky",top:0,background:"var(--bg-secondary)"},children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"120px"},children:"Tag"}),t.jsx("th",{style:{width:"60px"},children:"VR"}),t.jsx("th",{style:{width:"200px"},children:"Keyword"}),t.jsx("th",{children:"Value"})]})}),t.jsx("tbody",{children:i.allTags.filter(p=>!m||p.tag.toLowerCase().includes(m.toLowerCase())||p.keyword.toLowerCase().includes(m.toLowerCase())||p.value.toLowerCase().includes(m.toLowerCase())).map((p,u)=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("code",{style:{color:"var(--primary-color)"},children:p.tag})}),t.jsx("td",{children:p.vr}),t.jsx("td",{children:p.keyword}),t.jsx("td",{style:{maxWidth:"500px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p.value})]},u))})]})})]})]})})}function nx(){const{data:e,loading:n,error:r,refetch:l}=q("/logs",3e4),[s,i]=x.useState(null),[a,o]=x.useState(null),[c,d]=x.useState(0),[j,h]=x.useState(!1),[f,m]=x.useState(100),v=x.useRef(null),S=x.useRef(null);x.useEffect(()=>{s?w(0):(o(null),d(0))},[s,f]),x.useEffect(()=>(j&&s&&(v.current&&(v.current.scrollTop=v.current.scrollHeight),S.current=window.setInterval(()=>{g()},2e3)),()=>{S.current&&clearInterval(S.current)}),[j,s,c]);const w=async I=>{if(s)try{const _={"Content-Type":"application/json"},z=Gi();z&&(_["X-Auth-Token"]=z);const D=await fetch(`/api/logs/tail/${s.route}/${s.file}?lines=${f}&offset=${I}`,{headers:_});if(D.ok){const C=await D.json();o(C),d(C.offset),v.current&&(v.current.scrollTop=v.current.scrollHeight)}}catch(_){console.error("Failed to fetch log tail:",_)}},g=async()=>{if(!(!s||c===0))try{const I={"Content-Type":"application/json"},_=Gi();_&&(I["X-Auth-Token"]=_);const z=await fetch(`/api/logs/tail/${s.route}/${s.file}?lines=${f}&offset=${c}`,{headers:I});if(z.ok){const D=await z.json();D.lines&&D.lines.length>0&&(o(C=>({...D,lines:C?[...C.lines,...D.lines]:D.lines})),d(D.offset),v.current&&(v.current.scrollTop=v.current.scrollHeight))}}catch(I){console.error("Failed to fetch log updates:",I)}},p=(I,_)=>{i({route:I,file:_}),h(!1)},u=()=>{s&&w(0)},y=()=>{h(!j)};if(n&&!e)return t.jsx("div",{className:"loading",children:"Loading logs..."});if(r)return t.jsxs("div",{className:"error",children:["Error: ",r]});const E=(e==null?void 0:e.logs.reduce((I,_)=>(I[_.route]||(I[_.route]=[]),I[_.route].push(_),I),{}))||{};return t.jsxs("div",{className:"logs-page",children:[t.jsxs("div",{className:"page-header",children:[t.jsx("h2",{children:"Log Viewer"}),t.jsx("button",{onClick:()=>l(),className:"btn btn-secondary",children:"Refresh List"})]}),t.jsxs("div",{className:"logs-layout",children:[t.jsxs("div",{className:"logs-sidebar",children:[t.jsxs("h3",{children:["Log Files (",(e==null?void 0:e.count)||0,")"]}),Object.keys(E).length===0?t.jsx("p",{className:"empty-message",children:"No log files found"}):Object.entries(E).map(([I,_])=>t.jsxs("div",{className:"log-route-section",children:[t.jsx("h4",{children:I}),t.jsx("ul",{className:"log-file-list",children:_.map(z=>t.jsxs("li",{className:(s==null?void 0:s.route)===z.route&&(s==null?void 0:s.file)===z.name?"selected":"",onClick:()=>p(z.route,z.name),children:[t.jsx("span",{className:"log-name",children:z.name}),t.jsx("span",{className:"log-meta",children:z.sizeFormatted})]},z.path))})]},I))]}),t.jsx("div",{className:"logs-content",children:s?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"log-header",children:[t.jsxs("span",{className:"log-title",children:[s.route," / ",s.file,a&&t.jsxs("span",{className:"log-size",children:[" (",a.size," bytes)"]})]}),t.jsxs("div",{className:"log-controls",children:[t.jsxs("label",{children:["Lines:",t.jsxs("select",{value:f,onChange:I=>m(Number(I.target.value)),children:[t.jsx("option",{value:50,children:"50"}),t.jsx("option",{value:100,children:"100"}),t.jsx("option",{value:200,children:"200"}),t.jsx("option",{value:500,children:"500"}),t.jsx("option",{value:1e3,children:"1000"})]})]}),t.jsx("button",{onClick:y,className:`btn ${j?"btn-warning":"btn-secondary"}`,children:j?"Stop Follow":"Follow"}),t.jsx("button",{onClick:u,className:"btn btn-primary",children:"Refresh"})]})]}),t.jsx("div",{className:"log-viewer",ref:v,children:(a==null?void 0:a.lines.map((I,_)=>t.jsxs("div",{className:"log-line",children:[t.jsx("span",{className:"line-number",children:_+1}),t.jsx("span",{className:"line-content",children:I})]},_)))||t.jsx("div",{className:"loading",children:"Loading log content..."})}),j&&t.jsx("div",{className:"follow-indicator",children:"Auto-refreshing every 2 seconds..."})]}):t.jsx("div",{className:"no-selection",children:t.jsx("p",{children:"Select a log file from the sidebar to view its contents"})})})]}),t.jsx("style",{children:`
        .logs-page {
          padding: 1rem;
        }

        .page-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1rem;
        }

        .page-header h2 {
          margin: 0;
        }

        .logs-layout {
          display: flex;
          gap: 1rem;
          height: calc(100vh - 200px);
        }

        .logs-sidebar {
          width: 300px;
          flex-shrink: 0;
          background: var(--card-bg);
          border-radius: 8px;
          padding: 1rem;
          overflow-y: auto;
        }

        .logs-sidebar h3 {
          margin: 0 0 1rem 0;
          font-size: 1rem;
          color: var(--text-color);
        }

        .log-route-section {
          margin-bottom: 1rem;
        }

        .log-route-section h4 {
          margin: 0 0 0.5rem 0;
          font-size: 0.9rem;
          color: var(--text-light);
          padding: 0.25rem 0.5rem;
          background: var(--bg-color);
          border-radius: 4px;
        }

        .log-file-list {
          list-style: none;
          padding: 0;
          margin: 0;
        }

        .log-file-list li {
          padding: 0.5rem;
          cursor: pointer;
          border-radius: 4px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.85rem;
        }

        .log-file-list li:hover {
          background: var(--hover-bg);
        }

        .log-file-list li.selected {
          background: var(--secondary-color);
          color: white;
        }

        .log-name {
          font-family: monospace;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .log-meta {
          font-size: 0.75rem;
          opacity: 0.8;
          flex-shrink: 0;
          margin-left: 0.5rem;
        }

        .logs-content {
          flex: 1;
          background: var(--card-bg);
          border-radius: 8px;
          display: flex;
          flex-direction: column;
          overflow: hidden;
        }

        .no-selection {
          display: flex;
          align-items: center;
          justify-content: center;
          height: 100%;
          color: var(--text-light);
        }

        .log-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.75rem 1rem;
          background: #343a40;
          color: white;
          border-radius: 8px 8px 0 0;
        }

        .log-title {
          font-family: monospace;
          font-weight: 500;
        }

        .log-size {
          font-size: 0.85rem;
          opacity: 0.8;
        }

        .log-controls {
          display: flex;
          gap: 0.5rem;
          align-items: center;
        }

        .log-controls label {
          display: flex;
          align-items: center;
          gap: 0.25rem;
          font-size: 0.85rem;
        }

        .log-controls select {
          padding: 0.25rem 0.5rem;
          border-radius: 4px;
          border: 1px solid #495057;
          background: #495057;
          color: white;
        }

        .log-viewer {
          flex: 1;
          overflow-y: auto;
          background: #1e1e1e;
          padding: 0.5rem;
          font-family: 'Monaco', 'Consolas', 'Courier New', monospace;
          font-size: 0.8rem;
          color: #d4d4d4;
        }

        .log-line {
          display: flex;
          line-height: 1.4;
        }

        .line-number {
          width: 50px;
          flex-shrink: 0;
          color: #858585;
          text-align: right;
          padding-right: 1rem;
          user-select: none;
        }

        .line-content {
          white-space: pre-wrap;
          word-break: break-all;
        }

        .follow-indicator {
          padding: 0.5rem 1rem;
          background: #ffc107;
          color: #212529;
          font-size: 0.85rem;
          text-align: center;
        }

        .empty-message {
          color: var(--text-light);
          font-style: italic;
        }

        .btn {
          padding: 0.375rem 0.75rem;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 0.875rem;
        }

        .btn-primary {
          background: var(--secondary-color);
          color: white;
        }

        .btn-secondary {
          background: #6c757d;
          color: white;
        }

        .btn-warning {
          background: #ffc107;
          color: #212529;
        }

        .btn:hover {
          opacity: 0.9;
        }

        .loading {
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 2rem;
          color: var(--text-light);
        }

        .error {
          color: var(--danger-color);
          padding: 1rem;
        }
      `})]})}function rx(){var w,g,p,u,y,E,I,_,z,D,C,R,ne,K,Z,A,ae,Se,k,O,$,H,V,b,T,G,ce;const{data:e,loading:n,error:r,refetch:l}=q("/config"),[s,i]=x.useState(!1),[a,o]=x.useState(!1),[c,d]=x.useState(null),[j,h]=x.useState(!1),[f,m]=x.useState({});x.useEffect(()=>{e&&m({dataDirectory:e.dataDirectory,scriptsDirectory:e.scriptsDirectory,logLevel:e.logLevel,receiver:{...e.receiver},resilience:{...e.resilience},notifications:{...e.notifications}})},[e]);const v=async()=>{o(!0),d(null),h(!1);try{await xn("/config",f),h(!0),i(!1),l(),setTimeout(()=>h(!1),3e3)}catch(N){d(N instanceof Error?N.message:"Failed to save")}finally{o(!1)}},S=()=>{e&&m({dataDirectory:e.dataDirectory,scriptsDirectory:e.scriptsDirectory,logLevel:e.logLevel,receiver:{...e.receiver},resilience:{...e.resilience},notifications:{...e.notifications}}),i(!1),d(null)};return n?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):r?t.jsxs("div",{className:"error-message",children:["Failed to load configuration: ",r]}):t.jsxs("div",{children:[j&&t.jsx("div",{style:{background:"#d4edda",border:"1px solid #c3e6cb",color:"#155724",padding:"0.75rem 1rem",borderRadius:"4px",marginBottom:"1rem"},children:"Configuration saved successfully!"}),c&&t.jsxs("div",{style:{background:"#f8d7da",border:"1px solid #f5c6cb",color:"#721c24",padding:"0.75rem 1rem",borderRadius:"4px",marginBottom:"1rem"},children:["Error: ",c]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"General Settings"}),s?t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:v,disabled:a,children:a?"Saving...":"Save"}),t.jsx("button",{className:"btn btn-secondary",onClick:S,disabled:a,children:"Cancel"})]}):t.jsx("button",{className:"btn btn-primary",onClick:()=>i(!0),children:"Edit"})]}),t.jsxs("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Config File"}),t.jsx("input",{type:"text",value:(e==null?void 0:e.configFile)||"Not set",disabled:!0,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Admin Port"}),t.jsx("input",{type:"text",value:(e==null?void 0:e.adminPort)||"",disabled:!0,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:"#f5f5f5"}}),t.jsx("small",{style:{color:"#666"},children:"Restart required to change"})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Data Directory"}),t.jsx("input",{type:"text",value:f.dataDirectory||"",onChange:N=>m({...f,dataDirectory:N.target.value}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Scripts Directory"}),t.jsx("input",{type:"text",value:f.scriptsDirectory||"",onChange:N=>m({...f,scriptsDirectory:N.target.value}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Log Level"}),t.jsxs("select",{value:f.logLevel||"INFO",onChange:N=>m({...f,logLevel:N.target.value}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"},children:[t.jsx("option",{value:"TRACE",children:"TRACE"}),t.jsx("option",{value:"DEBUG",children:"DEBUG"}),t.jsx("option",{value:"INFO",children:"INFO"}),t.jsx("option",{value:"WARN",children:"WARN"}),t.jsx("option",{value:"ERROR",children:"ERROR"})]})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Resilience Settings"})}),t.jsxs("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Health Check Interval (sec)"}),t.jsx("input",{type:"number",value:((w=f.resilience)==null?void 0:w.healthCheckInterval)||60,onChange:N=>m({...f,resilience:{...f.resilience,healthCheckInterval:parseInt(N.target.value)}}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Max Retries"}),t.jsx("input",{type:"number",value:((g=f.resilience)==null?void 0:g.maxRetries)||10,onChange:N=>m({...f,resilience:{...f.resilience,maxRetries:parseInt(N.target.value)}}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Retry Delay (sec)"}),t.jsx("input",{type:"number",value:((p=f.resilience)==null?void 0:p.retryDelay)||300,onChange:N=>m({...f,resilience:{...f.resilience,retryDelay:parseInt(N.target.value)}}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Retention Days"}),t.jsx("input",{type:"number",value:((u=f.resilience)==null?void 0:u.retentionDays)||30,onChange:N=>m({...f,resilience:{...f.resilience,retentionDays:parseInt(N.target.value)}}),disabled:!s,style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Email Notifications"})}),t.jsx("div",{style:{marginBottom:"1rem"},children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:s?"pointer":"default"},children:[t.jsx("input",{type:"checkbox",checked:((y=f.notifications)==null?void 0:y.enabled)||!1,onChange:N=>m({...f,notifications:{...f.notifications,enabled:N.target.checked}}),disabled:!s}),t.jsx("span",{style:{fontWeight:500},children:"Enable Email Notifications"})]})}),t.jsxs("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",opacity:(E=f.notifications)!=null&&E.enabled?1:.6},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"SMTP Server"}),t.jsx("input",{type:"text",value:((I=f.notifications)==null?void 0:I.smtpServer)||"",onChange:N=>m({...f,notifications:{...f.notifications,smtpServer:N.target.value}}),disabled:!s||!((_=f.notifications)!=null&&_.enabled),style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"SMTP Port"}),t.jsx("input",{type:"number",value:((z=f.notifications)==null?void 0:z.smtpPort)||25,onChange:N=>m({...f,notifications:{...f.notifications,smtpPort:parseInt(N.target.value)}}),disabled:!s||!((D=f.notifications)!=null&&D.enabled),style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"SMTP Username"}),t.jsx("input",{type:"text",value:((C=f.notifications)==null?void 0:C.smtpUsername)||"",onChange:N=>m({...f,notifications:{...f.notifications,smtpUsername:N.target.value}}),disabled:!s||!((R=f.notifications)!=null&&R.enabled),style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"From Address"}),t.jsx("input",{type:"email",value:((ne=f.notifications)==null?void 0:ne.fromAddress)||"",onChange:N=>m({...f,notifications:{...f.notifications,fromAddress:N.target.value}}),disabled:!s||!((K=f.notifications)!=null&&K.enabled),style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontWeight:500},children:"Admin Email"}),t.jsx("input",{type:"email",value:((Z=f.notifications)==null?void 0:Z.adminEmail)||"",onChange:N=>m({...f,notifications:{...f.notifications,adminEmail:N.target.value}}),disabled:!s||!((A=f.notifications)!=null&&A.enabled),style:{width:"100%",padding:"0.5rem",border:"1px solid #ddd",borderRadius:"4px",background:s?"#fff":"#f5f5f5"}})]}),t.jsx("div",{children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:((ae=f.notifications)==null?void 0:ae.smtpUseTls)||!1,onChange:N=>m({...f,notifications:{...f.notifications,smtpUseTls:N.target.checked}}),disabled:!s||!((Se=f.notifications)!=null&&Se.enabled)}),t.jsx("span",{children:"Use TLS"})]})})]}),t.jsx("h3",{style:{marginTop:"1.5rem",marginBottom:"1rem"},children:"Notification Events"}),t.jsxs("div",{style:{display:"grid",gap:"0.5rem",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",opacity:(k=f.notifications)!=null&&k.enabled?1:.6},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:((O=f.notifications)==null?void 0:O.notifyOnDestinationDown)||!1,onChange:N=>m({...f,notifications:{...f.notifications,notifyOnDestinationDown:N.target.checked}}),disabled:!s||!(($=f.notifications)!=null&&$.enabled)}),t.jsx("span",{children:"Destination Down"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:((H=f.notifications)==null?void 0:H.notifyOnDestinationRecovered)||!1,onChange:N=>m({...f,notifications:{...f.notifications,notifyOnDestinationRecovered:N.target.checked}}),disabled:!s||!((V=f.notifications)!=null&&V.enabled)}),t.jsx("span",{children:"Destination Recovered"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:((b=f.notifications)==null?void 0:b.notifyOnForwardFailure)||!1,onChange:N=>m({...f,notifications:{...f.notifications,notifyOnForwardFailure:N.target.checked}}),disabled:!s||!((T=f.notifications)!=null&&T.enabled)}),t.jsx("span",{children:"Forward Failure"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("input",{type:"checkbox",checked:((G=f.notifications)==null?void 0:G.notifyOnDailySummary)||!1,onChange:N=>m({...f,notifications:{...f.notifications,notifyOnDailySummary:N.target.checked}}),disabled:!s||!((ce=f.notifications)!=null&&ce.enabled)}),t.jsx("span",{children:"Daily Summary"})]})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Configuration Summary"})}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(e==null?void 0:e.routeCount)||0}),t.jsx("div",{className:"stat-label",children:"Routes"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(e==null?void 0:e.destinations.xnat)||0}),t.jsx("div",{className:"stat-label",children:"XNAT Destinations"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(e==null?void 0:e.destinations.dicom)||0}),t.jsx("div",{className:"stat-label",children:"DICOM Destinations"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(e==null?void 0:e.destinations.file)||0}),t.jsx("div",{className:"stat-label",children:"File Destinations"})]})]})]})]})}function lx({onLogin:e}){const[n,r]=x.useState(""),[l,s]=x.useState(""),[i,a]=x.useState(null),[o,c]=x.useState(!1),d=async j=>{j.preventDefault(),a(null),c(!0);try{const h=await ve("/auth/login",{username:n,password:l});h.success&&h.token&&e(h.token,h.username)}catch(h){a(h instanceof Error?h.message:"Login failed")}finally{c(!1)}};return t.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:t.jsxs("div",{style:{background:"white",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",padding:"2rem",width:"100%",maxWidth:"400px"},children:[t.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[t.jsx("h1",{style:{margin:0,color:"#333",fontSize:"1.5rem"},children:"XNAT DICOM Router"}),t.jsx("p",{style:{margin:"0.5rem 0 0",color:"#666",fontSize:"0.9rem"},children:"Admin Console"})]}),t.jsxs("form",{onSubmit:d,children:[i&&t.jsx("div",{style:{background:"#f8d7da",border:"1px solid #f5c6cb",color:"#721c24",padding:"0.75rem 1rem",borderRadius:"4px",marginBottom:"1rem",fontSize:"0.875rem"},children:i}),t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,color:"#333"},children:"Username"}),t.jsx("input",{type:"text",value:n,onChange:j=>r(j.target.value),required:!0,autoFocus:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,color:"#333"},children:"Password"}),t.jsx("input",{type:"password",value:l,onChange:j=>s(j.target.value),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #ddd",borderRadius:"4px",fontSize:"1rem",boxSizing:"border-box"}})]}),t.jsx("button",{type:"submit",disabled:o,style:{width:"100%",padding:"0.75rem",background:o?"#999":"#667eea",color:"white",border:"none",borderRadius:"4px",fontSize:"1rem",fontWeight:500,cursor:o?"not-allowed":"pointer"},children:o?"Signing in...":"Sign In"})]}),t.jsx("div",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.8rem",color:"#999"},children:"Version 2.0.0  2025 XNATWorks"})]})})}function sx(){const{data:e,loading:n,error:r}=q("/ocr/status"),[l,s]=x.useState(""),[i,a]=x.useState(""),[o,c]=x.useState(10),[d,j]=x.useState(!1),[h,f]=x.useState(null),[m,v]=x.useState(null),[S,w]=x.useState("file"),[g,p]=x.useState(!1),u=async()=>{if(!l.trim()){alert("Please enter a file path");return}j(!0),f(null);try{const I=l.toLowerCase().endsWith(".dcm")||!l.includes(".")?"/ocr/scan":"/ocr/scan-image",_=await ve(I,{path:l});f(_)}catch(E){alert("Scan failed: "+(E instanceof Error?E.message:"Unknown error"))}finally{j(!1)}},y=async()=>{if(!i.trim()){alert("Please enter a directory path");return}j(!0),v(null);try{const E=await ve("/ocr/scan-directory",{path:i,maxFiles:o});v(E)}catch(E){alert("Scan failed: "+(E instanceof Error?E.message:"Unknown error"))}finally{j(!1)}};return n?t.jsx("div",{className:"loading",children:t.jsx("div",{className:"spinner"})}):t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"OCR PHI Detection"}),t.jsx("span",{className:`status-badge ${e!=null&&e.available?"status-active":"status-inactive"}`,children:e!=null&&e.available?"Available":"Unavailable"})]}),r&&t.jsxs("div",{className:"error-message",style:{marginBottom:"1rem"},children:["Failed to check OCR status: ",r]}),e&&t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Status:"})," ",e.message]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Tessdata Path:"})," ",t.jsx("code",{children:e.tessDataPath})]})]}),!(e!=null&&e.available)&&t.jsxs("div",{className:"info-box",style:{background:"#fff3cd",padding:"1rem",borderRadius:"6px",marginBottom:"1rem"},children:[t.jsx("strong",{children:"OCR Not Available"}),t.jsx("p",{style:{margin:"0.5rem 0 0"},children:"Tesseract OCR is not properly configured. Ensure:"}),t.jsxs("ul",{style:{margin:"0.5rem 0 0",paddingLeft:"1.5rem"},children:[t.jsx("li",{children:"Tesseract is installed (brew install tesseract)"}),t.jsx("li",{children:"tessdata directory exists with eng.traineddata"}),t.jsx("li",{children:"JNA library path is set: -Djna.library.path=/usr/local/lib"})]})]})]}),(e==null?void 0:e.available)&&t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Scan for PHI"})}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[t.jsx("button",{className:`btn ${S==="file"?"btn-primary":"btn-secondary"}`,onClick:()=>{w("file"),v(null)},children:"Single File"}),t.jsx("button",{className:`btn ${S==="directory"?"btn-primary":"btn-secondary"}`,onClick:()=>{w("directory"),f(null)},children:"Directory"})]}),S==="file"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"File Path"}),t.jsx("input",{type:"text",className:"form-input",value:l,onChange:E=>s(E.target.value),placeholder:"/path/to/dicom/file.dcm or /path/to/image.png"}),t.jsx("small",{style:{color:"var(--text-light)",display:"block",marginTop:"0.25rem"},children:"Supports DICOM files (.dcm) and images (.png, .jpg)"})]}),t.jsx("button",{className:"btn btn-primary",onClick:u,disabled:d||!l.trim(),children:d?"Scanning...":"Scan File"})]}),S==="directory"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Directory Path"}),t.jsx("input",{type:"text",className:"form-input",value:i,onChange:E=>a(E.target.value),placeholder:"/path/to/dicom/folder"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Max Files to Scan"}),t.jsx("input",{type:"number",className:"form-input",value:o,onChange:E=>c(parseInt(E.target.value)||10),min:1,max:100,style:{width:"100px"}})]}),t.jsx("button",{className:"btn btn-primary",onClick:y,disabled:d||!i.trim(),children:d?"Scanning...":"Scan Directory"})]})]}),h&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("h2",{className:"card-title",children:["Scan Results: ",h.sourceName]}),h.alterPixelScript&&t.jsx("button",{className:"btn btn-secondary",onClick:()=>p(!g),children:g?"Hide Script":"Show AlterPixel Script"})]}),h.error&&t.jsxs("div",{className:"error-message",style:{marginBottom:"1rem"},children:["Error: ",h.error]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[t.jsxs("div",{className:"stat-box",style:{background:"var(--bg-color)",padding:"1rem",borderRadius:"6px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"var(--primary-color)"},children:h.totalRegions}),t.jsx("div",{style:{color:"var(--text-light)",fontSize:"0.875rem"},children:"Total Regions"})]}),t.jsxs("div",{className:"stat-box",style:{background:h.phiRegionCount>0?"#fff3cd":"var(--bg-color)",padding:"1rem",borderRadius:"6px",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:h.phiRegionCount>0?"#856404":"var(--primary-color)"},children:h.phiRegionCount}),t.jsx("div",{style:{color:"var(--text-light)",fontSize:"0.875rem"},children:"PHI Detected"})]}),t.jsxs("div",{className:"stat-box",style:{background:"var(--bg-color)",padding:"1rem",borderRadius:"6px",textAlign:"center"},children:[t.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--primary-color)"},children:[h.imageWidth,"x",h.imageHeight]}),t.jsx("div",{style:{color:"var(--text-light)",fontSize:"0.875rem"},children:"Image Size"})]})]}),g&&h.alterPixelScript&&t.jsxs("div",{style:{marginBottom:"1.5rem"},children:[t.jsx("h3",{children:"AlterPixel Script"}),t.jsx("pre",{style:{background:"#1e1e1e",color:"#d4d4d4",padding:"1rem",borderRadius:"6px",overflow:"auto",fontSize:"0.875rem",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:h.alterPixelScript}),t.jsx("button",{className:"btn btn-secondary",onClick:()=>{navigator.clipboard.writeText(h.alterPixelScript||""),alert("Script copied to clipboard!")},style:{marginTop:"0.5rem"},children:"Copy to Clipboard"})]}),h.regions.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{children:"Detected Text Regions"}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Text"}),t.jsx("th",{children:"Position"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Confidence"}),t.jsx("th",{children:"PHI"})]})}),t.jsx("tbody",{children:h.regions.map((E,I)=>t.jsxs("tr",{style:{background:E.isPhi?"#fff3cd":void 0},children:[t.jsx("td",{children:t.jsx("code",{children:E.text})}),t.jsxs("td",{children:["(",E.x,", ",E.y,")"]}),t.jsxs("td",{children:[E.width,"x",E.height]}),t.jsxs("td",{children:[E.confidence.toFixed(1),"%"]}),t.jsx("td",{children:t.jsx("span",{className:`status-badge ${E.isPhi?"status-warning":"status-active"}`,children:E.isPhi?"PHI":"Clean"})})]},I))})]})})]})]}),m&&t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Directory Scan Results"})}),t.jsxs("div",{style:{marginBottom:"1rem"},children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Path:"})," ",m.path]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Files Scanned:"})," ",m.filesScanned," of ",m.totalFiles]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Total PHI Regions Found:"})," ",t.jsx("span",{style:{color:m.totalPhiRegions>0?"#856404":"inherit",fontWeight:"bold"},children:m.totalPhiRegions})]})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"File"}),t.jsx("th",{children:"PHI Regions"}),t.jsx("th",{children:"Status"})]})}),t.jsx("tbody",{children:m.results.map((E,I)=>t.jsxs("tr",{style:{background:E.phiRegionCount>0?"#fff3cd":void 0},children:[t.jsx("td",{children:E.file}),t.jsx("td",{children:E.phiRegionCount||0}),t.jsx("td",{children:E.error?t.jsx("span",{className:"status-badge status-inactive",children:E.error}):E.phiRegionCount>0?t.jsx("span",{className:"status-badge status-warning",children:"PHI Found"}):t.jsx("span",{className:"status-badge status-active",children:"Clean"})})]},I))})]})})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"About OCR PHI Detection"})}),t.jsx("p",{children:"This tool uses Tesseract OCR to detect text burned into DICOM images and classifies potential Protected Health Information (PHI) using pattern matching."}),t.jsx("h4",{children:"Detected PHI Patterns:"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Patient Names:"}),' Multi-word capitalized sequences, "Patient:" prefix']}),t.jsxs("li",{children:[t.jsx("strong",{children:"Dates:"})," MM/DD/YYYY, DD-Mon-YYYY, and similar formats"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"MRN/IDs:"})," Numeric sequences of 6+ digits"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"SSN:"})," XXX-XX-XXXX format"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Phone:"})," (XXX) XXX-XXXX and similar formats"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Accession Numbers:"})," ACC/ACN followed by numbers"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Institutions:"})," Hospital, Medical Center, Clinic, etc."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"DOB/Age/Sex:"})," Labels followed by values"]})]}),t.jsx("h4",{children:"Generated AlterPixel Script"}),t.jsx("p",{children:"When PHI is detected, the system generates AlterPixel commands compatible with DicomEdit scripts. These commands can be added to your anonymization scripts to black out the detected regions during processing."})]})]})}function ix(){const[e]=Xa(),{data:n,loading:r,refetch:l}=q("/query-retrieve/sources"),{data:s}=q("/query-retrieve/routes"),{data:i,refetch:a}=q("/query-retrieve/retrieve/jobs",5e3),[o,c]=x.useState("single"),[d,j]=x.useState(""),[h,f]=x.useState(""),[m,v]=x.useState(""),[S,w]=x.useState(""),[g,p]=x.useState(""),[u,y]=x.useState(""),[E,I]=x.useState(""),[_,z]=x.useState(""),[D,C]=x.useState(""),[R,ne]=x.useState("studyInstanceUID"),[K,Z]=x.useState([]),[A,ae]=x.useState([]),[Se,k]=x.useState(!1),[O,$]=x.useState(null),[H,V]=x.useState(new Set),[b,T]=x.useState(""),[G,ce]=x.useState(!1),[N,Q]=x.useState(null),[fe,ie]=x.useState(!1),[de,F]=x.useState(null),[B,U]=x.useState([]),[J,W]=x.useState(!1),[X,Y]=x.useState(null),[re,Te]=x.useState([]),[Re,vt]=x.useState(!1),[Ze,Dt]=x.useState(0);x.useEffect(()=>{if(n!=null&&n.sources&&n.sources.length>0&&!d){const P=n.sources.find(ee=>ee.enabled&&ee.available);P&&j(P.name)}},[n,d]),x.useEffect(()=>{s!=null&&s.routes&&s.routes.length>0&&!b&&T(s.routes[0].aeTitle)},[s,b]),x.useEffect(()=>{if(e.get("mode")==="bulk"){const ee=sessionStorage.getItem("qr_bulk_uids"),Gr=sessionStorage.getItem("qr_bulk_type");ee&&(c("bulk"),C(ee),(Gr==="studyInstanceUID"||Gr==="accessionNumber"||Gr==="patientID")&&ne(Gr),sessionStorage.removeItem("qr_bulk_uids"),sessionStorage.removeItem("qr_bulk_type"))}},[e]);const ys=async()=>{if(!d){$("Please select a source");return}k(!0),$(null),Z([]),V(new Set);try{const P={source:d};h&&(P.patientID=h),m&&(P.patientName=m),S&&(P.accessionNumber=S),g&&(P.studyInstanceUID=g),u&&(P.modality=u),E&&(P.studyDateFrom=E),_&&(P.studyDateTo=_);const ee=await ve("/query-retrieve/query",P);Z(ee.studies),ee.studies.length===0&&$("No studies found matching the criteria")}catch(P){$(P instanceof Error?P.message:"Query failed")}finally{k(!1)}},vs=async()=>{if(!d){$("Please select a source");return}const P=D.split(/[\n,;]/).map(ee=>ee.trim()).filter(ee=>ee.length>0);if(P.length===0){$("Please enter at least one identifier");return}k(!0),$(null),Z([]),ae([]),V(new Set);try{const ee=await ve("/query-retrieve/query/bulk",{source:d,identifiers:P,identifierType:R});Z(ee.studies),ae(ee.notFound),ee.studies.length===0?$("No studies found"):ee.notFound.length>0&&$(`Found ${ee.found} studies, ${ee.notFound.length} not found`)}catch(ee){$(ee instanceof Error?ee.message:"Bulk query failed")}finally{k(!1)}},js=()=>{o==="single"?ys():vs()},Ss=()=>{H.size===K.length?V(new Set):V(new Set(K.map(P=>P.studyInstanceUID)))},qr=P=>{const ee=new Set(H);ee.has(P)?ee.delete(P):ee.add(P),V(ee)},rr=async()=>{if(H.size===0){Q("Please select at least one study");return}if(!b){Q("Please select a target route");return}ce(!0),Q(null);try{await ve("/query-retrieve/retrieve",{source:d,targetRoute:b,studyUIDs:Array.from(H)}),V(new Set),a()}catch(P){Q(P instanceof Error?P.message:"Retrieve failed")}finally{ce(!1)}},Zu=async P=>{F(P),ie(!0),U([]),Y(null),Te([]),Dt(0),W(!0);try{const ee=await yt(`/query-retrieve/study/${encodeURIComponent(P.studyInstanceUID)}/series?source=${encodeURIComponent(d)}`);U(ee.series||[])}catch(ee){console.error("Failed to fetch series:",ee)}finally{W(!1)}},eh=async P=>{if(de){Y(P),Te([]),Dt(0),vt(!0);try{const ee=await yt(`/query-retrieve/series/${encodeURIComponent(P.seriesInstanceUID)}/images?source=${encodeURIComponent(d)}&studyUID=${encodeURIComponent(de.studyInstanceUID)}`);Te(ee.images||[])}catch(ee){console.error("Failed to fetch images:",ee)}finally{vt(!1)}}},th=()=>{Dt(P=>Math.max(0,P-1))},nh=()=>{Dt(P=>Math.min(re.length-1,P+1))},Ka=()=>{ie(!1),F(null),U([]),Y(null),Te([]),Dt(0)},rh=P=>`/api/query-retrieve/image/preview?source=${encodeURIComponent(d)}&sopInstanceUID=${encodeURIComponent(P)}`,lh=P=>!P||P.length!==8?P:`${P.slice(0,4)}-${P.slice(4,6)}-${P.slice(6,8)}`,sh=P=>!P||P.length<6?P:`${P.slice(0,2)}:${P.slice(2,4)}:${P.slice(4,6)}`,ih=P=>{switch(P){case"COMPLETED":return"badge badge-success";case"RUNNING":return"badge badge-primary";case"PENDING":return"badge badge-secondary";case"FAILED":return"badge badge-danger";case"CANCELLED":return"badge badge-warning";case"COMPLETED_WITH_ERRORS":return"badge badge-warning";default:return"badge"}};return t.jsxs("div",{className:"page-container",children:[t.jsxs("div",{className:"page-header",children:[t.jsx("h2",{children:"Query / Retrieve"}),t.jsx("p",{className:"subtitle",children:"Query remote PACS servers and retrieve studies to configured routes"}),(!(n!=null&&n.sources)||n.sources.length===0)&&!r&&t.jsxs("div",{style:{marginTop:"0.5rem",padding:"0.75rem 1rem",background:"var(--info-bg, #e3f2fd)",borderRadius:"4px",border:"1px solid var(--info-border, #90caf9)",fontSize:"0.9rem"},children:[t.jsx("strong",{children:"No PACS sources configured."})," ",t.jsx("a",{href:"/destinations",style:{color:"var(--primary-color)"},children:"Add a DICOM destination"})," ","to use as a query source."]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[t.jsxs("div",{className:"card",children:[t.jsx("h3",{children:"Query DICOM Source"}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"DICOM Source (PACS)"}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsxs("select",{value:d,onChange:P=>j(P.target.value),style:{flex:1},children:[t.jsx("option",{value:"",children:"Select a source..."}),n==null?void 0:n.sources.map(P=>t.jsxs("option",{value:P.name,disabled:!P.enabled,children:[P.name," (",P.aeTitle,"@",P.host,":",P.port,")",!P.enabled&&" [disabled]",P.enabled&&!P.available&&" [unavailable]"]},P.name))]}),t.jsx("button",{onClick:()=>l(),className:"btn-secondary",title:"Refresh sources",children:"Refresh"}),t.jsx("a",{href:"/destinations",className:"btn-secondary",style:{textDecoration:"none",display:"flex",alignItems:"center"},title:"Add a new DICOM source",children:"+ Add"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[t.jsx("button",{className:o==="single"?"btn-primary":"btn-secondary",onClick:()=>c("single"),children:"Single Query"}),t.jsx("button",{className:o==="bulk"?"btn-primary":"btn-secondary",onClick:()=>c("bulk"),children:"Bulk Query"})]}),o==="single"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient ID"}),t.jsx("input",{type:"text",value:h,onChange:P=>f(P.target.value),placeholder:"Patient ID (wildcards: * or ?)"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient Name"}),t.jsx("input",{type:"text",value:m,onChange:P=>v(P.target.value),placeholder:"Last^First or Last* for wildcard"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Accession Number"}),t.jsx("input",{type:"text",value:S,onChange:P=>w(P.target.value),placeholder:"Accession number"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Study Instance UID"}),t.jsx("input",{type:"text",value:g,onChange:P=>p(P.target.value),placeholder:"Study UID"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Modality"}),t.jsxs("select",{value:u,onChange:P=>y(P.target.value),children:[t.jsx("option",{value:"",children:"Any"}),t.jsx("option",{value:"CT",children:"CT"}),t.jsx("option",{value:"MR",children:"MR"}),t.jsx("option",{value:"PT",children:"PET"}),t.jsx("option",{value:"NM",children:"NM"}),t.jsx("option",{value:"US",children:"US"}),t.jsx("option",{value:"CR",children:"CR"}),t.jsx("option",{value:"DX",children:"DX"}),t.jsx("option",{value:"XA",children:"XA"}),t.jsx("option",{value:"MG",children:"MG"}),t.jsx("option",{value:"RF",children:"RF"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Study Date From"}),t.jsx("input",{type:"date",value:E,onChange:P=>I(P.target.value)})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Study Date To"}),t.jsx("input",{type:"date",value:_,onChange:P=>z(P.target.value)})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Identifier Type"}),t.jsxs("select",{value:R,onChange:P=>ne(P.target.value),children:[t.jsx("option",{value:"studyInstanceUID",children:"Study Instance UID"}),t.jsx("option",{value:"accessionNumber",children:"Accession Number"}),t.jsx("option",{value:"patientID",children:"Patient ID"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Identifiers (one per line, or comma/semicolon separated)"}),t.jsx("textarea",{value:D,onChange:P=>C(P.target.value),rows:10,placeholder:`Enter ${R}s, one per line...

Example:
1.2.840.113619.2.55.3
1.2.840.113619.2.55.4
1.2.840.113619.2.55.5`,style:{fontFamily:"monospace",fontSize:"0.85rem"}})]}),A.length>0&&t.jsxs("div",{style:{background:"var(--warning-bg, #fff3cd)",border:"1px solid var(--warning-border, #ffc107)",borderRadius:"4px",padding:"0.75rem",marginBottom:"1rem"},children:[t.jsxs("strong",{children:["Not found (",A.length,"):"]}),t.jsxs("div",{style:{fontSize:"0.85rem",fontFamily:"monospace",marginTop:"0.5rem"},children:[A.slice(0,10).join(", "),A.length>10&&` ... and ${A.length-10} more`]})]})]}),O&&t.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:O}),t.jsx("button",{className:"btn-primary",onClick:js,disabled:Se||!d,style:{width:"100%"},children:Se?"Querying...":"Query"})]}),t.jsxs("div",{className:"card",children:[t.jsxs("h3",{children:["Query Results",K.length>0&&t.jsxs("span",{style:{fontWeight:"normal",fontSize:"0.9rem",marginLeft:"0.5rem"},children:["(",K.length," studies)"]})]}),K.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",alignItems:"center"},children:[t.jsx("button",{onClick:Ss,className:"btn-secondary",children:H.size===K.length?"Deselect All":"Select All"}),t.jsxs("span",{style:{marginLeft:"auto",fontSize:"0.9rem"},children:[H.size," selected"]})]}),t.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid var(--border-color)",borderRadius:"4px"},children:t.jsxs("table",{className:"data-table",style:{margin:0},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"40px"}}),t.jsx("th",{children:"Patient"}),t.jsx("th",{children:"Accession"}),t.jsx("th",{children:"Date"}),t.jsx("th",{children:"Modality"}),t.jsx("th",{children:"Series"}),t.jsx("th",{children:"Images"}),t.jsx("th",{style:{width:"60px"}})]})}),t.jsx("tbody",{children:K.map(P=>t.jsxs("tr",{onClick:()=>qr(P.studyInstanceUID),style:{cursor:"pointer"},className:H.has(P.studyInstanceUID)?"selected":"",children:[t.jsx("td",{children:t.jsx("input",{type:"checkbox",checked:H.has(P.studyInstanceUID),onChange:()=>qr(P.studyInstanceUID),onClick:ee=>ee.stopPropagation()})}),t.jsxs("td",{children:[t.jsx("div",{style:{fontWeight:500},children:P.patientName||P.patientID}),t.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:P.patientID})]}),t.jsx("td",{children:P.accessionNumber}),t.jsxs("td",{children:[t.jsx("div",{children:lh(P.studyDate)}),t.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:sh(P.studyTime)})]}),t.jsx("td",{children:P.modality}),t.jsx("td",{style:{textAlign:"center"},children:P.numberOfSeries}),t.jsx("td",{style:{textAlign:"center"},children:P.numberOfInstances}),t.jsx("td",{children:t.jsx("button",{className:"btn-secondary",onClick:ee=>{ee.stopPropagation(),Zu(P)},style:{padding:"2px 8px",fontSize:"0.8rem"},title:"View study details",children:"View"})})]},P.studyInstanceUID))})]})}),t.jsxs("div",{style:{marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid var(--border-color)"},children:[t.jsx("h4",{children:"Retrieve to Route"}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Target Route (C-MOVE destination)"}),t.jsxs("select",{value:b,onChange:P=>T(P.target.value),children:[t.jsx("option",{value:"",children:"Select a route..."}),s==null?void 0:s.routes.map(P=>t.jsxs("option",{value:P.aeTitle,children:[P.aeTitle," (port ",P.port,") - ",P.destinationCount," destination(s)"]},P.aeTitle))]})]}),N&&t.jsx("div",{className:"error-message",style:{marginBottom:"1rem"},children:N}),t.jsx("button",{className:"btn-primary",onClick:rr,disabled:G||H.size===0||!b,style:{width:"100%"},children:G?"Starting Retrieve...":`Retrieve ${H.size} Study(ies)`})]})]}),K.length===0&&!Se&&t.jsx("div",{style:{padding:"2rem",textAlign:"center",opacity:.6},children:"Query results will appear here"})]})]}),(i==null?void 0:i.jobs)&&i.jobs.length>0&&t.jsxs("div",{className:"card",style:{marginTop:"1.5rem"},children:[t.jsx("h3",{children:"Retrieve Jobs"}),t.jsxs("table",{className:"data-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Job ID"}),t.jsx("th",{children:"Source"}),t.jsx("th",{children:"Target Route"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Progress"}),t.jsx("th",{children:"Studies"}),t.jsx("th",{children:"Duration"})]})}),t.jsx("tbody",{children:i.jobs.map(P=>t.jsxs("tr",{children:[t.jsx("td",{style:{fontFamily:"monospace",fontSize:"0.85rem"},children:P.jobId}),t.jsx("td",{children:P.source}),t.jsx("td",{children:P.targetRoute}),t.jsx("td",{children:t.jsx("span",{className:ih(P.status),children:P.status})}),t.jsx("td",{children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("div",{style:{width:"100px",height:"8px",background:"var(--progress-bg, #e0e0e0)",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${P.progress}%`,height:"100%",background:P.status==="FAILED"?"var(--error-color)":"var(--success-color)",transition:"width 0.3s"}})}),t.jsxs("span",{style:{fontSize:"0.85rem"},children:[P.progress,"%"]})]})}),t.jsxs("td",{children:[t.jsx("span",{style:{color:"var(--success-color)"},children:P.completedCount})," / ",P.failedCount>0&&t.jsxs("span",{style:{color:"var(--error-color)"},children:[P.failedCount," failed / "]}),P.totalStudies]}),t.jsx("td",{children:P.durationMs?`${(P.durationMs/1e3).toFixed(1)}s`:P.startTime?`${((Date.now()-P.startTime)/1e3).toFixed(0)}s`:"-"})]},P.jobId))})]})]}),fe&&de&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:Ka,children:t.jsxs("div",{style:{background:"var(--card-background, white)",borderRadius:"8px",width:"95%",maxWidth:"1400px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},onClick:P=>P.stopPropagation(),children:[t.jsxs("div",{style:{padding:"1rem 1.5rem",borderBottom:"1px solid var(--border-color)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("h3",{style:{margin:0},children:"Study Details"}),t.jsxs("div",{style:{fontSize:"0.9rem",opacity:.8,marginTop:"0.25rem"},children:[de.patientName||de.patientID," - ",de.studyDescription||"No Description"]})]}),t.jsx("button",{onClick:Ka,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,padding:"0.25rem 0.5rem"},children:"x"})]}),t.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[t.jsxs("div",{style:{width:"300px",borderRight:"1px solid var(--border-color)",display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"0.75rem 1rem",background:"var(--background-secondary, #f5f5f5)",fontWeight:500,fontSize:"0.9rem"},children:["Series (",B.length,")"]}),t.jsx("div",{style:{flex:1,overflowY:"auto"},children:J?t.jsx("div",{style:{padding:"2rem",textAlign:"center",opacity:.6},children:"Loading series..."}):B.length===0?t.jsx("div",{style:{padding:"2rem",textAlign:"center",opacity:.6},children:"No series found"}):B.map(P=>t.jsxs("div",{onClick:()=>eh(P),style:{padding:"0.75rem 1rem",borderBottom:"1px solid var(--border-color)",cursor:"pointer",background:(X==null?void 0:X.seriesInstanceUID)===P.seriesInstanceUID?"var(--primary-light, #e3f2fd)":"transparent"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{style:{fontWeight:500},children:["Series ",P.seriesNumber]}),t.jsx("span",{className:"badge",children:P.modality})]}),t.jsx("div",{style:{fontSize:"0.85rem",opacity:.8,marginTop:"0.25rem"},children:P.seriesDescription||"No Description"}),t.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6,marginTop:"0.25rem"},children:[P.numberOfInstances," images",P.bodyPartExamined&&` - ${P.bodyPartExamined}`]})]},P.seriesInstanceUID))})]}),t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:X?Re?t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6},children:"Loading images..."}):re.length===0?t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6},children:"No images found"}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#1a1a1a",overflow:"hidden",position:"relative"},children:[t.jsx("img",{src:rh(re[Ze].sopInstanceUID),alt:`Image ${re[Ze].instanceNumber}`,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},onError:P=>{P.target.style.display="none"}}),t.jsxs("div",{style:{position:"absolute",top:"1rem",left:"1rem",color:"white",background:"rgba(0,0,0,0.5)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:["Image ",Ze+1," / ",re.length]}),re[Ze].sliceLocation!==0&&t.jsxs("div",{style:{position:"absolute",top:"1rem",right:"1rem",color:"white",background:"rgba(0,0,0,0.5)",padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:["Slice: ",(re[Ze].sliceLocation??0).toFixed(2),"mm"]})]}),t.jsxs("div",{style:{padding:"1rem",borderTop:"1px solid var(--border-color)",display:"flex",alignItems:"center",gap:"1rem"},children:[t.jsx("button",{className:"btn-secondary",onClick:th,disabled:Ze===0,children:"Previous"}),t.jsx("input",{type:"range",min:0,max:re.length-1,value:Ze,onChange:P=>Dt(parseInt(P.target.value)),style:{flex:1}}),t.jsx("button",{className:"btn-secondary",onClick:nh,disabled:Ze===re.length-1,children:"Next"})]})]}):t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6},children:"Select a series to view images"})})]})]})})]})}function ax(){const e=nr(),[n,r]=x.useState(new Set),[l,s]=x.useState({patientId:"",patientName:"",patientSex:"",studyDateFrom:"",studyDateTo:"",modality:"",accessionNumber:"",institutionName:"",studyDescription:"",sourceRoute:"",bodyPart:""}),[i,a]=x.useState(null),[o,c]=x.useState(!1),[d,j]=x.useState(null),[h,f]=x.useState(null),[m,v]=x.useState(!1),[S,w]=x.useState(!1),[g,p]=x.useState(0),[u,y]=x.useState(1),E=50,I=x.useCallback(()=>{const N=[],Q={patientId:"Patient ID",patientName:"Patient Name",patientSex:"Sex",studyDateFrom:"Date From",studyDateTo:"Date To",modality:"Modality",accessionNumber:"Accession",institutionName:"Institution",studyDescription:"Description",sourceRoute:"Source",bodyPart:"Body Part"};return Object.entries(l).forEach(([fe,ie])=>{ie&&N.push({field:fe,value:ie,label:Q[fe]||fe})}),N},[l]),_=x.useCallback(async()=>{v(!0);try{const N=new URLSearchParams;Object.entries(l).forEach(([fe,ie])=>{ie&&N.append(fe,ie)});const Q=await yt(`/search/stats/aggregations?${N.toString()}`);f(Q),Q._total&&Q._total.length>0&&p(Q._total[0].count)}catch(N){console.error("Failed to fetch aggregations:",N)}finally{v(!1)}},[l]);x.useEffect(()=>{_()},[_]);const z=N=>N?N<1024?N+" B":N<1024*1024?(N/1024).toFixed(1)+" KB":N<1024*1024*1024?(N/(1024*1024)).toFixed(1)+" MB":(N/(1024*1024*1024)).toFixed(2)+" GB":"0 B",D=N=>N?N.length===8?`${N.slice(0,4)}-${N.slice(4,6)}-${N.slice(6,8)}`:N:"-",C=x.useCallback(async()=>{c(!0);try{const N=new URLSearchParams;Object.entries(l).forEach(([fe,ie])=>{ie&&N.append(fe,ie)}),N.append("limit","1000");const Q=await yt(`/search/studies?${N.toString()}`);a(Q),y(1)}catch(N){console.error("Search failed:",N)}finally{c(!1)}},[l]),R=i?Math.ceil(i.studies.length/E):0,ne=(u-1)*E,K=ne+E,Z=(i==null?void 0:i.studies.slice(ne,K))||[],A=async N=>{try{const Q=await yt(`/search/studies/${encodeURIComponent(N)}`);j(Q)}catch(Q){console.error("Failed to load study details:",Q)}},ae=(N,Q)=>{s(fe=>({...fe,[N]:fe[N]===Q?"":Q}))},Se=N=>{s(Q=>({...Q,[N]:""}))},k=()=>{s({patientId:"",patientName:"",patientSex:"",studyDateFrom:"",studyDateTo:"",modality:"",accessionNumber:"",institutionName:"",studyDescription:"",sourceRoute:"",bodyPart:""}),a(null)},O=async()=>{w(!0);try{const N=new URLSearchParams;Object.entries(l).forEach(([F,B])=>{B&&N.append(F,B)}),N.append("limit","10000");const Q=await fetch(`/api/search/export/csv?${N.toString()}`,{headers:{Authorization:`Basic ${btoa("admin:admin123")}`}});if(!Q.ok)throw new Error("Export failed");const fe=await Q.blob(),ie=window.URL.createObjectURL(fe),de=document.createElement("a");de.href=ie,de.download=`dicom_studies_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(de),de.click(),window.URL.revokeObjectURL(ie),document.body.removeChild(de)}catch(N){console.error("Export failed:",N),alert("Failed to export CSV")}finally{w(!1)}},$=N=>{const Q=new Set(n);Q.has(N)?Q.delete(N):Q.add(N),r(Q)},H=()=>{i&&(n.size===i.studies.length?r(new Set):r(new Set(i.studies.map(N=>N.studyUid))))},V=()=>{n.size!==0&&(sessionStorage.setItem("qr_bulk_uids",Array.from(n).join(`
`)),sessionStorage.setItem("qr_bulk_type","studyInstanceUID"),e("/query-retrieve?mode=bulk"))},b=["#3182ce","#38a169","#dd6b20","#805ad5","#d53f8c","#319795","#d69e2e","#e53e3e","#667eea","#48bb78"],T=({data:N,title:Q,filterField:fe,currentFilter:ie})=>{const de=N&&N.length>0?N:ie?[{value:ie,count:g}]:[],F=de.length>0,B=F?de.reduce((re,Te)=>re+Te.count,0):0,U=140,J=U/2,W=U/2,X=55;let Y=-Math.PI/2;return t.jsxs("div",{style:{textAlign:"center",minWidth:"160px"},children:[t.jsx("h4",{style:{marginBottom:"0.5rem",fontSize:"0.85rem",color:"var(--text-color)"},children:Q}),F?t.jsx("svg",{width:U,height:U,style:{display:"block",margin:"0 auto"},children:de.slice(0,8).map((re,Te)=>{const Re=re.count/B*2*Math.PI,vt=Y,Ze=Y+Re;Y=Ze;const Dt=J+X*Math.cos(vt),ys=W+X*Math.sin(vt),vs=J+X*Math.cos(Ze),js=W+X*Math.sin(Ze),Ss=Re>Math.PI?1:0,qr=`M ${J} ${W} L ${Dt} ${ys} A ${X} ${X} 0 ${Ss} 1 ${vs} ${js} Z`,rr=ie===re.value;return t.jsx("path",{d:qr,fill:b[Te%b.length],stroke:rr?"#000":"white",strokeWidth:rr?3:1,style:{cursor:"pointer",opacity:rr?1:.85},onClick:()=>ae(fe,re.value),children:t.jsx("title",{children:`${re.value||"(empty)"}: ${re.count.toLocaleString()} (${(re.count/B*100).toFixed(1)}%)`})},re.value||"empty")})}):t.jsx("div",{style:{width:U,height:U,display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},children:t.jsxs("svg",{width:U,height:U,children:[t.jsx("circle",{cx:J,cy:W,r:X,fill:"var(--border-color)",opacity:.5}),t.jsx("text",{x:J,y:W,textAnchor:"middle",dominantBaseline:"middle",fill:"var(--text-light)",fontSize:"12",children:"No data"})]})}),F&&t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px",justifyContent:"center",marginTop:"0.5rem",maxWidth:"180px",margin:"0.5rem auto 0"},children:de.slice(0,5).map((re,Te)=>{const Re=ie===re.value;return t.jsxs("span",{style:{fontSize:"0.65rem",display:"flex",alignItems:"center",gap:"2px",cursor:"pointer",padding:"2px 6px",borderRadius:"3px",background:Re?"var(--secondary-color)":"var(--bg-alt, #f8f9fa)",color:Re?"white":"var(--text-color)",fontWeight:Re?600:400},onClick:()=>ae(fe,re.value),children:[t.jsx("span",{style:{width:8,height:8,background:b[Te%b.length],borderRadius:"50%",flexShrink:0}}),(re.value||"(empty)").slice(0,12),re.value&&re.value.length>12?"...":""]},re.value||"empty")})})]})},G=({data:N,title:Q,filterField:fe,currentFilter:ie,maxBars:de=8})=>{const F=N&&N.length>0?N:ie?[{value:ie,count:g}]:[],B=F.length>0,U=B?F.slice(0,de):[],J=B?Math.max(...U.map(W=>W.count),1):1;return t.jsxs("div",{style:{minWidth:"200px"},children:[t.jsx("h4",{style:{marginBottom:"0.5rem",fontSize:"0.85rem",color:"var(--text-color)"},children:Q}),B?t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:U.map((W,X)=>{const Y=ie===W.value;return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",padding:"2px 4px",borderRadius:"4px",background:Y?"rgba(52, 152, 219, 0.1)":"transparent",border:Y?"1px solid var(--secondary-color)":"1px solid transparent"},onClick:()=>ae(fe,W.value),children:[t.jsx("span",{style:{width:"70px",fontSize:"0.7rem",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",textAlign:"right",color:Y?"var(--secondary-color)":"var(--text-light)",fontWeight:Y?600:400},title:W.value||"(empty)",children:(W.value||"(empty)").slice(0,12)}),t.jsx("div",{style:{flex:1,height:"16px",background:"var(--border-color)",borderRadius:"2px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${W.count/J*100}%`,height:"100%",background:Y?"var(--secondary-color)":b[X%b.length],borderRadius:"2px",transition:"width 0.2s"}})}),t.jsx("span",{style:{fontSize:"0.7rem",minWidth:"45px",color:Y?"var(--secondary-color)":"var(--text-light)",fontWeight:Y?600:400},children:W.count.toLocaleString()})]},W.value||"empty")})}):t.jsx("div",{style:{padding:"2rem 1rem",textAlign:"center",color:"var(--text-light)",background:"var(--border-color)",borderRadius:"4px",opacity:.5},children:"No data"})]})},ce=I();return t.jsxs("div",{children:[t.jsx("div",{className:"card",style:{marginBottom:"1rem"},children:t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[t.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"var(--secondary-color)"},children:m?"...":g.toLocaleString()}),t.jsx("div",{style:{color:"var(--text-light)"},children:"matching studies"}),ce.length>0&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginLeft:"1rem",paddingLeft:"1rem",borderLeft:"1px solid var(--border-color)"},children:[t.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-light)"},children:"Filters:"}),ce.map(N=>t.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"2px 8px",background:"var(--secondary-color)",color:"white",borderRadius:"12px",fontSize:"0.75rem"},children:[t.jsxs("strong",{children:[N.label,":"]})," ",N.value,t.jsx("button",{onClick:()=>Se(N.field),style:{background:"none",border:"none",color:"white",cursor:"pointer",padding:"0 2px",fontSize:"1rem",lineHeight:1,opacity:.8},children:"x"})]},N.field)),t.jsx("button",{onClick:k,style:{background:"none",border:"none",color:"var(--danger-color)",cursor:"pointer",fontSize:"0.75rem",textDecoration:"underline"},children:"Clear all"})]})]})})}),h&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"Data Overview"}),t.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-light)"},children:"Click any segment to filter"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"2rem",padding:"1rem 0"},children:[t.jsx(T,{data:h.modality||[],title:"Modality (Series)",filterField:"modality",currentFilter:l.modality}),t.jsx(T,{data:h.patientSex||[],title:"Patient Sex",filterField:"patientSex",currentFilter:l.patientSex}),t.jsx(G,{data:h.bodyPart||[],title:"Body Part",filterField:"bodyPart",currentFilter:l.bodyPart,maxBars:6}),t.jsx(G,{data:h.institutionName||[],title:"Institution",filterField:"institutionName",currentFilter:l.institutionName,maxBars:6}),t.jsx(G,{data:h.sourceRoute||[],title:"Source Route",filterField:"sourceRoute",currentFilter:l.sourceRoute,maxBars:5}),t.jsx(G,{data:h.modalities||[],title:"Modalities (Studies)",filterField:"modality",currentFilter:l.modality,maxBars:6})]})]}),t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Search Studies"})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"1rem"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient ID"}),t.jsx("input",{type:"text",value:l.patientId,onChange:N=>s({...l,patientId:N.target.value}),placeholder:"Search patient ID..."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient Name"}),t.jsx("input",{type:"text",value:l.patientName,onChange:N=>s({...l,patientName:N.target.value}),placeholder:"Search patient name..."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Patient Sex"}),t.jsxs("select",{value:l.patientSex,onChange:N=>s({...l,patientSex:N.target.value}),children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"M",children:"Male"}),t.jsx("option",{value:"F",children:"Female"}),t.jsx("option",{value:"O",children:"Other"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Study Date From"}),t.jsx("input",{type:"date",value:l.studyDateFrom,onChange:N=>s({...l,studyDateFrom:N.target.value.replace(/-/g,"")})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Study Date To"}),t.jsx("input",{type:"date",value:l.studyDateTo,onChange:N=>s({...l,studyDateTo:N.target.value.replace(/-/g,"")})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Modality"}),t.jsxs("select",{value:l.modality,onChange:N=>s({...l,modality:N.target.value}),children:[t.jsx("option",{value:"",children:"All"}),t.jsx("option",{value:"CT",children:"CT"}),t.jsx("option",{value:"MR",children:"MR"}),t.jsx("option",{value:"US",children:"US"}),t.jsx("option",{value:"XA",children:"XA"}),t.jsx("option",{value:"CR",children:"CR"}),t.jsx("option",{value:"DX",children:"DX"}),t.jsx("option",{value:"PT",children:"PT"}),t.jsx("option",{value:"NM",children:"NM"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Accession Number"}),t.jsx("input",{type:"text",value:l.accessionNumber,onChange:N=>s({...l,accessionNumber:N.target.value}),placeholder:"Search accession..."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Institution"}),t.jsx("input",{type:"text",value:l.institutionName,onChange:N=>s({...l,institutionName:N.target.value}),placeholder:"Search institution..."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Description"}),t.jsx("input",{type:"text",value:l.studyDescription,onChange:N=>s({...l,studyDescription:N.target.value}),placeholder:"Search description..."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Source Route"}),t.jsx("input",{type:"text",value:l.sourceRoute,onChange:N=>s({...l,sourceRoute:N.target.value}),placeholder:"Search source..."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Body Part"}),t.jsx("input",{type:"text",value:l.bodyPart,onChange:N=>s({...l,bodyPart:N.target.value}),placeholder:"Search body part..."})]})]}),t.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[t.jsx("button",{className:"btn btn-primary",onClick:C,disabled:o,children:o?"Searching...":"Search"}),t.jsx("button",{className:"btn btn-secondary",onClick:k,children:"Clear"})]})]}),i&&t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[t.jsxs("h2",{className:"card-title",children:["Results (",i.count.toLocaleString(),")"]}),i.studies.length>0&&t.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-light)"},children:n.size>0&&`${n.size} selected`})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[i.studies.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:H,children:n.size===i.studies.length?"Deselect All":"Select All"}),t.jsxs("button",{className:"btn btn-sm btn-primary",onClick:V,disabled:n.size===0,title:"Query remote PACS for selected studies",children:["Q/R Selected (",n.size,")"]})]}),t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:O,disabled:S||i.count===0,children:S?"Exporting...":"Export CSV"})]})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{width:"40px"},children:t.jsx("input",{type:"checkbox",checked:i.studies.length>0&&n.size===i.studies.length,onChange:H,title:"Select all"})}),t.jsx("th",{children:"Patient ID"}),t.jsx("th",{children:"Patient Name"}),t.jsx("th",{children:"Sex"}),t.jsx("th",{children:"Study Date"}),t.jsx("th",{children:"Modalities"}),t.jsx("th",{children:"Description"}),t.jsx("th",{children:"Source"}),t.jsx("th",{children:"Series"}),t.jsx("th",{children:"Images"}),t.jsx("th",{children:"Size"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[Z.map(N=>t.jsxs("tr",{style:{background:n.has(N.studyUid)?"rgba(52, 152, 219, 0.08)":void 0},children:[t.jsx("td",{children:t.jsx("input",{type:"checkbox",checked:n.has(N.studyUid),onChange:()=>$(N.studyUid)})}),t.jsx("td",{children:N.patientId||"-"}),t.jsx("td",{children:N.patientName||"-"}),t.jsx("td",{children:N.patientSex||"-"}),t.jsx("td",{children:D(N.studyDate)}),t.jsx("td",{children:t.jsx("span",{className:"status-badge status-up",children:N.modalities||"-"})}),t.jsx("td",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:N.studyDescription,children:N.studyDescription||"-"}),t.jsx("td",{children:N.sourceRoute?t.jsx("span",{style:{cursor:"pointer",color:"var(--secondary-color)",textDecoration:"underline"},onClick:()=>ae("sourceRoute",N.sourceRoute),children:N.sourceRoute}):"-"}),t.jsx("td",{children:N.seriesCount}),t.jsx("td",{children:N.instanceCount}),t.jsx("td",{children:z(N.totalSize)}),t.jsx("td",{children:t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>A(N.studyUid),children:"View"})})]},N.studyUid)),Z.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:12,style:{textAlign:"center",color:"var(--text-light)"},children:"No studies found matching your criteria"})})]})]})}),R>1&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1rem",padding:"0.75rem 0",borderTop:"1px solid var(--border-color)"},children:[t.jsxs("div",{style:{color:"var(--text-light)",fontSize:"0.9rem"},children:["Showing ",ne+1,"-",Math.min(K,i.studies.length)," of ",i.studies.length," studies"]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>y(1),disabled:u===1,title:"First page",children:""}),t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>y(N=>Math.max(1,N-1)),disabled:u===1,children:"Previous"}),t.jsxs("span",{style:{padding:"0.25rem 0.75rem",background:"var(--bg-alt, #f8f9fa)",borderRadius:"4px",fontSize:"0.9rem"},children:["Page ",u," of ",R]}),t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>y(N=>Math.min(R,N+1)),disabled:u===R,children:"Next"}),t.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>y(R),disabled:u===R,title:"Last page",children:""})]})]})]}),d&&t.jsx("div",{className:"modal-overlay",onClick:()=>j(null),children:t.jsxs("div",{className:"modal",onClick:N=>N.stopPropagation(),style:{maxWidth:"900px"},children:[t.jsxs("div",{className:"modal-header",children:[t.jsx("h2",{children:"Study Details"}),t.jsx("button",{className:"close-btn",onClick:()=>j(null),children:"x"})]}),t.jsxs("div",{className:"modal-content",children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Patient ID:"})," ",d.study.patientId||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Patient Name:"})," ",d.study.patientName||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Patient Sex:"})," ",d.study.patientSex||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Study Date:"})," ",D(d.study.studyDate)]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Accession #:"})," ",d.study.accessionNumber||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Institution:"})," ",d.study.institutionName||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Referring:"})," ",d.study.referringPhysician||"-"]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Source Route:"})," ",d.study.sourceRoute||"-"]}),t.jsxs("div",{style:{gridColumn:"1 / -1"},children:[t.jsx("strong",{children:"Description:"})," ",d.study.studyDescription||"-"]}),t.jsxs("div",{style:{gridColumn:"1 / -1"},children:[t.jsx("strong",{children:"Study UID:"})," ",t.jsx("code",{style:{fontSize:"0.75rem"},children:d.study.studyUid})]}),d.study.customFields&&Object.keys(d.study.customFields).length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{gridColumn:"1 / -1",marginTop:"0.5rem",borderTop:"1px solid var(--border-color)",paddingTop:"0.5rem"},children:t.jsx("strong",{children:"Custom Fields:"})}),Object.entries(d.study.customFields).map(([N,Q])=>t.jsxs("div",{children:[t.jsxs("strong",{children:[N,":"]})," ",Q]},N))]})]}),t.jsxs("h3",{style:{marginBottom:"0.5rem"},children:["Series (",d.series.length,")"]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"#"}),t.jsx("th",{children:"Modality"}),t.jsx("th",{children:"Description"}),t.jsx("th",{children:"Body Part"}),t.jsx("th",{children:"Images"})]})}),t.jsx("tbody",{children:d.series.map(N=>t.jsxs("tr",{children:[t.jsx("td",{children:N.seriesNumber}),t.jsx("td",{children:t.jsx("span",{className:"status-badge status-up",children:N.modality})}),t.jsx("td",{children:N.seriesDescription||"-"}),t.jsx("td",{children:N.bodyPart||"-"}),t.jsx("td",{children:N.instanceCount})]},N.seriesUid))})]})})]})]})})]})}function ox(){var Z,A,ae,Se;const[e,n]=x.useState(""),[r,l]=x.useState(!1),[s,i]=x.useState(""),[a,o]=x.useState(""),[c,d]=x.useState("NONE"),[j,h]=x.useState(!1),[f,m]=x.useState({fieldName:"",displayName:"",dicomTag:"",level:"study",fieldType:"string",searchable:!0,displayInList:!0,enabled:!0}),{data:v,refetch:S}=q("/search/stats",6e4),{data:w,refetch:g}=q("/search/fields"),{data:p}=q("/search/fields/available-tags"),{data:u,refetch:y}=q("/search/reindex/status",2e3),{data:E}=q("/search/destinations"),I=k=>k?k<1024?k+" B":k<1024*1024?(k/1024).toFixed(1)+" KB":k<1024*1024*1024?(k/(1024*1024)).toFixed(1)+" MB":(k/(1024*1024*1024)).toFixed(2)+" GB":"0 B",_=k=>k?k.replace(/-/g,""):"",z=async()=>{if(e){const k=E==null?void 0:E.destinations.find(V=>V.name===e),O=k?`${k.name} (${k.type})`:e,$=(k==null?void 0:k.type)==="dicom";let H="";if($&&(s||a)&&(s&&a?H=` Date range: ${s} to ${a}.`:s?H=` Studies from ${s} onwards.`:a&&(H=` Studies up to ${a}.`)),!confirm(`This will index DICOM data from destination "${O}".${H} ${r?"Existing index will be cleared. ":""}Continue?`))return;try{const V=new URLSearchParams;V.append("clearExisting",String(r)),$&&(s&&V.append("studyDateFrom",_(s)),a&&V.append("studyDateTo",_(a)),c!=="NONE"&&V.append("chunkSize",c)),await ve(`/search/reindex/destination/${encodeURIComponent(e)}?${V.toString()}`,{}),y(),S()}catch(V){console.error("Failed to start reindex:",V)}}else{if(!confirm("This will scan all DICOM files in the receiver base directory and rebuild the search index. Continue?"))return;try{await ve("/search/reindex",{}),y(),S()}catch(k){console.error("Failed to start reindex:",k)}}},D=async()=>{if(confirm("Are you sure you want to cancel the current indexing job?"))try{await ve("/search/reindex/cancel",{}),y()}catch(k){console.error("Failed to cancel reindex:",k)}},C=async()=>{if(!f.fieldName||!f.dicomTag){alert("Field name and DICOM tag are required");return}try{await ve("/search/fields",f),g(),m({fieldName:"",displayName:"",dicomTag:"",level:"study",fieldType:"string",searchable:!0,displayInList:!0,enabled:!0})}catch(k){console.error("Failed to add field:",k)}},R=async k=>{if(confirm("Delete this custom field? This will also remove all indexed values."))try{await Nt(`/search/fields/${k}`),g()}catch(O){console.error("Failed to delete field:",O)}},ne=async k=>{try{await xn(`/search/fields/${k.id}`,{...k,enabled:!k.enabled}),g()}catch(O){console.error("Failed to toggle field:",O)}},K=u&&"status"in u&&u.status==="running";return t.jsxs("div",{children:[t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsx("h2",{className:"card-title",children:"DICOM Index"}),t.jsxs("button",{className:"btn btn-secondary",onClick:()=>h(!j),children:[j?"Hide":"Configure"," Fields"]})]}),t.jsxs("div",{className:"stat-grid",children:[t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:((Z=v==null?void 0:v.studyCount)==null?void 0:Z.toLocaleString())||0}),t.jsx("div",{className:"stat-label",children:"Studies"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:((A=v==null?void 0:v.seriesCount)==null?void 0:A.toLocaleString())||0}),t.jsx("div",{className:"stat-label",children:"Series"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:((ae=v==null?void 0:v.instanceCount)==null?void 0:ae.toLocaleString())||0}),t.jsx("div",{className:"stat-label",children:"Instances"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:I((v==null?void 0:v.totalSizeBytes)||0)}),t.jsx("div",{className:"stat-label",children:"Total Size"})]}),t.jsxs("div",{className:"stat-item",children:[t.jsx("div",{className:"stat-value",children:(v==null?void 0:v.customFieldCount)||0}),t.jsx("div",{className:"stat-label",children:"Custom Fields"})]})]}),t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--bg-color)",borderRadius:"6px"},children:[t.jsx("h3",{style:{marginBottom:"0.75rem",fontSize:"1rem"},children:"Index Source"}),t.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end",flexWrap:"wrap"},children:[t.jsxs("div",{className:"form-group",style:{minWidth:"250px",margin:0},children:[t.jsx("label",{children:"Destination"}),t.jsxs("select",{value:e,onChange:k=>n(k.target.value),disabled:K,children:[t.jsx("option",{value:"",children:"Receiver base directory (default)"}),E==null?void 0:E.destinations.filter(k=>k.indexable).map(k=>t.jsxs("option",{value:k.name,children:[k.name," (",k.type,")",k.path&&` - ${k.path}`,k.host&&` - ${k.host}:${k.port}`]},k.name))]})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:r,onChange:k=>l(k.target.checked),disabled:K}),"Clear existing index"]}),t.jsx("button",{className:"btn btn-primary",onClick:z,disabled:K,children:K?"Indexing...":e?`Index from ${e}`:"Index All"})]}),e&&((Se=E==null?void 0:E.destinations.find(k=>k.name===e))==null?void 0:Se.type)==="dicom"&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--bg-alt, #f8f9fa)",borderRadius:"6px",border:"1px solid var(--border-color)"},children:[t.jsx("h4",{style:{marginBottom:"0.75rem",fontSize:"0.9rem",color:"var(--text-color)"},children:"Query Options for DICOM Server"}),t.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end",flexWrap:"wrap"},children:[t.jsxs("div",{className:"form-group",style:{margin:0},children:[t.jsx("label",{children:"Study Date From"}),t.jsx("input",{type:"date",value:s,onChange:k=>i(k.target.value),disabled:K,style:{width:"160px"}})]}),t.jsxs("div",{className:"form-group",style:{margin:0},children:[t.jsx("label",{children:"Study Date To"}),t.jsx("input",{type:"date",value:a,onChange:k=>o(k.target.value),disabled:K,style:{width:"160px"}})]}),t.jsxs("div",{className:"form-group",style:{margin:0,minWidth:"140px"},children:[t.jsx("label",{children:"Chunk Size"}),t.jsxs("select",{value:c,onChange:k=>d(k.target.value),disabled:K,children:[t.jsx("option",{value:"NONE",children:"No Chunking"}),t.jsx("option",{value:"YEARLY",children:"Yearly"}),t.jsx("option",{value:"MONTHLY",children:"Monthly"}),t.jsx("option",{value:"WEEKLY",children:"Weekly"}),t.jsx("option",{value:"DAILY",children:"Daily"}),t.jsx("option",{value:"HOURLY",children:"Hourly"})]})]})]}),t.jsxs("p",{style:{marginTop:"0.75rem",color:"var(--text-light)",fontSize:"0.8rem"},children:[t.jsx("strong",{children:"Tip:"})," For large PACS with millions of studies, use date ranges and chunking to avoid timeouts.",c!=="NONE"&&t.jsxs("span",{children:[" Queries will be split into ",t.jsx("strong",{children:c.toLowerCase()})," chunks."]})]})]}),e&&(E==null?void 0:E.destinations.find(k=>k.name===e))&&t.jsx("p",{style:{marginTop:"0.5rem",color:"var(--text-light)",fontSize:"0.875rem"},children:(()=>{const k=E.destinations.find(O=>O.name===e);return k?k.type==="file"?`Will scan DICOM files from: ${k.path}`:k.type==="dicom"?`Will query DICOM server: ${k.host}:${k.port} (AE: ${k.aeTitle})`:null:null})()})]}),u&&"totalFiles"in u&&(u.status==="running"||u.status==="completed"||u.status==="failed"||u.status==="cancelled")&&t.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:u.status==="failed"?"var(--danger-bg, #fff5f5)":u.status==="cancelled"?"var(--warning-bg, #fffaf0)":u.status==="completed"?"var(--success-bg, #f0fff4)":"var(--bg-color)",borderRadius:"6px",borderLeft:u.status==="failed"?"4px solid var(--danger-color)":u.status==="cancelled"?"4px solid var(--warning-color, #dd6b20)":u.status==="completed"?"4px solid var(--success-color)":"4px solid var(--primary-color)"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[t.jsx("div",{children:t.jsxs("strong",{style:{color:u.status==="failed"?"var(--danger-color)":u.status==="cancelled"?"var(--warning-color, #dd6b20)":u.status==="completed"?"var(--success-color)":"inherit"},children:[u.status==="running"&&"Indexing in progress...",u.status==="completed"&&"Indexing completed",u.status==="failed"&&"Indexing failed",u.status==="cancelled"&&"Indexing cancelled"]})}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[t.jsxs("span",{style:{fontSize:"0.875rem"},children:[u.processedFiles.toLocaleString()," / ",u.totalFiles.toLocaleString()," studies"]}),u.status==="running"&&t.jsx("button",{className:"btn btn-sm btn-danger",onClick:D,style:{padding:"0.25rem 0.75rem"},children:"Cancel"}),(u.status==="completed"||u.status==="failed"||u.status==="cancelled")&&t.jsx("button",{className:"btn btn-sm btn-primary",onClick:z,style:{padding:"0.25rem 0.75rem"},children:"Restart"})]})]}),t.jsxs("div",{style:{background:"var(--border-color)",borderRadius:"4px",height:"24px",overflow:"hidden",position:"relative"},children:[t.jsx("div",{style:{background:u.status==="failed"?"var(--danger-color)":u.status==="cancelled"?"var(--warning-color, #dd6b20)":u.status==="completed"?"var(--success-color)":"linear-gradient(90deg, var(--primary-color), var(--secondary-color, #4a90d9))",height:"100%",width:`${u.totalFiles>0?u.processedFiles/u.totalFiles*100:0}%`,transition:"width 0.3s"}}),t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:600,color:u.processedFiles/u.totalFiles>.5?"white":"var(--text-color)"},children:u.totalFiles>0?`${(u.processedFiles/u.totalFiles*100).toFixed(1)}%`:"Querying..."})]}),t.jsxs("div",{style:{marginTop:"0.75rem",display:"flex",gap:"1.5rem",fontSize:"0.875rem",color:"var(--text-light)"},children:[u.startedAt&&t.jsxs("span",{children:["Started: ",new Date(u.startedAt).toLocaleTimeString()]}),u.completedAt&&t.jsxs("span",{children:["Completed: ",new Date(u.completedAt).toLocaleTimeString()]}),u.errorCount>0&&t.jsxs("span",{style:{color:"var(--danger-color)"},children:[u.errorCount," error",u.errorCount!==1?"s":""]})]}),u.errorMessage&&t.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(255,0,0,0.1)",borderRadius:"4px",fontSize:"0.875rem",color:"var(--danger-color)"},children:[t.jsx("strong",{children:"Error:"})," ",u.errorMessage]}),u.status==="running"&&u.message&&t.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--primary-color)",fontWeight:500},children:u.message}),u.status==="running"&&u.totalFiles===0&&!u.message&&t.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--text-light)"},children:"Performing C-FIND query to discover studies..."})]})]}),j&&t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card-header",children:t.jsx("h2",{className:"card-title",children:"Custom DICOM Fields"})}),t.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-color)",borderRadius:"6px"},children:[t.jsx("h3",{style:{marginBottom:"1rem",fontSize:"1rem"},children:"Add Custom Field"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"1rem"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Field Name"}),t.jsx("input",{type:"text",value:f.fieldName,onChange:k=>m({...f,fieldName:k.target.value}),placeholder:"e.g., manufacturer"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Display Name"}),t.jsx("input",{type:"text",value:f.displayName,onChange:k=>m({...f,displayName:k.target.value}),placeholder:"e.g., Manufacturer"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"DICOM Tag"}),t.jsxs("select",{value:f.dicomTag,onChange:k=>{const O=p==null?void 0:p.tags.find($=>$.tag===k.target.value||$.keyword===k.target.value);m(O?{...f,dicomTag:O.tag,displayName:f.displayName||O.displayName,fieldName:f.fieldName||O.keyword.toLowerCase(),level:O.level,fieldType:O.fieldType}:{...f,dicomTag:k.target.value})},children:[t.jsx("option",{value:"",children:"Select a tag..."}),p==null?void 0:p.tags.map(k=>t.jsxs("option",{value:k.tag,children:[k.displayName," (",k.tag,")"]},k.keyword))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Level"}),t.jsxs("select",{value:f.level,onChange:k=>m({...f,level:k.target.value}),children:[t.jsx("option",{value:"study",children:"Study"}),t.jsx("option",{value:"series",children:"Series"}),t.jsx("option",{value:"instance",children:"Instance"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type"}),t.jsxs("select",{value:f.fieldType,onChange:k=>m({...f,fieldType:k.target.value}),children:[t.jsx("option",{value:"string",children:"String"}),t.jsx("option",{value:"number",children:"Number"}),t.jsx("option",{value:"date",children:"Date"})]})]}),t.jsxs("div",{className:"form-group",style:{display:"flex",alignItems:"center",gap:"1rem",paddingTop:"1.5rem"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:f.searchable,onChange:k=>m({...f,searchable:k.target.checked})}),"Searchable"]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:f.displayInList,onChange:k=>m({...f,displayInList:k.target.checked})}),"Show in List"]})]})]}),t.jsx("button",{className:"btn btn-primary",onClick:C,style:{marginTop:"1rem"},children:"Add Field"})]}),t.jsx("div",{className:"table-container",children:t.jsxs("table",{children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Field Name"}),t.jsx("th",{children:"Display Name"}),t.jsx("th",{children:"DICOM Tag"}),t.jsx("th",{children:"Level"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Searchable"}),t.jsx("th",{children:"Show in List"}),t.jsx("th",{children:"Enabled"}),t.jsx("th",{children:"Actions"})]})}),t.jsxs("tbody",{children:[w==null?void 0:w.fields.map(k=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsx("code",{children:k.fieldName})}),t.jsx("td",{children:k.displayName}),t.jsx("td",{children:t.jsx("code",{children:k.dicomTag})}),t.jsx("td",{children:k.level}),t.jsx("td",{children:k.fieldType}),t.jsx("td",{children:k.searchable?"Yes":"No"}),t.jsx("td",{children:k.displayInList?"Yes":"No"}),t.jsx("td",{children:t.jsx("button",{className:`btn btn-sm ${k.enabled?"btn-success":"btn-secondary"}`,onClick:()=>ne(k),children:k.enabled?"On":"Off"})}),t.jsx("td",{children:t.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>R(k.id),children:"Delete"})})]},k.id)),(!(w!=null&&w.fields)||w.fields.length===0)&&t.jsx("tr",{children:t.jsx("td",{colSpan:9,style:{textAlign:"center",color:"var(--text-light)"},children:"No custom fields configured. Add fields above to index additional DICOM tags."})})]})]})}),t.jsx("p",{style:{marginTop:"1rem",color:"var(--text-light)",fontSize:"0.875rem"},children:'After adding new fields, run "Index All" to populate values for existing DICOM files.'})]})]})}function cx(e,n){return q(e&&n?`/compare/${encodeURIComponent(e)}/${encodeURIComponent(n)}`:"")}function dx(e,n){return q(e&&n?`/compare/${encodeURIComponent(e)}/${encodeURIComponent(n)}/scans`:"")}async function ux(e,n){const r=new URLSearchParams({original:e,anonymized:n});return yt(`/compare/header?${r}`)}async function hx(e,n=!1,r=0){const l=new URLSearchParams({path:e,overlay:String(n),frame:String(r)});return Ju(`/compare/image?${l}`)}async function fx(e){const n=new URLSearchParams({path:e});return yt(`/compare/ocr?${n}`)}async function px(e){const n=new URLSearchParams({path:e});return yt(`/compare/image-info?${n}`)}function yc({regions:e,imageWidth:n,imageHeight:r,containerWidth:l,containerHeight:s}){const[i,a]=x.useState(null);if(!e||e.length===0)return null;const o=l/n,c=s/r,d=Math.min(o,c),j=n*d,h=r*d,f=(l-j)/2,m=(s-h)/2;return t.jsxs("svg",{width:l,height:s,style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[e.map((v,S)=>{const w=f+v.x*d,g=m+v.y*d,p=v.width*d,u=v.height*d,y=v.isPhi?"#ff4444":"#ffcc00",E=v.isPhi?"rgba(255, 68, 68, 0.1)":"rgba(255, 204, 0, 0.1)";return t.jsxs("g",{children:[t.jsx("rect",{x:w,y:g,width:p,height:u,fill:E,stroke:y,strokeWidth:2,style:{pointerEvents:"all",cursor:"pointer"},onMouseEnter:()=>a(v),onMouseLeave:()=>a(null)}),v.isPhi&&t.jsxs("g",{children:[t.jsx("rect",{x:w,y:g-18,width:30,height:16,fill:"#ff4444",rx:2}),t.jsx("text",{x:w+15,y:g-6,fill:"white",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:"PHI"})]})]},S)}),i&&t.jsxs("g",{children:[t.jsx("rect",{x:10,y:s-60,width:Math.min(l-20,300),height:50,fill:"rgba(0, 0, 0, 0.85)",rx:4}),t.jsxs("text",{x:20,y:s-40,fill:"white",fontSize:12,children:[i.isPhi?"PHI Detected: ":"Text: ",i.text.length>40?i.text.substring(0,40)+"...":i.text]}),t.jsxs("text",{x:20,y:s-22,fill:"#aaa",fontSize:10,children:["Confidence: ",i.confidence.toFixed(1),"%"," | ","Position: (",i.x,", ",i.y,")"," | ","Size: ",i.width,"x",i.height]})]}),t.jsxs("g",{children:[t.jsx("rect",{x:10,y:10,width:12,height:12,fill:"rgba(255, 68, 68, 0.3)",stroke:"#ff4444",strokeWidth:2}),t.jsx("text",{x:28,y:20,fill:"#333",fontSize:11,children:"PHI Detected"}),t.jsx("rect",{x:110,y:10,width:12,height:12,fill:"rgba(255, 204, 0, 0.3)",stroke:"#ffcc00",strokeWidth:2}),t.jsx("text",{x:128,y:20,fill:"#333",fontSize:11,children:"Text Detected"})]})]})}function mx({originalPath:e,anonymizedPath:n,showOverlay:r=!0}){var g,p;const[l,s]=x.useState({url:null,loading:!0,error:null,info:null,ocrRegions:[]}),[i,a]=x.useState({url:null,loading:!0,error:null,info:null,ocrRegions:[]}),[o,c]=x.useState(0),[d,j]=x.useState(r),h=x.useRef(null),f=x.useRef(null),[m,v]=x.useState({width:400,height:400}),S=x.useCallback(async(u,y,E)=>{if(!u){y(I=>({...I,loading:!1,error:"No file path"}));return}y(I=>({...I,loading:!0,error:null}));try{const I=await px(u),_=await hx(u,!1,E);let z=[];try{z=(await fx(u)).regions||[]}catch(D){console.warn("Failed to load OCR regions:",D)}y({url:_,loading:!1,error:null,info:I,ocrRegions:z})}catch(I){y(_=>({..._,loading:!1,error:I instanceof Error?I.message:"Failed to load image"}))}},[]);x.useEffect(()=>{S(e,s,o)},[e,o,S]),x.useEffect(()=>{S(n,a,o)},[n,o,S]),x.useEffect(()=>{const u=()=>{if(h.current){const y=h.current.getBoundingClientRect();v({width:y.width,height:y.height})}};return u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),x.useEffect(()=>()=>{l.url&&URL.revokeObjectURL(l.url),i.url&&URL.revokeObjectURL(i.url)},[l.url,i.url]);const w=Math.max(((g=l.info)==null?void 0:g.frames)||1,((p=i.info)==null?void 0:p.frames)||1);return t.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.5rem 1rem",background:"#f8f9fa",borderBottom:"1px solid #eee",alignItems:"center"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:d,onChange:u=>j(u.target.checked)}),t.jsx("span",{style:{fontSize:"0.85rem"},children:"Show OCR Overlay"})]}),w>1&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"0.85rem",color:"#7f8c8d"},children:"Frame:"}),t.jsx("button",{onClick:()=>c(u=>Math.max(0,u-1)),disabled:o===0,style:vc,children:"-"}),t.jsxs("span",{style:{fontSize:"0.85rem",minWidth:"60px",textAlign:"center"},children:[o+1," / ",w]}),t.jsx("button",{onClick:()=>c(u=>Math.min(w-1,u+1)),disabled:o>=w-1,style:vc,children:"+"})]}),t.jsx("div",{style:{flex:1}}),t.jsxs("span",{style:{fontSize:"0.8rem",color:"#7f8c8d"},children:["Original: ",l.info?`${l.info.width}x${l.info.height}`:"-"," | ","Anonymized: ",i.info?`${i.info.width}x${i.info.height}`:"-"]})]}),t.jsxs("div",{style:{flex:1,display:"flex",gap:"1rem",padding:"1rem",overflow:"hidden"},children:[t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{padding:"0.5rem",background:"#2c3e50",color:"white",fontWeight:600,textAlign:"center",borderRadius:"4px 4px 0 0"},children:["ORIGINAL",l.ocrRegions.length>0&&t.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.8,fontSize:"0.85rem"},children:["(",l.ocrRegions.filter(u=>u.isPhi).length," PHI detected)"]})]}),t.jsxs("div",{ref:h,style:{flex:1,background:"#000",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",borderRadius:"0 0 4px 4px",overflow:"hidden",minHeight:"300px"},children:[l.loading&&t.jsx("div",{style:{color:"#fff"},children:t.jsx("div",{className:"spinner",style:{borderColor:"#fff",borderTopColor:"transparent"}})}),l.error&&t.jsx("div",{style:{color:"#e74c3c",textAlign:"center",padding:"1rem"},children:l.error}),l.url&&!l.loading&&t.jsxs(t.Fragment,{children:[t.jsx("img",{src:l.url,alt:"Original DICOM",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}),d&&l.info&&t.jsx(yc,{regions:l.ocrRegions,imageWidth:l.info.width,imageHeight:l.info.height,containerWidth:m.width,containerHeight:m.height})]})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{padding:"0.5rem",background:"#27ae60",color:"white",fontWeight:600,textAlign:"center",borderRadius:"4px 4px 0 0"},children:["ANONYMIZED",i.ocrRegions.length>0&&t.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.8,fontSize:"0.85rem"},children:["(",i.ocrRegions.filter(u=>u.isPhi).length," PHI detected)"]})]}),t.jsxs("div",{ref:f,style:{flex:1,background:"#000",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",borderRadius:"0 0 4px 4px",overflow:"hidden",minHeight:"300px"},children:[i.loading&&t.jsx("div",{style:{color:"#fff"},children:t.jsx("div",{className:"spinner",style:{borderColor:"#fff",borderTopColor:"transparent"}})}),i.error&&t.jsx("div",{style:{color:"#e74c3c",textAlign:"center",padding:"1rem"},children:i.error}),i.url&&!i.loading&&t.jsxs(t.Fragment,{children:[t.jsx("img",{src:i.url,alt:"Anonymized DICOM",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}),d&&i.info&&t.jsx(yc,{regions:i.ocrRegions,imageWidth:i.info.width,imageHeight:i.info.height,containerWidth:m.width,containerHeight:m.height})]})]})]})]})]})}const vc={padding:"0.25rem 0.75rem",background:"#3498db",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"1rem"},jc=["Patient","Study","Series","Equipment","Image","Other"];function xx({comparison:e,loading:n,error:r}){const[l,s]=x.useState("all"),[i,a]=x.useState("all"),[o,c]=x.useState(""),d=x.useMemo(()=>e!=null&&e.tags?e.tags.filter(h=>{if(l==="changed"&&!h.changed&&!h.removed&&!h.added||l==="phi"&&!h.isPhi||l==="removed"&&!h.removed||l==="added"&&!h.added||i!=="all"&&h.category!==i)return!1;if(o){const f=o.toLowerCase();return h.tag.toLowerCase().includes(f)||h.name.toLowerCase().includes(f)||h.originalValue&&h.originalValue.toLowerCase().includes(f)||h.anonymizedValue&&h.anonymizedValue.toLowerCase().includes(f)}return!0}):[],[e,l,i,o]),j=x.useMemo(()=>{const h={};for(const m of d){const v=m.category||"Other";h[v]||(h[v]=[]),h[v].push(m)}const f=[];for(const m of jc)h[m]&&f.push([m,h[m]]);return f},[d]);return n?t.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Loading header comparison..."})]}):r?t.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#e74c3c"},children:t.jsxs("p",{children:["Error loading headers: ",r]})}):e?t.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",background:"#f8f9fa",borderBottom:"1px solid #eee",fontSize:"0.85rem"},children:[t.jsxs("span",{children:["Total: ",t.jsx("strong",{children:e.totalTags})]}),t.jsxs("span",{style:{color:"#e67e22"},children:["Changed: ",t.jsx("strong",{children:e.changedTags})]}),t.jsxs("span",{style:{color:"#e74c3c"},children:["Removed: ",t.jsx("strong",{children:e.removedTags})]}),t.jsxs("span",{style:{color:"#27ae60"},children:["Added: ",t.jsx("strong",{children:e.addedTags})]}),t.jsxs("span",{style:{color:"#9b59b6"},children:["PHI: ",t.jsx("strong",{children:e.phiTags})]})]}),t.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderBottom:"1px solid #eee",alignItems:"center",flexWrap:"wrap"},children:[t.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[t.jsx("label",{style:{fontSize:"0.85rem",color:"#7f8c8d"},children:"Filter:"}),t.jsxs("select",{value:l,onChange:h=>s(h.target.value),style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #ddd"},children:[t.jsx("option",{value:"all",children:"All Tags"}),t.jsx("option",{value:"changed",children:"Changed Only"}),t.jsx("option",{value:"phi",children:"PHI Only"}),t.jsx("option",{value:"removed",children:"Removed"}),t.jsx("option",{value:"added",children:"Added"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[t.jsx("label",{style:{fontSize:"0.85rem",color:"#7f8c8d"},children:"Category:"}),t.jsxs("select",{value:i,onChange:h=>a(h.target.value),style:{padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #ddd"},children:[t.jsx("option",{value:"all",children:"All Categories"}),jc.map(h=>t.jsx("option",{value:h,children:h},h))]})]}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",flex:1},children:t.jsx("input",{type:"text",placeholder:"Search tags...",value:o,onChange:h=>c(h.target.value),style:{flex:1,padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid #ddd",minWidth:"150px",maxWidth:"300px"}})}),t.jsxs("span",{style:{fontSize:"0.85rem",color:"#7f8c8d"},children:["Showing ",d.length," tags"]})]}),t.jsx("div",{style:{flex:1,overflow:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[t.jsx("thead",{style:{position:"sticky",top:0,background:"#f8f9fa"},children:t.jsxs("tr",{children:[t.jsx("th",{style:wn,children:"Category"}),t.jsx("th",{style:wn,children:"Tag"}),t.jsx("th",{style:wn,children:"Name"}),t.jsx("th",{style:wn,children:"VR"}),t.jsx("th",{style:{...wn,minWidth:"200px"},children:"Original"}),t.jsx("th",{style:{...wn,minWidth:"200px"},children:"Anonymized"})]})}),t.jsxs("tbody",{children:[j.map(([h,f])=>f.map((m,v)=>t.jsxs("tr",{style:{background:gx(m),borderTop:v===0?"2px solid #ddd":void 0},children:[v===0&&t.jsx("td",{rowSpan:f.length,style:{...kn,fontWeight:600,background:"#f0f0f0",verticalAlign:"top",padding:"0.5rem"},children:h}),t.jsx("td",{style:{...kn,fontFamily:"monospace",fontSize:"0.8rem"},children:m.tag}),t.jsxs("td",{style:kn,children:[m.isPhi&&t.jsx("span",{style:{background:"#9b59b6",color:"white",fontSize:"0.7rem",padding:"0.1rem 0.3rem",borderRadius:"3px",marginRight:"0.5rem"},children:"PHI"}),m.name]}),t.jsx("td",{style:{...kn,fontFamily:"monospace",fontSize:"0.8rem"},children:m.vr}),t.jsx("td",{style:{...kn,fontFamily:"monospace",fontSize:"0.8rem",color:m.removed?"#e74c3c":void 0,textDecoration:m.removed?"line-through":void 0},children:Sc(m.originalValue)}),t.jsx("td",{style:{...kn,fontFamily:"monospace",fontSize:"0.8rem",color:m.added?"#27ae60":m.changed?"#e67e22":void 0,fontWeight:m.changed?500:void 0},children:Sc(m.anonymizedValue)})]},m.tag))),d.length===0&&t.jsx("tr",{children:t.jsx("td",{colSpan:6,style:{padding:"2rem",textAlign:"center",color:"#7f8c8d"},children:"No matching tags found"})})]})]})})]}):t.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#7f8c8d"},children:t.jsx("p",{children:"Select files to compare headers"})})}const wn={padding:"0.5rem",textAlign:"left",borderBottom:"2px solid #ddd",fontWeight:600,color:"#2c3e50"},kn={padding:"0.35rem 0.5rem",borderBottom:"1px solid #eee",verticalAlign:"top"};function gx(e){return e.removed?"rgba(231, 76, 60, 0.1)":e.added?"rgba(39, 174, 96, 0.1)":e.changed?"rgba(230, 126, 34, 0.1)":"transparent"}function Sc(e){return e?e.length>100?e.substring(0,100)+"...":e:""}function yx(){const[e]=Xa(),n=nr(),r=e.get("aeTitle")||"",l=e.get("studyUid")||"",[s,i]=x.useState("image"),[a,o]=x.useState(0),[c,d]=x.useState(0),[j,h]=x.useState(null),[f,m]=x.useState(!1),[v,S]=x.useState(null),{data:w,loading:g,error:p}=cx(r,l),{data:u,loading:y,error:E}=dx(r,l),I=(u==null?void 0:u.scans)||[],_=I[a],z=(_==null?void 0:_.files)||[],D=z[c];x.useEffect(()=>{d(0)},[a]),x.useEffect(()=>{if(!(D!=null&&D.originalFile)||!(D!=null&&D.anonymizedFile)){h(null);return}(async()=>{m(!0),S(null);try{const A=await ux(D.originalFile,D.anonymizedFile);h(A)}catch(A){S(A instanceof Error?A.message:"Failed to load headers"),h(null)}finally{m(!1)}})()},[D]);const C=()=>{var Z;if(c>0)d(c-1);else if(a>0){o(a-1);const A=I[a-1];d((((Z=A==null?void 0:A.files)==null?void 0:Z.length)||1)-1)}},R=()=>{c<z.length-1?d(c+1):a<I.length-1&&(o(a+1),d(0))},ne=c>0||a>0,K=c<z.length-1||a<I.length-1;return g||y?t.jsx("div",{style:Gs,children:t.jsxs("div",{style:{padding:"4rem",textAlign:"center"},children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{style:{marginTop:"1rem",color:"#7f8c8d"},children:"Loading study..."})]})}):p||E||!r||!l?t.jsx("div",{style:Gs,children:t.jsxs("div",{style:{padding:"4rem",textAlign:"center"},children:[t.jsx("h2",{style:{color:"#e74c3c"},children:"Error Loading Study"}),t.jsx("p",{style:{color:"#7f8c8d"},children:p||E||"Missing aeTitle or studyUid parameters"}),t.jsx("button",{onClick:()=>n("/storage"),style:{marginTop:"1rem",padding:"0.5rem 1rem",background:"#3498db",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Back to Storage"})]})}):t.jsxs("div",{style:Gs,children:[t.jsxs("div",{style:vx,children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Study:"})," ",(w==null?void 0:w.studyUid)||l,t.jsx("span",{style:{margin:"0 1rem"},children:"|"}),t.jsx("strong",{children:"Patient:"})," ",(w==null?void 0:w.patientName)||"N/A"," (",(w==null?void 0:w.patientId)||"N/A",")",t.jsx("span",{style:{margin:"0 1rem"},children:"|"}),t.jsx("strong",{children:"Date:"})," ",(w==null?void 0:w.studyDate)||"N/A"]}),t.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.jsx("button",{style:kx,onClick:()=>n("/storage"),children:"Back"})})]}),t.jsxs("div",{style:jx,children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{fontWeight:500,color:"#7f8c8d"},children:"Scan:"}),t.jsx("select",{value:a,onChange:Z=>o(Number(Z.target.value)),style:wx,children:I.map((Z,A)=>t.jsxs("option",{value:A,children:[A+1,". ",Z.seriesDescription||Z.modality||"Series"," (",Z.instanceCount," files)"]},Z.seriesUid))})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("button",{onClick:C,disabled:!ne,style:bc,children:"Prev"}),t.jsxs("span",{style:{minWidth:"80px",textAlign:"center"},children:["Instance ",c+1," / ",z.length]}),t.jsx("button",{onClick:R,disabled:!K,style:bc,children:"Next"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{onClick:()=>i("image"),style:{...wc,background:s==="image"?"#3498db":"#ecf0f1",color:s==="image"?"white":"#2c3e50"},children:"Image"}),t.jsx("button",{onClick:()=>i("header"),style:{...wc,background:s==="header"?"#3498db":"#ecf0f1",color:s==="header"?"white":"#2c3e50"},children:"Header"})]})]}),t.jsxs("div",{style:Sx,children:[s==="image"&&D&&t.jsx(mx,{originalPath:D.originalFile,anonymizedPath:D.anonymizedFile,showOverlay:!0}),s==="header"&&t.jsx(xx,{comparison:j,loading:f,error:v}),!D&&t.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#7f8c8d"},children:"No files available for comparison"})]}),t.jsxs("div",{style:bx,children:[t.jsx("div",{style:{display:"flex",gap:"1rem"},children:t.jsxs("span",{style:{color:"#7f8c8d",fontSize:"0.85rem"},children:[(w==null?void 0:w.scanCount)||0," scans, ",(w==null?void 0:w.fileCount)||0," files",(w==null?void 0:w.phiFieldsModified)>0&&t.jsxs("span",{style:{marginLeft:"1rem",color:"#27ae60"},children:[w.phiFieldsModified," PHI fields modified"]})]})}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{style:Js("#27ae60"),children:"Mark Reviewed"}),t.jsx("button",{style:Js("#e67e22"),children:"Flag Issue"}),t.jsx("button",{style:Js("#3498db"),children:"Test Send"})]})]})]})}const Gs={height:"100%",display:"flex",flexDirection:"column",background:"#f5f7fa"},vx={padding:"0.75rem 1rem",background:"#2c3e50",color:"white",fontSize:"0.9rem",display:"flex",justifyContent:"space-between",alignItems:"center"},jx={padding:"0.75rem 1rem",background:"white",borderBottom:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.5rem"},Sx={flex:1,overflow:"hidden",display:"flex",flexDirection:"column",background:"white",margin:"1rem",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},bx={padding:"0.75rem 1rem",background:"white",borderTop:"1px solid #ddd",display:"flex",justifyContent:"space-between",alignItems:"center"},wx={padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid #ddd",minWidth:"200px"},bc={padding:"0.35rem 0.75rem",background:"#ecf0f1",border:"1px solid #bdc3c7",borderRadius:"4px",cursor:"pointer"},wc={padding:"0.35rem 1rem",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},kx={padding:"0.35rem 0.75rem",background:"rgba(255,255,255,0.2)",color:"white",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"4px",cursor:"pointer"},Js=e=>({padding:"0.5rem 1rem",background:e,color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500}),Nx="2.1.0",kc="__BUILD_TIME__";function Cx({isOpen:e,onClose:n}){return e?t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:n,children:t.jsxs("div",{style:{background:"white",borderRadius:"8px",padding:"2rem",maxWidth:"500px",width:"90%",boxShadow:"0 4px 20px rgba(0,0,0,0.3)"},onClick:r=>r.stopPropagation(),children:[t.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[t.jsx("div",{style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #2c3e50 0%, #3498db 100%)",borderRadius:"16px",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1rem",fontSize:"2.5rem"},children:t.jsx("span",{role:"img","aria-label":"router",children:""})}),t.jsx("h2",{style:{margin:"0 0 0.5rem",color:"#2c3e50"},children:"XNAT DICOM Router"}),t.jsx("p",{style:{margin:0,color:"#7f8c8d",fontSize:"0.9rem"},children:"Enterprise DICOM Routing Solution"})]}),t.jsx("div",{style:{background:"#f8f9fa",borderRadius:"6px",padding:"1rem",marginBottom:"1.5rem"},children:t.jsx("table",{style:{width:"100%",fontSize:"0.9rem"},children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{style:{padding:"0.25rem 0",color:"#7f8c8d"},children:"Version"}),t.jsx("td",{style:{padding:"0.25rem 0",textAlign:"right",fontWeight:500},children:Nx})]}),t.jsxs("tr",{children:[t.jsx("td",{style:{padding:"0.25rem 0",color:"#7f8c8d"},children:"Build"}),t.jsx("td",{style:{padding:"0.25rem 0",textAlign:"right",fontFamily:"monospace",fontSize:"0.8rem"},children:kc.startsWith("__")?"Development":kc})]}),t.jsxs("tr",{children:[t.jsx("td",{style:{padding:"0.25rem 0",color:"#7f8c8d"},children:"dcm4che"}),t.jsx("td",{style:{padding:"0.25rem 0",textAlign:"right"},children:"5.x"})]}),t.jsxs("tr",{children:[t.jsx("td",{style:{padding:"0.25rem 0",color:"#7f8c8d"},children:"Java"}),t.jsx("td",{style:{padding:"0.25rem 0",textAlign:"right"},children:"11+"})]})]})})}),t.jsxs("div",{style:{borderTop:"1px solid #eee",paddingTop:"1rem",marginBottom:"1rem",textAlign:"center",fontSize:"0.85rem",color:"#7f8c8d"},children:[t.jsx("p",{style:{margin:"0 0 0.5rem"},children:"Copyright 2024 XNATWorks."}),t.jsx("p",{style:{margin:"0 0 0.5rem"},children:"This software is proprietary and confidential."}),t.jsx("p",{style:{margin:0},children:t.jsx("a",{href:"https://xnatworks.com",target:"_blank",rel:"noopener noreferrer",style:{color:"#3498db",textDecoration:"none"},children:"xnatworks.com"})})]}),t.jsx("div",{style:{textAlign:"center"},children:t.jsx("button",{onClick:n,style:{background:"#3498db",color:"white",border:"none",padding:"0.75rem 2rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem",fontWeight:500},children:"Close"})})]})}):null}const Nc={light:"Light",dark:"Dark","high-contrast":"High Contrast",ocean:"Ocean"},Ex=[{title:"Overview",items:[{path:"/",label:"Dashboard",icon:""}]},{title:"Configuration",items:[{path:"/routes",label:"Routes",icon:""},{path:"/destinations",label:"Destinations",icon:""},{path:"/brokers",label:"Brokers",icon:""},{path:"/scripts",label:"Scripts",icon:""},{path:"/ocr",label:"OCR",icon:"",featureKey:"enableOcr"}]},{title:"Operations",items:[{path:"/transfers",label:"Transfers",icon:""},{path:"/query-retrieve",label:"Query/Retrieve",icon:"",featureKey:"enableQueryRetrieve"},{path:"/import",label:"Import",icon:""},{path:"/storage",label:"Storage",icon:""},{path:"/review",label:"Review",icon:"",featureKey:"enableReview"}]},{title:"Data",items:[{path:"/index",label:"Index",icon:"",featureKey:"enableIndexing"},{path:"/search",label:"Search",icon:"",featureKey:"enableIndexing"}]},{title:"System",items:[{path:"/logs",label:"Logs",icon:""},{path:"/settings",label:"Settings",icon:""}]}];function Tx(){var p;const e=jn(),[n,r]=x.useState(null),[l,s]=x.useState(!0),[i,a]=x.useState(null),[o,c]=x.useState(!1),[d,j]=x.useState(!1),[h,f]=x.useState(()=>localStorage.getItem("theme")||"light"),{data:m}=q("/config"),v=(m==null?void 0:m.features)||{enableIndexing:!1,enableReview:!0,enableOcr:!0,enableQueryRetrieve:!0},S=Ex.map(u=>({...u,items:u.items.filter(y=>!y.featureKey||v[y.featureKey])})).filter(u=>u.items.length>0);x.useEffect(()=>{document.documentElement.setAttribute("data-theme",h),localStorage.setItem("theme",h)},[h]),x.useEffect(()=>{(async()=>{const y=await Wm();s(y.authRequired),r(y.authenticated||!y.authRequired),a(y.username||null)})()},[]);const w=(u,y)=>{Gu(u),r(!0),a(y)},g=()=>{nn(),r(!1),a(null)};return n===null?t.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f7fa"},children:t.jsx("div",{className:"spinner"})}):l&&!n?t.jsx(lx,{onLogin:w}):t.jsxs("div",{className:"app-layout",children:[t.jsxs("aside",{className:`sidebar ${d?"collapsed":""}`,children:[t.jsxs("div",{className:"sidebar-header",children:[t.jsx("div",{className:"sidebar-logo",children:t.jsx("span",{className:"logo-icon",children:""})}),t.jsx("button",{className:"sidebar-toggle",onClick:()=>j(!d),title:d?"Expand sidebar":"Collapse sidebar",children:d?"":""})]}),t.jsx("nav",{className:"sidebar-nav",children:S.map(u=>t.jsxs("div",{className:"nav-section",children:[!d&&t.jsx("div",{className:"nav-section-title",children:u.title}),u.items.map(y=>t.jsx(Om,{to:y.path,className:({isActive:E})=>`nav-item ${E||y.path==="/"&&e.pathname==="/"?"active":""}`,title:d?y.label:void 0,children:!d&&t.jsx("span",{className:"nav-label",children:y.label})},y.path))]},u.title))}),t.jsx("div",{className:"sidebar-footer",children:!d&&t.jsx("div",{className:"sidebar-user",children:i&&t.jsx("span",{className:"user-name",children:i})})})]}),t.jsxs("div",{className:"main-area",children:[t.jsxs("header",{className:"top-header",children:[t.jsx("div",{className:"header-left",children:t.jsx("h1",{className:"page-title",children:((p=S.flatMap(u=>u.items).find(u=>u.path===e.pathname||u.path==="/"&&e.pathname==="/"))==null?void 0:p.label)||"DICOM Router"})}),t.jsxs("div",{className:"header-right",children:[t.jsx("span",{style:{fontWeight:600,marginRight:"1rem",color:"var(--header-text)"},children:"XNATWorks DICOM Router"}),t.jsx("select",{className:"theme-select",value:h,onChange:u=>f(u.target.value),title:"Theme",children:Object.keys(Nc).map(u=>t.jsx("option",{value:u,children:Nc[u]},u))}),t.jsx("button",{className:"header-btn about-btn",onClick:()=>c(!0),title:"About",children:"?"}),i&&t.jsx("button",{className:"header-btn logout-btn",onClick:g,children:"Logout"})]})]}),t.jsx(Cx,{isOpen:o,onClose:()=>c(!1)}),t.jsx("main",{className:"main-content",children:t.jsxs(Cm,{children:[t.jsx(Pe,{path:"/",element:t.jsx(Vm,{})}),t.jsx(Pe,{path:"/routes",element:t.jsx(Qm,{})}),t.jsx(Pe,{path:"/destinations",element:t.jsx(Xm,{})}),t.jsx(Pe,{path:"/brokers",element:t.jsx(qm,{})}),t.jsx(Pe,{path:"/scripts",element:t.jsx(Gm,{})}),t.jsx(Pe,{path:"/ocr",element:t.jsx(sx,{})}),t.jsx(Pe,{path:"/transfers",element:t.jsx(Jm,{})}),t.jsx(Pe,{path:"/query-retrieve",element:t.jsx(ix,{})}),t.jsx(Pe,{path:"/import",element:t.jsx(Zm,{})}),t.jsx(Pe,{path:"/storage",element:t.jsx(ex,{})}),t.jsx(Pe,{path:"/index",element:t.jsx(ox,{})}),t.jsx(Pe,{path:"/search",element:t.jsx(ax,{})}),t.jsx(Pe,{path:"/dicom-viewer",element:t.jsx(tx,{})}),t.jsx(Pe,{path:"/review",element:t.jsx(yx,{})}),t.jsx(Pe,{path:"/logs",element:t.jsx(nx,{})}),t.jsx(Pe,{path:"/settings",element:t.jsx(rx,{})})]})})]})]})}Zs.createRoot(document.getElementById("root")).render(t.jsx(Lc.StrictMode,{children:t.jsx(zm,{children:t.jsx(Tx,{})})}));
